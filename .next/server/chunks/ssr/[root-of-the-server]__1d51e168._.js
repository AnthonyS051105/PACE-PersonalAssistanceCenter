module.exports=[33405,(a,b,c)=>{b.exports=a.x("child_process",()=>require("child_process"))},22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},97599,(a,b,c)=>{"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,h=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===e.call(a)},i=function(a){if(!a||"[object Object]"!==e.call(a))return!1;var b,c=d.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!c&&!f)return!1;for(b in a);return void 0===b||d.call(a,b)},j=function(a,b){f&&"__proto__"===b.name?f(a,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):a[b.name]=b.newValue},k=function(a,b){if("__proto__"===b){if(!d.call(a,b))return;else if(g)return g(a,b).value}return a[b]};b.exports=function a(){var b,c,d,e,f,g,l=arguments[0],m=1,n=arguments.length,o=!1;for("boolean"==typeof l&&(o=l,l=arguments[1]||{},m=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});m<n;++m)if(b=arguments[m],null!=b)for(c in b)d=k(l,c),l!==(e=k(b,c))&&(o&&e&&(i(e)||(f=h(e)))?(f?(f=!1,g=d&&h(d)?d:[]):g=d&&i(d)?d:{},j(l,{name:c,newValue:a(o,g,e)})):void 0!==e&&j(l,{name:c,newValue:e}));return l}},451,a=>{a.v({name:"gaxios",version:"7.1.3",description:"A simple common HTTP client specifically for Google APIs and services.",main:"build/cjs/src/index.js",types:"build/cjs/src/index.d.ts",files:["build/"],exports:{".":{import:{types:"./build/esm/src/index.d.ts",default:"./build/esm/src/index.js"},require:{types:"./build/cjs/src/index.d.ts",default:"./build/cjs/src/index.js"}}},scripts:{lint:"gts check --no-inline-config",test:"c8 mocha build/esm/test","presystem-test":"npm run compile","system-test":"mocha build/esm/system-test --timeout 80000",compile:"tsc -b ./tsconfig.json ./tsconfig.cjs.json && node utils/enable-esm.mjs",fix:"gts fix",prepare:"npm run compile",pretest:"npm run compile",webpack:"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js",docs:"jsdoc -c .jsdoc.js","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../",prelint:"cd samples; npm link ../; npm install",clean:"gts clean"},repository:{type:"git",directory:"packages/gaxios",url:"https://github.com/googleapis/google-cloud-node-core.git"},keywords:["google"],engines:{node:">=18"},author:"Google, LLC",license:"Apache-2.0",devDependencies:{"@babel/plugin-proposal-private-methods":"^7.18.6","@types/cors":"^2.8.6","@types/express":"^5.0.0","@types/extend":"^3.0.1","@types/mocha":"^10.0.10","@types/multiparty":"4.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","@types/tmp":"0.2.6",assert:"^2.0.0",browserify:"^17.0.0",c8:"^10.0.0",cors:"^2.8.5",express:"^5.0.0",gts:"^6.0.0","is-docker":"^3.0.0",jsdoc:"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1",linkinator:"^6.1.2",mocha:"^11.1.0",multiparty:"^4.2.1",mv:"^2.1.1",ncp:"^2.0.0",nock:"^14.0.0-beta.13","null-loader":"^4.0.0","pack-n-play":"^4.0.0",puppeteer:"^24.0.0",sinon:"^21.0.0","stream-browserify":"^3.0.0",tmp:"0.2.5","ts-loader":"^9.5.2",typescript:"^5.8.3",webpack:"^5.35.0","webpack-cli":"^6.0.1"},dependencies:{extend:"^3.0.2","https-proxy-agent":"^7.0.1","node-fetch":"^3.3.2",rimraf:"^5.0.1"},homepage:"https://github.com/googleapis/google-cloud-node-core/tree/main/packages/gaxios"})},52947,(a,b,c)=>{"use strict";b.exports={pkg:a.r(451)}},69565,(a,b,c)=>{"use strict";var d=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosError=c.GAXIOS_ERROR_SYMBOL=void 0,c.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){a&&a.forEach((b,d)=>{(/^authentication$/i.test(d)||/^authorization$/i.test(d)||/secret/i.test(d))&&a.set(d,c)})}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function f(a){!a||"object"!=typeof a||(a instanceof FormData||a instanceof URLSearchParams||"forEach"in a&&"set"in a?a.forEach((b,d)=>{(["grant_type","assertion"].includes(d)||/secret/.test(d))&&a.set(d,c)}):("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c)))}return b.config&&(d(b.config.headers),e(b.config,"data"),f(b.config.data),e(b.config,"body"),f(b.config.body),b.config.url.searchParams.has("token")&&b.config.url.searchParams.set("token",c),b.config.url.searchParams.has("client_secret")&&b.config.url.searchParams.set("client_secret",c)),b.response&&(a({config:b.response.config}),d(b.response.headers),b.response.bodyUsed&&(e(b.response,"data"),f(b.response.data))),b};let e=d(a.r(97599)),f=d(a.r(52947)).default.pkg;c.GAXIOS_ERROR_SYMBOL=Symbol.for(`${f.name}-gaxios-error`);class g extends Error{config;response;code;status;error;[c.GAXIOS_ERROR_SYMBOL]=f.version;static[Symbol.hasInstance](a){return!!a&&"object"==typeof a&&c.GAXIOS_ERROR_SYMBOL in a&&a[c.GAXIOS_ERROR_SYMBOL]===f.version||Function.prototype[Symbol.hasInstance].call(g,a)}constructor(a,b,c,d){if(super(a,{cause:d}),this.config=b,this.response=c,this.error=d instanceof Error?d:void 0,this.config=(0,e.default)(!0,{},b),this.response&&(this.response.config=(0,e.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}d instanceof DOMException?this.code=d.name:d&&"object"==typeof d&&"code"in d&&("string"==typeof d.code||"number"==typeof d.code)&&(this.code=d.code)}static extractAPIErrorFromResponse(a,b="The request failed"){let c=b;if("string"==typeof a.data&&(c=a.data),a.data&&"object"==typeof a.data&&"error"in a.data&&a.data.error&&!a.ok){if("string"==typeof a.data.error)return{message:a.data.error,code:a.status,status:a.statusText};if("object"==typeof a.data.error){c="message"in a.data.error&&"string"==typeof a.data.error.message?a.data.error.message:c;let b="status"in a.data.error&&"string"==typeof a.data.error.status?a.data.error.status:a.statusText,d="code"in a.data.error&&"number"==typeof a.data.error.code?a.data.error.code:a.status;if("errors"in a.data.error&&Array.isArray(a.data.error.errors)){let e=[];for(let b of a.data.error.errors)"object"==typeof b&&"message"in b&&"string"==typeof b.message&&e.push(b.message);return Object.assign({message:e.join("\n")||c,code:d,status:b},a.data.error)}return Object.assign({message:c,code:d,status:b},a.data.error)}}return{message:c,code:a.status,status:a.statusText}}}c.GaxiosError=g},63492,(a,b,c)=>{"use strict";async function d(a){var b;let c=f(a);if(!a||!a.config||!c&&!a.config.retry)return{shouldRetry:!1};(c=c||{}).currentRetryAttempt=c.currentRetryAttempt||0,c.retry=void 0===c.retry||null===c.retry?3:c.retry,c.httpMethodsToRetry=c.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],c.noResponseRetries=void 0===c.noResponseRetries||null===c.noResponseRetries?2:c.noResponseRetries,c.retryDelayMultiplier=c.retryDelayMultiplier?c.retryDelayMultiplier:2,c.timeOfFirstRequest=c.timeOfFirstRequest?c.timeOfFirstRequest:Date.now(),c.totalTimeout=c.totalTimeout?c.totalTimeout:Number.MAX_SAFE_INTEGER,c.maxRetryDelay=c.maxRetryDelay?c.maxRetryDelay:Number.MAX_SAFE_INTEGER,c.statusCodesToRetry=c.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=c;let d=c.shouldRetry||e;if(!await d(a))return{shouldRetry:!1,config:a.config};let g=Math.min(((b=c).currentRetryAttempt?0:b.retryDelay??100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let h=c.retryBackoff?c.retryBackoff(a,g):new Promise(a=>{setTimeout(a,g)});return c.onRetryAttempt&&await c.onRetryAttempt(a),await h,{shouldRetry:!0,config:a.config}}function e(a){let b=f(a);if(a.config.signal?.aborted&&"TimeoutError"!==a.code||"AbortError"===a.code||!b||0===b.retry||!a.response&&(b.currentRetryAttempt||0)>=b.noResponseRetries||!b.httpMethodsToRetry||!b.httpMethodsToRetry.includes(a.config.method?.toUpperCase()||"GET"))return!1;if(a.response&&a.response.status){let c=!1;for(let[d,e]of b.statusCodesToRetry){let b=a.response.status;if(b>=d&&b<=e){c=!0;break}}if(!c)return!1}return b.currentRetryAttempt=b.currentRetryAttempt||0,!(b.currentRetryAttempt>=b.retry)}function f(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(c,"__esModule",{value:!0}),c.getRetryConfig=d},88947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},69706,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosInterceptorManager=void 0;class d extends Set{}c.GaxiosInterceptorManager=d},76176,(a,b,c)=>{"use strict";var d,e=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.Gaxios=void 0;let f=e(a.r(97599)),g=a.r(24836),h=a.r(69565),i=a.r(63492),j=a.r(88947),k=a.r(69706),l=async()=>globalThis.crypto?.randomUUID()||(await a.A(85685)).randomUUID();class m{agentCache=new Map;defaults;interceptors;constructor(a){this.defaults=a||{},this.interceptors={request:new k.GaxiosInterceptorManager,response:new k.GaxiosInterceptorManager}}fetch(...a){let b,c=a[0],e=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&d.mergeHeaders(f,c.headers),e&&d.mergeHeaders(f,new Headers(e.headers)),"object"!=typeof c||c instanceof URL)?this.request({...e,headers:f,url:b}):this.request({...e,...c,headers:f,url:b})}async request(a={}){let b=await this.#a(a);return b=await this.#b(b),this.#c(this._request(b))}async _defaultAdapter(a){let b=a.fetchImplementation||this.defaults.fetchImplementation||await d.#d(),c={...a};delete c.data;let e=await b(a.url,c),f=await this.getResponseData(a,e);return Object.getOwnPropertyDescriptor(e,"data")?.configurable||Object.defineProperties(e,{data:{configurable:!0,writable:!0,enumerable:!0,value:f}}),Object.assign(e,{config:a,data:f})}async _request(a){try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a=[];for await(let c of b.data)a.push(c);b.data=a.toString()}let c=h.GaxiosError.extractAPIErrorFromResponse(b,`Request failed with status code ${b.status}`);throw new h.GaxiosError(c?.message,a,b,c)}return b}catch(e){let b;b=e instanceof h.GaxiosError?e:e instanceof Error?new h.GaxiosError(e.message,a,void 0,e):new h.GaxiosError("Unexpected Gaxios Error",a,void 0,e);let{shouldRetry:c,config:d}=await (0,i.getRetryConfig)(b);if(c&&d)return b.config.retryConfig.currentRetryAttempt=d.retryConfig.currentRetryAttempt,a.retryConfig=b.config?.retryConfig,this.#e(a),this._request(a);throw a.errorRedactor&&a.errorRedactor(b),b}}async getResponseData(a,b){if(204===b.status)return"";if(a.maxContentLength&&b.headers.has("content-length")&&a.maxContentLength<Number.parseInt(b.headers?.get("content-length")||""))throw new h.GaxiosError("Response's `Content-Length` is over the limit.",a,Object.assign(b,{config:a}));switch(a.responseType){case"stream":return b.body;case"json":{let a=await b.text();try{return JSON.parse(a)}catch{return a}}case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}#f(a,b=[]){let c=new URL(a),d=[...b];for(let a of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])d.push(a.trim());for(let a of d)if(a instanceof RegExp){if(a.test(c.toString()))return!1}else if(a instanceof URL){if(a.origin===c.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(c.hostname.endsWith(b))return!1}else if(a===c.origin||a===c.hostname||a===c.href)return!1;return!0}async #b(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #c(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #a(a){let b=new Headers(this.defaults.headers);d.mergeHeaders(b,a.headers);let c=(0,f.default)(!0,{},this.defaults,a);if(!c.url)throw Error("URL is required.");if(c.baseURL&&(c.url=new URL(c.url,c.baseURL)),c.url=new URL(c.url),c.params)if(c.paramsSerializer){let a=c.paramsSerializer(c.params);a.startsWith("?")&&(a=a.slice(1));let b=c.url.toString().includes("?")?"&":"?";c.url=c.url+b+a}else{let a=c.url instanceof URL?c.url:new URL(c.url);for(let[b,d]of new URLSearchParams(c.params))a.searchParams.append(b,d);c.url=a}"number"==typeof a.maxContentLength&&(c.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(c.follow=a.maxRedirects);let e="string"==typeof c.data||c.data instanceof ArrayBuffer||c.data instanceof Blob||globalThis.File&&c.data instanceof File||c.data instanceof FormData||c.data instanceof j.Readable||c.data instanceof ReadableStream||c.data instanceof String||c.data instanceof URLSearchParams||ArrayBuffer.isView(c.data)||["Blob","File","FormData"].includes(c.data?.constructor?.name||"");if(c.multipart?.length){let a=await l();b.set("content-type",`multipart/related; boundary=${a}`),c.body=j.Readable.from(this.getMultipartRequest(c.multipart,a))}else e?c.body=c.data:"object"==typeof c.data?"application/x-www-form-urlencoded"===b.get("Content-Type")?c.body=c.paramsSerializer?c.paramsSerializer(c.data):new URLSearchParams(c.data):(b.has("content-type")||b.set("content-type","application/json"),c.body=JSON.stringify(c.data)):c.data&&(c.body=c.data);c.validateStatus=c.validateStatus||this.validateStatus,c.responseType=c.responseType||"unknown",b.has("accept")||"json"!==c.responseType||b.set("accept","application/json");let i=c.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(c.agent);else if(i&&this.#f(c.url,c.noProxy)){let a=await d.#g();this.agentCache.has(i)?c.agent=this.agentCache.get(i):(c.agent=new a(i,{cert:c.cert,key:c.key}),this.agentCache.set(i,c.agent))}else c.cert&&c.key&&(this.agentCache.has(c.key)?c.agent=this.agentCache.get(c.key):(c.agent=new g.Agent({cert:c.cert,key:c.key}),this.agentCache.set(c.key,c.agent)));return"function"!=typeof c.errorRedactor&&!1!==c.errorRedactor&&(c.errorRedactor=h.defaultErrorRedactor),!c.body||"duplex"in c||(c.duplex="half"),this.#e(c),Object.assign(c,{headers:b,url:c.url instanceof URL?c.url:new URL(c.url)})}#e(a){if(a.timeout){let b=AbortSignal.timeout(a.timeout);a.signal&&!a.signal.aborted?a.signal=AbortSignal.any([a.signal,b]):a.signal=b}}validateStatus(a){return a>=200&&a<300}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch{}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers.get("Content-Type")||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}static #h;static #i;static async #g(){return this.#h||=(await a.A(57882)).HttpsProxyAgent,this.#h}static async #d(){return this.#i||=(await a.A(69375)).default,this.#i}static mergeHeaders(a,...b){for(let c of(a=a instanceof Headers?a:new Headers(a),b))(c instanceof Headers?c:new Headers(c)).forEach((b,c)=>{"set-cookie"===c?a.append(c,b):a.set(c,b)});return a}}c.Gaxios=m,d=m},99853,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.instance=c.Gaxios=c.GaxiosError=void 0,c.request=h;let f=a.r(76176);Object.defineProperty(c,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=a.r(69565);async function h(a){return c.instance.request(a)}Object.defineProperty(c,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(a.r(69706),c),c.instance=new f.Gaxios},46786,(a,b,c)=>{b.exports=a.x("os",()=>require("os"))},37062,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GCE_LINUX_BIOS_PATHS=void 0,c.isGoogleCloudServerless=g,c.isGoogleComputeEngineLinux=h,c.isGoogleComputeEngineMACAddress=i,c.isGoogleComputeEngine=j,c.detectGCPResidency=function(){return g()||j()};let d=a.r(22734),e=a.r(46786);c.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let f=/^42:01/;function g(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function h(){(0,e.platform)();try{(0,d.statSync)(c.GCE_LINUX_BIOS_PATHS.BIOS_DATE);let a=(0,d.readFileSync)(c.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(a)}catch{return!1}}function i(){for(let a of Object.values((0,e.networkInterfaces)()))if(a){for(let{mac:b}of a)if(f.test(b))return!0}return!1}function j(){return h()||i()}},30168,(a,b,c)=>{!function(c){"use strict";var d,e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,f=Math.ceil,g=Math.floor,h="[BigNumber Error] ",i=h+"Number primitive has more than 15 significant digits: ",j=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function k(a){var b=0|a;return a>0||a===b?b:b-1}function l(a){for(var b,c,d=1,e=a.length,f=a[0]+"";d<e;){for(c=14-(b=a[d++]+"").length;c--;b="0"+b);f+=b}for(e=f.length;48===f.charCodeAt(--e););return f.slice(0,e+1||1)}function m(a,b){var c,d,e=a.c,f=b.c,g=a.s,h=b.s,i=a.e,j=b.e;if(!g||!h)return null;if(c=e&&!e[0],d=f&&!f[0],c||d)return c?d?0:-h:g;if(g!=h)return g;if(c=g<0,d=i==j,!e||!f)return d?0:!e^c?1:-1;if(!d)return i>j^c?1:-1;for(g=0,h=(i=e.length)<(j=f.length)?i:j;g<h;g++)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1}function n(a,b,c,d){if(a<b||a>c||a!==g(a))throw Error(h+(d||"Argument")+("number"==typeof a?a<b||a>c?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function o(a){var b=a.c.length-1;return k(a.e/14)==b&&a.c[b]%2!=0}function p(a,b){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(b<0?"e":"e+")+b}function q(a,b,c){var d,e;if(b<0){for(e=c+".";++b;e+=c);a=e+a}else if(d=a.length,++b>d){for(e=c,b-=d;--b;e+=c);a+=e}else b<d&&(a=a.slice(0,b)+"."+a.slice(b));return a}if((d=function a(b){var c,d,r,s,t,u,v,w,x,y=M.prototype={constructor:M,toString:null,valueOf:null},z=new M(1),A=20,B=4,C=-7,D=21,E=-1e7,F=1e7,G=!1,H=1,I=0,J={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},K="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function M(a,b){var c,d,f,h,j,k,l,m,o=this;if(!(o instanceof M))return new M(a,b);if(null==b){if(a&&!0===a._isBigNumber){o.s=a.s,!a.c||a.e>F?o.c=o.e=null:a.e<E?o.c=[o.e=0]:(o.e=a.e,o.c=a.c.slice());return}if((k="number"==typeof a)&&0*a==0){if(o.s=1/a<0?(a=-a,-1):1,a===~~a){for(h=0,j=a;j>=10;j/=10,h++);h>F?o.c=o.e=null:(o.e=h,o.c=[a]);return}m=String(a)}else{if(!e.test(m=String(a)))return x(o,m,k);o.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(h=m.indexOf("."))>-1&&(m=m.replace(".","")),(j=m.search(/e/i))>0?(h<0&&(h=j),h+=+m.slice(j+1),m=m.substring(0,j)):h<0&&(h=m.length)}else{if(n(b,2,K.length,"Base"),10==b&&L)return Q(o=new M(a),A+o.e+1,B);if(m=String(a),k="number"==typeof a){if(0*a!=0)return x(o,m,k,b);if(o.s=1/a<0?(m=m.slice(1),-1):1,M.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(i+a)}else o.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(c=K.slice(0,b),h=j=0,l=m.length;j<l;j++)if(0>c.indexOf(d=m.charAt(j))){if("."==d){if(j>h){h=l;continue}}else if(!f&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){f=!0,j=-1,h=0;continue}return x(o,String(a),k,b)}k=!1,(h=(m=w(m,b,10,o.s)).indexOf("."))>-1?m=m.replace(".",""):h=m.length}for(j=0;48===m.charCodeAt(j);j++);for(l=m.length;48===m.charCodeAt(--l););if(m=m.slice(j,++l)){if(l-=j,k&&M.DEBUG&&l>15&&(a>0x1fffffffffffff||a!==g(a)))throw Error(i+o.s*a);if((h=h-j-1)>F)o.c=o.e=null;else if(h<E)o.c=[o.e=0];else{if(o.e=h,o.c=[],j=(h+1)%14,h<0&&(j+=14),j<l){for(j&&o.c.push(+m.slice(0,j)),l-=14;j<l;)o.c.push(+m.slice(j,j+=14));j=14-(m=m.slice(j)).length}else j-=l;for(;j--;m+="0");o.c.push(+m)}}else o.c=[o.e=0]}function N(a,b,c,d){var e,f,g,h,i;if(null==c?c=B:n(c,0,8),!a.c)return a.toString();if(e=a.c[0],g=a.e,null==b)i=l(a.c),i=1==d||2==d&&(g<=C||g>=D)?p(i,g):q(i,g,"0");else if(f=(a=Q(new M(a),b,c)).e,h=(i=l(a.c)).length,1==d||2==d&&(b<=f||f<=C)){for(;h<b;i+="0",h++);i=p(i,f)}else if(b-=g+(2===d&&f>g),i=q(i,f,"0"),f+1>h){if(--b>0)for(i+=".";b--;i+="0");}else if((b+=f-h)>0)for(f+1==h&&(i+=".");b--;i+="0");return a.s<0&&e?"-"+i:i}function O(a,b){for(var c,d,e=1,f=new M(a[0]);e<a.length;e++)(d=new M(a[e])).s&&(c=m(f,d))!==b&&(0!==c||f.s!==b)||(f=d);return f}function P(a,b,c){for(var d=1,e=b.length;!b[--e];b.pop());for(e=b[0];e>=10;e/=10,d++);return(c=d+14*c-1)>F?a.c=a.e=null:c<E?a.c=[a.e=0]:(a.e=c,a.c=b),a}function Q(a,b,c,d){var e,h,i,k,l,m,n,o=a.c;if(o){a:{for(e=1,k=o[0];k>=10;k/=10,e++);if((h=b-e)<0)h+=14,i=b,n=g((l=o[m=0])/j[e-i-1]%10);else if((m=f((h+1)/14))>=o.length)if(d){for(;o.length<=m;o.push(0));l=n=0,e=1,h%=14,i=h-14+1}else break a;else{for(e=1,l=k=o[m];k>=10;k/=10,e++);h%=14,n=(i=h-14+e)<0?0:g(l/j[e-i-1]%10)}if(d=d||b<0||null!=o[m+1]||(i<0?l:l%j[e-i-1]),d=c<4?(n||d)&&(0==c||c==(a.s<0?3:2)):n>5||5==n&&(4==c||d||6==c&&(h>0?i>0?l/j[e-i]:0:o[m-1])%10&1||c==(a.s<0?8:7)),b<1||!o[0])return o.length=0,d?(b-=a.e+1,o[0]=j[(14-b%14)%14],a.e=-b||0):o[0]=a.e=0,a;if(0==h?(o.length=m,k=1,m--):(o.length=m+1,k=j[14-h],o[m]=i>0?g(l/j[e-i]%j[i])*k:0),d)for(;;)if(0==m){for(h=1,i=o[0];i>=10;i/=10,h++);for(i=o[0]+=k,k=1;i>=10;i/=10,k++);h!=k&&(a.e++,1e14==o[0]&&(o[0]=1));break}else{if(o[m]+=k,1e14!=o[m])break;o[m--]=0,k=1}for(h=o.length;0===o[--h];o.pop());}a.e>F?a.c=a.e=null:a.e<E&&(a.c=[a.e=0])}return a}function R(a){var b,c=a.e;return null===c?a.toString():(b=l(a.c),b=c<=C||c>=D?p(b,c):q(b,c,"0"),a.s<0?"-"+b:b)}return M.clone=a,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(a){var b,c;if(null!=a)if("object"==typeof a){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(n(c=a[b],0,1e9,b),A=c),a.hasOwnProperty(b="ROUNDING_MODE")&&(n(c=a[b],0,8,b),B=c),a.hasOwnProperty(b="EXPONENTIAL_AT")&&((c=a[b])&&c.pop?(n(c[0],-1e9,0,b),n(c[1],0,1e9,b),C=c[0],D=c[1]):(n(c,-1e9,1e9,b),C=-(D=c<0?-c:c))),a.hasOwnProperty(b="RANGE"))if((c=a[b])&&c.pop)n(c[0],-1e9,-1,b),n(c[1],1,1e9,b),E=c[0],F=c[1];else if(n(c,-1e9,1e9,b),c)E=-(F=c<0?-c:c);else throw Error(h+b+" cannot be zero: "+c);if(a.hasOwnProperty(b="CRYPTO"))if(!!(c=a[b])===c)if(c)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))G=c;else throw G=!c,Error(h+"crypto unavailable");else G=c;else throw Error(h+b+" not true or false: "+c);if(a.hasOwnProperty(b="MODULO_MODE")&&(n(c=a[b],0,9,b),H=c),a.hasOwnProperty(b="POW_PRECISION")&&(n(c=a[b],0,1e9,b),I=c),a.hasOwnProperty(b="FORMAT"))if("object"==typeof(c=a[b]))J=c;else throw Error(h+b+" not an object: "+c);if(a.hasOwnProperty(b="ALPHABET")){if("string"!=typeof(c=a[b])||/^.?$|[+\-.\s]|(.).*\1/.test(c))throw Error(h+b+" invalid: "+c);L="0123456789"==c.slice(0,10),K=c}}else throw Error(h+"Object expected: "+a);return{DECIMAL_PLACES:A,ROUNDING_MODE:B,EXPONENTIAL_AT:[C,D],RANGE:[E,F],CRYPTO:G,MODULO_MODE:H,POW_PRECISION:I,FORMAT:J,ALPHABET:K}},M.isBigNumber=function(a){if(!a||!0!==a._isBigNumber)return!1;if(!M.DEBUG)return!0;var b,c,d=a.c,e=a.e,f=a.s;a:if("[object Array]"==({}).toString.call(d)){if((1===f||-1===f)&&e>=-1e9&&e<=1e9&&e===g(e)){if(0===d[0]){if(0===e&&1===d.length)return!0;break a}if((b=(e+1)%14)<1&&(b+=14),String(d[0]).length==b){for(b=0;b<d.length;b++)if((c=d[b])<0||c>=1e14||c!==g(c))break a;if(0!==c)return!0}}}else if(null===d&&null===e&&(null===f||1===f||-1===f))return!0;throw Error(h+"Invalid BigNumber: "+a)},M.maximum=M.max=function(){return O(arguments,-1)},M.minimum=M.min=function(){return O(arguments,1)},c=0x20000000000000*Math.random()&2097151?function(){return g(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},M.random=function(a){var b,d,e,i,k,l=0,m=[],o=new M(z);if(null==a?a=A:n(a,0,1e9),i=f(a/14),G)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(i*=2));l<i;)(k=131072*b[l]+(b[l+1]>>>11))>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[l]=d[0],b[l+1]=d[1]):(m.push(k%1e14),l+=2);l=i/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(i*=7);l<i;)(k=(31&b[l])*0x1000000000000+0x10000000000*b[l+1]+0x100000000*b[l+2]+0x1000000*b[l+3]+(b[l+4]<<16)+(b[l+5]<<8)+b[l+6])>=9e15?crypto.randomBytes(7).copy(b,l):(m.push(k%1e14),l+=7);l=i/7}else throw G=!1,Error(h+"crypto unavailable");if(!G)for(;l<i;)(k=c())<9e15&&(m[l++]=k%1e14);for(i=m[--l],a%=14,i&&a&&(k=j[14-a],m[l]=g(i/k)*k);0===m[l];m.pop(),l--);if(l<0)m=[e=0];else{for(e=-1;0===m[0];m.splice(0,1),e-=14);for(l=1,k=m[0];k>=10;k/=10,l++);l<14&&(e-=14-l)}return o.e=e,o.c=m,o},M.sum=function(){for(var a=1,b=arguments,c=new M(b[0]);a<b.length;)c=c.plus(b[a++]);return c},w=function(){var a="0123456789";function b(a,b,c,d){for(var e,f,g=[0],h=0,i=a.length;h<i;){for(f=g.length;f--;g[f]*=b);for(g[0]+=d.indexOf(a.charAt(h++)),e=0;e<g.length;e++)g[e]>c-1&&(null==g[e+1]&&(g[e+1]=0),g[e+1]+=g[e]/c|0,g[e]%=c)}return g.reverse()}return function(c,d,e,f,g){var h,i,j,k,m,n,o,p,r=c.indexOf("."),s=A,t=B;for(r>=0&&(k=I,I=0,c=c.replace(".",""),n=(p=new M(d)).pow(c.length-r),I=k,p.c=b(q(l(n.c),n.e,"0"),10,e,a),p.e=p.c.length),j=k=(o=b(c,d,e,g?(h=K,a):(h=a,K))).length;0==o[--k];o.pop());if(!o[0])return h.charAt(0);if(r<0?--j:(n.c=o,n.e=j,n.s=f,o=(n=v(n,p,s,t,e)).c,m=n.r,j=n.e),r=o[i=j+s+1],k=e/2,m=m||i<0||null!=o[i+1],m=t<4?(null!=r||m)&&(0==t||t==(n.s<0?3:2)):r>k||r==k&&(4==t||m||6==t&&1&o[i-1]||t==(n.s<0?8:7)),i<1||!o[0])c=m?q(h.charAt(1),-s,h.charAt(0)):h.charAt(0);else{if(o.length=i,m)for(--e;++o[--i]>e;)o[i]=0,i||(++j,o=[1].concat(o));for(k=o.length;!o[--k];);for(r=0,c="";r<=k;c+=h.charAt(o[r++]));c=q(c,j,h.charAt(0))}return c}}(),v=function(){function a(a,b,c){var d,e,f,g,h=0,i=a.length,j=b%1e7,k=b/1e7|0;for(a=a.slice();i--;)d=k*(f=a[i]%1e7)+(g=a[i]/1e7|0)*j,h=((e=j*f+d%1e7*1e7+h)/c|0)+(d/1e7|0)+k*g,a[i]=e%c;return h&&(a=[h].concat(a)),a}function b(a,b,c,d){var e,f;if(c!=d)f=c>d?1:-1;else for(e=f=0;e<c;e++)if(a[e]!=b[e]){f=a[e]>b[e]?1:-1;break}return f}function c(a,b,c,d){for(var e=0;c--;)a[c]-=e,e=+(a[c]<b[c]),a[c]=e*d+a[c]-b[c];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(d,e,f,h,i){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=d.s==e.s?1:-1,C=d.c,D=e.c;if(!C||!C[0]||!D||!D[0])return new M(!d.s||!e.s||(C?D&&C[0]==D[0]:!D)?NaN:C&&0==C[0]||!D?0*B:B/0);for(s=(r=new M(B)).c=[],B=f+(l=d.e-e.e)+1,i||(i=1e14,l=k(d.e/14)-k(e.e/14),B=B/14|0),m=0;D[m]==(C[m]||0);m++);if(D[m]>(C[m]||0)&&l--,B<0)s.push(1),n=!0;else{for(x=C.length,z=D.length,m=0,B+=2,(o=g(i/(D[0]+1)))>1&&(D=a(D,o,i),C=a(C,o,i),z=D.length,x=C.length),w=z,u=(t=C.slice(0,z)).length;u<z;t[u++]=0);A=[0].concat(A=D.slice()),y=D[0],D[1]>=i/2&&y++;do{if(o=0,(j=b(D,t,z,u))<0){if(v=t[0],z!=u&&(v=v*i+(t[1]||0)),(o=g(v/y))>1)for(o>=i&&(o=i-1),q=(p=a(D,o,i)).length,u=t.length;1==b(p,t,q,u);)o--,c(p,z<q?A:D,q,i),q=p.length,j=1;else 0==o&&(j=o=1),q=(p=D.slice()).length;if(q<u&&(p=[0].concat(p)),c(t,p,u,i),u=t.length,-1==j)for(;1>b(D,t,z,u);)o++,c(t,z<u?A:D,u,i),u=t.length}else 0===j&&(o++,t=[0]);s[m++]=o,t[0]?t[u++]=C[w]||0:(t=[C[w]],u=1)}while((w++<x||null!=t[0])&&B--)n=null!=t[0],s[0]||s.splice(0,1)}if(1e14==i){for(m=1,B=s[0];B>=10;B/=10,m++);Q(r,f+(r.e=m+14*l-1)+1,h,n)}else r.e=l,r.r=+n;return r}}(),d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,r=/^([^.]+)\.$/,s=/^\.([^.]+)$/,t=/^-?(Infinity|NaN)$/,u=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(a,b,c,e){var f,g=c?b:b.replace(u,"");if(t.test(g))a.s=isNaN(g)?null:g<0?-1:1;else{if(!c&&(g=g.replace(d,function(a,b,c){return f="x"==(c=c.toLowerCase())?16:"b"==c?2:8,e&&e!=f?a:b}),e&&(f=e,g=g.replace(r,"$1").replace(s,"0.$1")),b!=g))return new M(g,f);if(M.DEBUG)throw Error(h+"Not a"+(e?" base "+e:"")+" number: "+b);a.s=null}a.c=a.e=null},y.absoluteValue=y.abs=function(){var a=new M(this);return a.s<0&&(a.s=1),a},y.comparedTo=function(a,b){return m(this,new M(a,b))},y.decimalPlaces=y.dp=function(a,b){var c,d,e;if(null!=a)return n(a,0,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a+this.e+1,b);if(!(c=this.c))return null;if(d=((e=c.length-1)-k(this.e/14))*14,e=c[e])for(;e%10==0;e/=10,d--);return d<0&&(d=0),d},y.dividedBy=y.div=function(a,b){return v(this,new M(a,b),A,B)},y.dividedToIntegerBy=y.idiv=function(a,b){return v(this,new M(a,b),0,1)},y.exponentiatedBy=y.pow=function(a,b){var c,d,e,i,j,k,l,m,n,p=this;if((a=new M(a)).c&&!a.isInteger())throw Error(h+"Exponent not an integer: "+R(a));if(null!=b&&(b=new M(b)),k=a.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!a.c||!a.c[0])return n=new M(Math.pow(+R(p),k?a.s*(2-o(a)):+R(a))),b?n.mod(b):n;if(l=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new M(NaN);(d=!l&&p.isInteger()&&b.isInteger())&&(p=p.mod(b))}else{if(a.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||k&&p.c[1]>=24e7:p.c[0]<8e13||k&&p.c[0]<=9999975e7)))return i=p.s<0&&o(a)?-0:0,p.e>-1&&(i=1/i),new M(l?1/i:i);I&&(i=f(I/14+2))}for(k?(c=new M(.5),l&&(a.s=1),m=o(a)):m=(e=Math.abs(+R(a)))%2,n=new M(z);;){if(m){if(!(n=n.times(p)).c)break;i?n.c.length>i&&(n.c.length=i):d&&(n=n.mod(b))}if(e){if(0===(e=g(e/2)))break;m=e%2}else if(Q(a=a.times(c),a.e+1,1),a.e>14)m=o(a);else{if(0==(e=+R(a)))break;m=e%2}p=p.times(p),i?p.c&&p.c.length>i&&(p.c.length=i):d&&(p=p.mod(b))}return d?n:(l&&(n=z.div(n)),b?n.mod(b):i?Q(n,I,B,j):n)},y.integerValue=function(a){var b=new M(this);return null==a?a=B:n(a,0,8),Q(b,b.e+1,a)},y.isEqualTo=y.eq=function(a,b){return 0===m(this,new M(a,b))},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(a,b){return m(this,new M(a,b))>0},y.isGreaterThanOrEqualTo=y.gte=function(a,b){return 1===(b=m(this,new M(a,b)))||0===b},y.isInteger=function(){return!!this.c&&k(this.e/14)>this.c.length-2},y.isLessThan=y.lt=function(a,b){return 0>m(this,new M(a,b))},y.isLessThanOrEqualTo=y.lte=function(a,b){return -1===(b=m(this,new M(a,b)))||0===b},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return this.s>0},y.isZero=function(){return!!this.c&&0==this.c[0]},y.minus=function(a,b){var c,d,e,f,g=this.s;if(b=(a=new M(a,b)).s,!g||!b)return new M(NaN);if(g!=b)return a.s=-b,this.plus(a);var h=this.e/14,i=a.e/14,j=this.c,l=a.c;if(!h||!i){if(!j||!l)return j?(a.s=-b,a):new M(l?this:NaN);if(!j[0]||!l[0])return l[0]?(a.s=-b,a):new M(j[0]?this:3==B?-0:0)}if(h=k(h),i=k(i),j=j.slice(),g=h-i){for((f=g<0)?(g=-g,e=j):(i=h,e=l),e.reverse(),b=g;b--;e.push(0));e.reverse()}else for(d=(f=(g=j.length)<(b=l.length))?g:b,g=b=0;b<d;b++)if(j[b]!=l[b]){f=j[b]<l[b];break}if(f&&(e=j,j=l,l=e,a.s=-a.s),(b=(d=l.length)-(c=j.length))>0)for(;b--;j[c++]=0);for(b=1e14-1;d>g;){if(j[--d]<l[d]){for(c=d;c&&!j[--c];j[c]=b);--j[c],j[d]+=1e14}j[d]-=l[d]}for(;0==j[0];j.splice(0,1),--i);return j[0]?P(a,j,i):(a.s=3==B?-1:1,a.c=[a.e=0],a)},y.modulo=y.mod=function(a,b){var c,d;return(a=new M(a,b),this.c&&a.s&&(!a.c||a.c[0]))?a.c&&(!this.c||this.c[0])?(9==H?(d=a.s,a.s=1,c=v(this,a,0,3),a.s=d,c.s*=d):c=v(this,a,0,H),(a=this.minus(c.times(a))).c[0]||1!=H||(a.s=this.s),a):new M(this):new M(NaN)},y.multipliedBy=y.times=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q=this.c,r=(a=new M(a,b)).c;if(!q||!r||!q[0]||!r[0])return this.s&&a.s&&(!q||q[0]||r)&&(!r||r[0]||q)?(a.s*=this.s,q&&r?(a.c=[0],a.e=0):a.c=a.e=null):a.c=a.e=a.s=null,a;for(d=k(this.e/14)+k(a.e/14),a.s*=this.s,(i=q.length)<(m=r.length)&&(p=q,q=r,r=p,e=i,i=m,m=e),e=i+m,p=[];e--;p.push(0));for(e=m;--e>=0;){for(c=0,n=r[e]%1e7,o=r[e]/1e7|0,f=e+(g=i);f>e;)h=o*(j=q[--g]%1e7)+(l=q[g]/1e7|0)*n,c=((j=n*j+h%1e7*1e7+p[f]+c)/1e14|0)+(h/1e7|0)+o*l,p[f--]=j%1e14;p[f]=c}return c?++d:p.splice(0,1),P(a,p,d)},y.negated=function(){var a=new M(this);return a.s=-a.s||null,a},y.plus=function(a,b){var c,d=this.s;if(b=(a=new M(a,b)).s,!d||!b)return new M(NaN);if(d!=b)return a.s=-b,this.minus(a);var e=this.e/14,f=a.e/14,g=this.c,h=a.c;if(!e||!f){if(!g||!h)return new M(d/0);if(!g[0]||!h[0])return h[0]?a:new M(g[0]?this:0*d)}if(e=k(e),f=k(f),g=g.slice(),d=e-f){for(d>0?(f=e,c=h):(d=-d,c=g),c.reverse();d--;c.push(0));c.reverse()}for((d=g.length)-(b=h.length)<0&&(c=h,h=g,g=c,b=d),d=0;b;)d=(g[--b]=g[b]+h[b]+d)/1e14|0,g[b]=1e14===g[b]?0:g[b]%1e14;return d&&(g=[d].concat(g),++f),P(a,g,f)},y.precision=y.sd=function(a,b){var c,d,e;if(null!=a&&!!a!==a)return n(a,1,1e9),null==b?b=B:n(b,0,8),Q(new M(this),a,b);if(!(c=this.c))return null;if(d=14*(e=c.length-1)+1,e=c[e]){for(;e%10==0;e/=10,d--);for(e=c[0];e>=10;e/=10,d++);}return a&&this.e+1>d&&(d=this.e+1),d},y.shiftedBy=function(a){return n(a,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+a)},y.squareRoot=y.sqrt=function(){var a,b,c,d,e,f=this.c,g=this.s,h=this.e,i=A+4,j=new M("0.5");if(1!==g||!f||!f[0])return new M(!g||g<0&&(!f||f[0])?NaN:f?this:1/0);if(0==(g=Math.sqrt(+R(this)))||g==1/0?(((b=l(f)).length+h)%2==0&&(b+="0"),g=Math.sqrt(+b),h=k((h+1)/2)-(h<0||h%2),c=new M(b=g==1/0?"5e"+h:(b=g.toExponential()).slice(0,b.indexOf("e")+1)+h)):c=new M(g+""),c.c[0]){for((g=(h=c.e)+i)<3&&(g=0);;)if(e=c,c=j.times(e.plus(v(this,e,i,1))),l(e.c).slice(0,g)===(b=l(c.c)).slice(0,g)){if(c.e<h&&--g,"9999"!=(b=b.slice(g-3,g+1))&&(d||"4999"!=b)){+b&&(+b.slice(1)||"5"!=b.charAt(0))||(Q(c,c.e+A+2,1),a=!c.times(c).eq(this));break}if(!d&&(Q(e,e.e+A+2,0),e.times(e).eq(this))){c=e;break}i+=4,g+=4,d=1}}return Q(c,c.e+A+1,B,a)},y.toExponential=function(a,b){return null!=a&&(n(a,0,1e9),a++),N(this,a,b,1)},y.toFixed=function(a,b){return null!=a&&(n(a,0,1e9),a=a+this.e+1),N(this,a,b)},y.toFormat=function(a,b,c){var d;if(null==c)null!=a&&b&&"object"==typeof b?(c=b,b=null):a&&"object"==typeof a?(c=a,a=b=null):c=J;else if("object"!=typeof c)throw Error(h+"Argument not an object: "+c);if(d=this.toFixed(a,b),this.c){var e,f=d.split("."),g=+c.groupSize,i=+c.secondaryGroupSize,j=c.groupSeparator||"",k=f[0],l=f[1],m=this.s<0,n=m?k.slice(1):k,o=n.length;if(i&&(e=g,g=i,i=e,o-=e),g>0&&o>0){for(e=o%g||g,k=n.substr(0,e);e<o;e+=g)k+=j+n.substr(e,g);i>0&&(k+=j+n.slice(e)),m&&(k="-"+k)}d=l?k+(c.decimalSeparator||"")+((i=+c.fractionGroupSize)?l.replace(RegExp("\\d{"+i+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):l):k}return(c.prefix||"")+d+(c.suffix||"")},y.toFraction=function(a){var b,c,d,e,f,g,i,k,m,n,o,p,q=this.c;if(null!=a&&(!(i=new M(a)).isInteger()&&(i.c||1!==i.s)||i.lt(z)))throw Error(h+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+R(i));if(!q)return new M(this);for(b=new M(z),m=c=new M(z),d=k=new M(z),p=l(q),f=b.e=p.length-this.e-1,b.c[0]=j[(g=f%14)<0?14+g:g],a=!a||i.comparedTo(b)>0?f>0?b:m:i,g=F,F=1/0,i=new M(p),k.c[0]=0;n=v(i,b,0,1),1!=(e=c.plus(n.times(d))).comparedTo(a);)c=d,d=e,m=k.plus(n.times(e=m)),k=e,b=i.minus(n.times(e=b)),i=e;return e=v(a.minus(c),d,0,1),k=k.plus(e.times(m)),c=c.plus(e.times(d)),k.s=m.s=this.s,f*=2,o=1>v(m,d,f,B).minus(this).abs().comparedTo(v(k,c,f,B).minus(this).abs())?[m,d]:[k,c],F=g,o},y.toNumber=function(){return+R(this)},y.toPrecision=function(a,b){return null!=a&&n(a,1,1e9),N(this,a,b,2)},y.toString=function(a){var b,c=this,d=c.s,e=c.e;return null===e?d?(b="Infinity",d<0&&(b="-"+b)):b="NaN":(null==a?b=e<=C||e>=D?p(l(c.c),e):q(l(c.c),e,"0"):10===a&&L?b=q(l((c=Q(new M(c),A+e+1,B)).c),c.e,"0"):(n(a,2,K.length,"Base"),b=w(q(l(c.c),e,"0"),10,a,d,!0)),d<0&&c.c[0]&&(b="-"+b)),b},y.valueOf=y.toJSON=function(){return R(this)},y._isBigNumber=!0,null!=b&&M.set(b),M}()).default=d.BigNumber=d,"function"==typeof define&&define.amd)a.r,void 0!==d&&a.v(d);else b.exports?b.exports=d:(c||(c="undefined"!=typeof self&&self?self:window),c.BigNumber=d)}(a.e)},47006,(a,b,c)=>{var d=a.r(30168),e=b.exports;!function(){"use strict";var a,b,c,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function h(a){return f.lastIndex=0,f.test(a)?'"'+a.replace(f,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof e.stringify&&(e.stringify=function(e,f,g){var i;if(a="",b="","number"==typeof g)for(i=0;i<g;i+=1)b+=" ";else"string"==typeof g&&(b=g);if(c=f,f&&"function"!=typeof f&&("object"!=typeof f||"number"!=typeof f.length))throw Error("JSON.stringify");return function e(f,g){var i,j,k,l,m,n=a,o=g[f],p=null!=o&&(o instanceof d||d.isBigNumber(o));switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(f)),"function"==typeof c&&(o=c.call(g,f,o)),typeof o){case"string":if(p)return o;return h(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":case"bigint":return String(o);case"object":if(!o)return"null";if(a+=b,m=[],"[object Array]"===Object.prototype.toString.apply(o)){for(i=0,l=o.length;i<l;i+=1)m[i]=e(i,o)||"null";return k=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+n+"]":"["+m.join(",")+"]",a=n,k}if(c&&"object"==typeof c)for(i=0,l=c.length;i<l;i+=1)"string"==typeof c[i]&&(k=e(j=c[i],o))&&m.push(h(j)+(a?": ":":")+k);else Object.keys(o).forEach(function(b){var c=e(b,o);c&&m.push(h(b)+(a?": ":":")+c)});return k=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+n+"}":"{"+m.join(",")+"}",a=n,k}}("",{"":e})})}()},27545,(a,b,c)=>{var d=null;let e=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,f=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;b.exports=function(b){"use strict";var c={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=b){if(!0===b.strict&&(c.strict=!0),!0===b.storeAsString&&(c.storeAsString=!0),c.alwaysParseAsBig=!0===b.alwaysParseAsBig&&b.alwaysParseAsBig,c.useNativeBigInt=!0===b.useNativeBigInt&&b.useNativeBigInt,void 0!==b.constructorAction)if("error"===b.constructorAction||"ignore"===b.constructorAction||"preserve"===b.constructorAction)c.constructorAction=b.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${b.constructorAction}`);if(void 0!==b.protoAction)if("error"===b.protoAction||"ignore"===b.protoAction||"preserve"===b.protoAction)c.protoAction=b.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${b.protoAction}`)}var g,h,i,j,k={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(a){throw{name:"SyntaxError",message:a,at:g,text:i}},m=function(a){return a&&a!==h&&l("Expected '"+a+"' instead of '"+h+"'"),h=i.charAt(g),g+=1,h},n=function(){var b,e="";for("-"===h&&(e="-",m("-"));h>="0"&&h<="9";)e+=h,m();if("."===h)for(e+=".";m()&&h>="0"&&h<="9";)e+=h;if("e"===h||"E"===h)for(e+=h,m(),("-"===h||"+"===h)&&(e+=h,m());h>="0"&&h<="9";)e+=h,m();if(isFinite(b=+e))return(null==d&&(d=a.r(30168)),e.length>15)?c.storeAsString?e:c.useNativeBigInt?BigInt(e):new d(e):c.alwaysParseAsBig?c.useNativeBigInt?BigInt(b):new d(b):b;l("Bad number")},o=function(){var a,b,c,d="";if('"'===h)for(var e=g;m();){if('"'===h)return g-1>e&&(d+=i.substring(e,g-1)),m(),d;if("\\"===h){if(g-1>e&&(d+=i.substring(e,g-1)),m(),"u"===h){for(b=0,c=0;b<4&&isFinite(a=parseInt(m(),16));b+=1)c=16*c+a;d+=String.fromCharCode(c)}else if("string"==typeof k[h])d+=k[h];else break;e=g}}l("Bad string")},p=function(){for(;h&&h<=" ";)m()},q=function(){switch(h){case"t":return m("t"),m("r"),m("u"),m("e"),!0;case"f":return m("f"),m("a"),m("l"),m("s"),m("e"),!1;case"n":return m("n"),m("u"),m("l"),m("l"),null}l("Unexpected '"+h+"'")},r=function(){var a=[];if("["===h){if(m("["),p(),"]"===h)return m("]"),a;for(;h;){if(a.push(j()),p(),"]"===h)return m("]"),a;m(","),p()}}l("Bad array")},s=function(){var a,b=Object.create(null);if("{"===h){if(m("{"),p(),"}"===h)return m("}"),b;for(;h;){if(a=o(),p(),m(":"),!0===c.strict&&Object.hasOwnProperty.call(b,a)&&l('Duplicate key "'+a+'"'),!0===e.test(a)?"error"===c.protoAction?l("Object contains forbidden prototype property"):"ignore"===c.protoAction?j():b[a]=j():!0===f.test(a)?"error"===c.constructorAction?l("Object contains forbidden constructor property"):"ignore"===c.constructorAction?j():b[a]=j():b[a]=j(),p(),"}"===h)return m("}"),b;m(","),p()}}l("Bad object")};return j=function(){switch(p(),h){case"{":return s();case"[":return r();case'"':return o();case"-":return n();default:return h>="0"&&h<="9"?n():q()}},function(a,b){var c;return i=a+"",g=0,h=" ",c=j(),p(),h&&l("Syntax error"),"function"==typeof b?function a(c,d){var e,f=c[d];return f&&"object"==typeof f&&Object.keys(f).forEach(function(b){void 0!==(e=a(f,b))?f[b]=e:delete f[b]}),b.call(c,d,f)}({"":c},""):c}}},31553,(a,b,c)=>{var d=a.r(47006).stringify,e=a.r(27545);b.exports=function(a){return{parse:e(a),stringify:d}},b.exports.parse=e(),b.exports.stringify=d},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},5365,(a,b,c)=>{b.exports=a.x("process",()=>require("process"))},22852,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Colours=void 0;class d{static isEnabled(a){return a&&a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){d.enabled=d.isEnabled(null==process?void 0:process.stderr),this.enabled?(d.reset="\x1b[0m",d.bright="\x1b[1m",d.dim="\x1b[2m",d.red="\x1b[31m",d.green="\x1b[32m",d.yellow="\x1b[33m",d.blue="\x1b[34m",d.magenta="\x1b[35m",d.cyan="\x1b[36m",d.white="\x1b[37m",d.grey="\x1b[90m"):(d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="")}}c.Colours=d,d.enabled=!1,d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="",d.refresh()},91100,(a,b,c)=>{"use strict";let d;var e,f,g,h=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),i=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),j=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&h(b,a,c[d]);return i(b,a),b});Object.defineProperty(c,"__esModule",{value:!0}),c.env=c.DebugLogBackendBase=c.placeholder=c.AdhocDebugLogger=c.LogSeverity=void 0,c.getNodeBackend=r,c.getDebugBackend=function(a){return new s(a)},c.getStructuredBackend=function(a){return new t(a)},c.setBackend=function(a){d=a,u.clear()},c.log=v;let k=a.r(27699),l=j(a.r(5365)),m=j(a.r(24361)),n=a.r(22852);(f=g||(c.LogSeverity=g={})).DEFAULT="DEFAULT",f.DEBUG="DEBUG",f.INFO="INFO",f.WARNING="WARNING",f.ERROR="ERROR";class o extends k.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(g.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(g.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(g.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(g.ERROR,...a),this.func.sublog=a=>v(a,this.func)}invoke(a,...b){if(this.upstream)try{this.upstream(a,...b)}catch(a){}try{this.emit("log",a,b)}catch(a){}}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}c.AdhocDebugLogger=o,c.placeholder=new o("",()=>{}).func;class p{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let b=null!=(a=l.env[c.env.nodeEnables])?a:"*";"all"===b&&(b="*"),this.filters=b.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}c.DebugLogBackendBase=p;class q extends p{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let e,f=`${n.Colours.green}${a}${n.Colours.reset}`,h=`${n.Colours.yellow}${l.pid}${n.Colours.reset}`;switch(b.severity){case g.ERROR:e=`${n.Colours.red}${b.severity}${n.Colours.reset}`;break;case g.INFO:e=`${n.Colours.magenta}${b.severity}${n.Colours.reset}`;break;case g.WARNING:e=`${n.Colours.yellow}${b.severity}${n.Colours.reset}`;break;default:e=null!=(d=b.severity)?d:g.DEFAULT}let i=m.formatWithOptions({colors:n.Colours.enabled},...c),j=Object.assign({},b);delete j.severity;let k=Object.getOwnPropertyNames(j).length?JSON.stringify(j):"",o=k?`${n.Colours.grey}${k}${n.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,f,e,i,k?` ${o}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function r(){return new q}class s extends p{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=l.env.NODE_DEBUG)?a:"";l.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class t extends p{constructor(a){super(),this.upstream=null!=a?a:void 0}makeLogger(a){var b;let c=null==(b=this.upstream)?void 0:b.makeLogger(a);return(a,...b)=>{var d;let e=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:g.INFO,message:m.format(...b)},a));c?c(a,e):console.log("%s",e)}}setFilters(){var a;null==(a=this.upstream)||a.setFilters()}}c.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let u=new Map;function v(a,b){let e;if(!d&&!l.env[c.env.nodeEnables]||!a)return c.placeholder;b&&(a=`${b.instance.namespace}:${a}`);let f=u.get(a);if(f)return f.func;if(null===d)return c.placeholder;void 0===d&&(d=r());let g=new o(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=r()),e=d}null==d||d.log(a,b,...c)});return u.set(a,g),g.func}},15979,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(91100),c)},54145,(a,b,c)=>{"use strict";let d;var e,f=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),g=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),h=a.e&&a.e.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&f(b,a,c[d]);return g(b,a),b}),i=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||f(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.gcpResidencyCache=c.METADATA_SERVER_DETECTION=c.HEADERS=c.HEADER_VALUE=c.HEADER_NAME=c.SECONDARY_HOST_ADDRESS=c.HOST_ADDRESS=c.BASE_PATH=void 0,c.instance=function(a){return p("instance",a)},c.project=function(a){return p("project",a)},c.universe=function(a){return p("universe",a)},c.bulk=r,c.isAvailable=s,c.resetIsAvailableCache=function(){d=void 0},c.getGCPResidency=t,c.setGCPResidency=u,c.requestTimeout=v;let j=a.r(99853),k=a.r(31553),l=a.r(37062),m=h(a.r(15979));c.BASE_PATH="/computeMetadata/v1",c.HOST_ADDRESS="http://169.254.169.254",c.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",c.HEADER_NAME="Metadata-Flavor",c.HEADER_VALUE="Google",c.HEADERS=Object.freeze({[c.HEADER_NAME]:c.HEADER_VALUE});let n=m.log("gcp-metadata");function o(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||c.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(c.BASE_PATH,a).href}async function p(a,b={},d=3,e=!1){let f=new Headers(c.HEADERS),g="",h={};("object"==typeof a?(new Headers(a.headers).forEach((a,b)=>f.set(b,a)),g=a.metadataKey,h=a.params||h,d=a.noResponseRetries||d,e=a.fastFail||e):g=a,"string"==typeof b)?g+=`/${b}`:(Object.keys(b).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),b.property&&(g+=`/${b.property}`),new Headers(b.headers).forEach((a,b)=>f.set(b,a)),h=b.params||h);let i=e?q:j.request,l={url:`${o()}/${g}`,headers:f,retryConfig:{noResponseRetries:d},params:h,responseType:"text",timeout:v()};n.info("instance request %j",l);let m=await i(l);n.info("instance metadata is %s",m.data);let r=m.headers.get(c.HEADER_NAME);if(r!==c.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${c.HEADER_NAME} header. Expected '${c.HEADER_VALUE}', got ${r?`'${r}'`:"no header"}`);if("string"==typeof m.data)try{return k.parse(m.data)}catch{}return m.data}async function q(a){let b={...a,url:a.url?.toString().replace(o(),o(c.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,j.request)(a),(0,j.request)(b)])}async function r(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await p(a);b[a.metadataKey]=c})())),b}async function s(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in c.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(c.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return t()}}try{return void 0===d&&(d=p("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code.toString()))){let b="UNKNOWN";a.code&&(b=a.code.toString()),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function t(){return null===c.gcpResidencyCache&&u(),c.gcpResidencyCache}function u(a=null){c.gcpResidencyCache=null!==a?a:(0,l.detectGCPResidency)()}function v(){return 3e3*!t()}c.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),c.gcpResidencyCache=null,i(a.r(37062),c)},35863,(a,b,c)=>{"use strict";c.byteLength=function(a){var b=j(a),c=b[0],d=b[1];return(c+d)*3/4-d},c.toByteArray=function(a){var b,c,d=j(a),g=d[0],h=d[1],i=new f((g+h)*3/4-h),k=0,l=h>0?g-4:g;for(c=0;c<l;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],i[k++]=b>>16&255,i[k++]=b>>8&255,i[k++]=255&b;return 2===h&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,i[k++]=255&b),1===h&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,i[k++]=b>>8&255,i[k++]=255&b),i},c.fromByteArray=function(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(function(a,b,c){for(var e,f=[],g=b;g<c;g+=3)e=(a[g]<<16&0xff0000)+(a[g+1]<<8&65280)+(255&a[g+2]),f.push(d[e>>18&63]+d[e>>12&63]+d[e>>6&63]+d[63&e]);return f.join("")}(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")};for(var d=[],e=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,i=g.length;h<i;++h)d[h]=g[h],e[g.charCodeAt(h)]=h;function j(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}e[45]=62,e[95]=63},66051,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")}},26410,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BrowserCrypto=void 0;let d=a.r(35863),e=a.r(66051);class f{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}c.BrowserCrypto=f},66414,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NodeCrypto=void 0;let d=a.r(54799);c.NodeCrypto=class{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}},65726,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.createCrypto=function(){return function(){;}(),new f.NodeCrypto},c.hasBrowserCrypto=g,a.r(26410);let f=a.r(66414);function g(){return!1}e(a.r(66051),c)},45706,(a,b,c)=>{b.exports=a.x("querystring",()=>require("querystring"))},74898,(a,b,c)=>{var d=a.r(874),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?b.exports=d:(f(d,c),c.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},79106,(a,b,c)=>{"use strict";function d(a){return(a/8|0)+ +(a%8!=0)}var e={ES256:d(256),ES384:d(384),ES512:d(521)};b.exports=function(a){var b=e[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},8863,(a,b,c)=>{"use strict";var d=a.r(74898).Buffer,e=a.r(79106);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}b.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var n=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var o=c-k,p=c-m,q=d.allocUnsafe(o+k+p+m);for(i=0;i<o;++i)q[i]=0;a.copy(q,i,l+Math.max(-o,0),l+k),i=c;for(var r=i;i<r+p;++i)q[i]=0;return a.copy(q,i,n+Math.max(-p,0),n+m),q=(q=q.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,n=m<128,o=d.allocUnsafe((n?2:3)+m),p=0;return o[p++]=48,n?o[p++]=m:(o[p++]=129,o[p++]=255&m),o[p++]=2,o[p++]=k,i<0?(o[p++]=0,p+=a.copy(o,p,0,c)):p+=a.copy(o,p,i,c),o[p++]=2,o[p++]=l,j<0?(o[p++]=0,a.copy(o,p,c)):a.copy(o,p,c+j),o}}},98126,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LRUCache=void 0,c.snakeToCamel=h,c.originalOrCamelOptions=function(a){return{get:function(b){let c=a||{};return c[b]??c[h(b)]}}},c.removeUndefinedValuesInObject=function(a){return Object.entries(a).forEach(([b,c])=>{(void 0===c||"undefined"===c)&&delete a[b]}),a},c.isValidFile=j,c.getWellKnownCertificateConfigFileLocation=function(){let a=process.env.CLOUDSDK_CONFIG||(e.platform().startsWith("win")?f.join(process.env.APPDATA||"",g):f.join(process.env.HOME||"",".config",g));return f.join(a,"certificate_config.json")};let d=a.r(22734),e=a.r(46786),f=a.r(14747),g="gcloud";function h(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}class i{capacity;#j=new Map;maxAge;constructor(a){this.capacity=a.capacity,this.maxAge=a.maxAge}#k(a,b){this.#j.delete(a),this.#j.set(a,{value:b,lastAccessed:Date.now()})}set(a,b){this.#k(a,b),this.#l()}get(a){let b=this.#j.get(a);if(b)return this.#k(a,b.value),this.#l(),b.value}#l(){let a=this.maxAge?Date.now()-this.maxAge:0,b=this.#j.entries().next();for(;!b.done&&(this.#j.size>this.capacity||b.value[1].lastAccessed<a);)this.#j.delete(b.value[0]),b=this.#j.entries().next()}}async function j(a){try{return(await d.promises.lstat(a)).isFile()}catch(a){return!1}}c.LRUCache=i},91829,a=>{a.v({name:"google-auth-library",version:"10.5.0",author:"Google Inc.",description:"Google APIs Authentication Client Library for Node.js",engines:{node:">=18"},main:"./build/src/index.js",types:"./build/src/index.d.ts",repository:"googleapis/google-auth-library-nodejs.git",keywords:["google","api","google apis","client","client library"],dependencies:{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11",gaxios:"^7.0.0","gcp-metadata":"^8.0.0","google-logging-utils":"^1.0.0",gtoken:"^8.0.0",jws:"^4.0.0"},devDependencies:{"@types/base64-js":"^1.2.5","@types/jws":"^3.1.0","@types/mocha":"^10.0.10","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0",c8:"^10.0.0",codecov:"^3.0.2",gts:"^6.0.0","is-docker":"^3.0.0",jsdoc:"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0",karma:"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1",keypair:"^1.0.4",mocha:"^11.1.0",mv:"^2.1.1",ncp:"^2.0.0",nock:"^14.0.5","null-loader":"^4.0.0",puppeteer:"^24.0.0",sinon:"^21.0.0","ts-loader":"^8.0.0",typescript:"5.8.2",webpack:"^5.21.2","webpack-cli":"^4.0.0"},files:["build/src","!build/src/**/*.map"],scripts:{test:"c8 mocha build/test",clean:"gts clean",prepare:"npm run compile",lint:"gts check --no-inline-config",compile:"tsc -p .",fix:"gts fix",pretest:"npm run compile -- --sourceMap",docs:"jsdoc -c .jsdoc.js","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap",webpack:"webpack","browser-test":"karma start","docs-test":"echo 'disabled until linkinator is fixed'","predocs-test":"npm run docs",prelint:"cd samples; npm link ../; npm install"},license:"Apache-2.0"})},15204,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.USER_AGENT=c.PRODUCT_NAME=c.pkg=void 0;let d=a.r(91829);c.pkg=d;let e="google-api-nodejs-client";c.PRODUCT_NAME=e,c.USER_AGENT=`${e}/${d.version}`},30190,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AuthClient=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=c.DEFAULT_UNIVERSE=void 0;let d=a.r(27699),e=a.r(99853),f=a.r(98126),g=a.r(15979),h=a.r(15204);c.DEFAULT_UNIVERSE="googleapis.com",c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class i extends d.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=c.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(a={}){super();const b=(0,f.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=b.get("project_id")??null,this.quotaProjectId=b.get("quota_project_id"),this.credentials=b.get("credentials")??{},this.universeDomain=b.get("universe_domain")??c.DEFAULT_UNIVERSE,this.transporter=a.transporter??new e.Gaxios(a.transporterOptions),!1!==b.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(i.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(i.DEFAULT_RESPONSE_INTERCEPTOR)),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=a.forceRefreshOnFailure??!1}fetch(...a){let b,c=a[0],d=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&e.Gaxios.mergeHeaders(f,c.headers),d&&e.Gaxios.mergeHeaders(f,new Headers(d.headers)),"object"!=typeof c||c instanceof URL)?this.request({...d,headers:f,url:b}):this.request({...d,...c,headers:f,url:b})}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a.has("x-goog-user-project")&&this.quotaProjectId&&a.set("x-goog-user-project",this.quotaProjectId),a}addUserProjectAndAuthHeaders(a,b){let c=b.get("x-goog-user-project"),d=b.get("authorization");return c&&a.set("x-goog-user-project",c),d&&a.set("authorization",d),a}static log=(0,g.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async a=>{if(!a.headers.has("x-goog-api-client")){let b=process.version.replace(/^v/,"");a.headers.set("x-goog-api-client",`gl-node/${b}`)}let b=a.headers.get("User-Agent");b?b.includes(`${h.PRODUCT_NAME}/`)||a.headers.set("User-Agent",`${b} ${h.USER_AGENT}`):a.headers.set("User-Agent",h.USER_AGENT);try{let b=a[i.RequestMethodNameSymbol],c=`${Math.floor(1e3*Math.random())}`;a[i.RequestLogIdSymbol]=c;let d={url:a.url,headers:a.headers};b?i.log.info("%s [%s] request %j",b,c,d):i.log.info("[%s] request %j",c,d)}catch(a){}return a}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] response %j",c,d,a.data):i.log.info("[%s] response %j",d,a.data)}catch(a){}return a},rejected:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] error %j",c,d,a.response?.data):i.log.error("[%s] error %j",d,a.response?.data)}catch(a){}throw a}};static setMethodName(a,b){try{a[i.RequestMethodNameSymbol]=b}catch(a){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.AuthClient=i},98463,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LoginTicket=void 0,c.LoginTicket=class{envelope;payload;constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},94347,(a,b,c)=>{"use strict";var d,e,f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),c.OAuth2Client=c.ClientAuthentication=c.CertificateFormat=c.CodeChallengeMethod=void 0;let j=a.r(99853),k=a.r(45706),l=a.r(88947),m=a.r(8863),n=a.r(98126),o=a.r(65726),p=a.r(30190),q=a.r(98463);(g=d||(c.CodeChallengeMethod=d={})).Plain="plain",g.S256="S256",(h=e||(c.CertificateFormat=e={})).PEM="PEM",h.JWK="JWK",(i=f||(c.ClientAuthentication=f={})).ClientSecretPost="ClientSecretPost",i.ClientSecretBasic="ClientSecretBasic",i.None="None";class r extends p.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=e.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(a={},b,c){super("object"==typeof a?a:{}),"object"!=typeof a&&(a={clientId:a,clientSecret:b,redirectUri:c}),this._clientId=a.clientId||a.client_id,this._clientSecret=a.clientSecret||a.client_secret,this.redirectUri=a.redirectUri||a.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...a.endpoints},this.clientAuthentication=a.clientAuthentication||f.ClientSecretPost,this.issuers=a.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+k.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,o.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c=new Headers,d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.set("authorization",`Basic ${a.toString("base64")}`)}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e={...r.RETRY_CONFIG,method:"POST",url:b,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d)),headers:c};p.AuthClient.setMethodName(e,"getTokenAsync");let g=await this.transporter.request(e),h=g.data;return g.data&&g.data.expires_in&&(h.expiry_date=new Date().getTime()+1e3*g.data.expires_in,delete h.expires_in),this.emit("tokens",h),{tokens:h,res:g}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){let b;if(!a)throw Error("No refresh token is set.");let c=this.endpoints.oauth2TokenUrl.toString(),d={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let a={...r.RETRY_CONFIG,method:"POST",url:c,data:new URLSearchParams((0,n.removeUndefinedValuesInObject)(d))};p.AuthClient.setMethodName(a,"refreshTokenNoCache"),b=await this.transporter.request(a)}catch(a){throw a instanceof j.GaxiosError&&"invalid_grant"===a.message&&a.response?.data&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let e=b.data;return b.data&&b.data.expires_in&&(e.expiry_date=new Date().getTime()+1e3*b.data.expires_in,delete e.expires_in),this.emit("tokens",e),{tokens:e,res:b}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a=new Headers({authorization:b.token_type+" "+b.access_token});return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token){this.setCredentials(a);let b=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f=new Headers({authorization:e.token_type+" "+d.access_token});return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new r().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...r.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(p.AuthClient.setMethodName(c,"revokeToken"),!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){try{let b=await this.getRequestMetadataAsync();return a.headers=j.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b.headers),this.apiKey&&a.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof l.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return b?.access_token&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...r.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,o.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getFederatedSignonCertsAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?.headers.get("cache-control"),g=-1;if(f){let a=/max-age=(?<maxAge>[0-9]+)/.exec(f)?.groups?.maxAge;a&&(g=1e3*Number(a))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let c={...r.RETRY_CONFIG,url:b};p.AuthClient.setMethodName(c,"getIapPublicKeysAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,o.createCrypto)();e||(e=r.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let j=i[0]+"."+i[1],k=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let l=b[f.kid];if("ES256"===f.alg&&(k=m.joseToDer(k,"ES256").toString("base64")),!await h.verify(l,j,k))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let n=Number(g.iat);if(isNaN(n))throw Error("iat field using invalid format");let p=Number(g.exp);if(isNaN(p))throw Error("exp field using invalid format");let s=new Date().getTime()/1e3;if(p>=s+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let t=n-r.CLOCK_SKEW_SECS_,u=p+r.CLOCK_SKEW_SECS_;if(s<t)throw Error("Token used too early, "+s+" < "+t+": "+JSON.stringify(g));if(s>u)throw Error("Token used too late, "+s+" > "+u+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new q.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}c.OAuth2Client=r},48889,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Compute=void 0;let d=a.r(99853),e=a.r(54145),f=a.r(94347);class g extends f.OAuth2Client{serviceAccountEmail;scopes;constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(){let a,b=`service-accounts/${this.serviceAccountEmail}/token`;try{let c={property:b};this.scopes.length>0&&(c.params={scopes:this.scopes.join(",")}),a=await e.instance(c)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let c=a;return a&&a.expires_in&&(c.expiry_date=new Date().getTime()+1e3*a.expires_in,delete c.expires_in),this.emit("tokens",c),{tokens:c,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}c.Compute=g},70241,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdTokenClient=void 0;let d=a.r(94347);class e extends d.OAuth2Client{targetAudience;idTokenProvider;constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}c.IdTokenClient=e},51747,(a,b,c)=>{"use strict";var d,e;let f;Object.defineProperty(c,"__esModule",{value:!0}),c.GCPEnv=void 0,c.clear=function(){f=void 0},c.getEnv=h;let g=a.r(54145);async function h(){return f||(f=i())}async function i(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await k()?await j()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:process.env.CLOUD_RUN_JOB?d.CLOUD_RUN_JOBS:d.COMPUTE_ENGINE:d.NONE}async function j(){try{return await g.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function k(){return g.isAvailable()}(e=d||(c.GCPEnv=d={})).APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",e.NONE="NONE"},60597,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(88947);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}a.r(24361).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},b.exports=f},89815,(a,b,c)=>{"use strict";var d=a.r(874).Buffer,e=a.r(874).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}b.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},79418,(a,b,c)=>{var d,e=a.r(74898).Buffer,f=a.r(54799),g=a.r(8863),h=a.r(24361),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw p(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw p("key must be a string, a buffer or an object")}function n(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function o(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function p(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function q(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function r(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw p(i)}}}(c),b=q(b);var d=f.createHmac("sha"+a,c);return n((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var s="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(b,c){return d||(d=a.r(89815)),d(b,c)};function t(a){return function(b,c,d){var f=r(a)(b,d);return s(e.from(c),e.from(f))}}function u(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign(c,"base64")))}}function v(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function w(a){return function(b,c){m(c),b=q(b);var d=f.createSign("RSA-SHA"+a);return n((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function x(a){return function(b,c,d){l(d),b=q(b),c=o(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function y(a){var b=u(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function z(a){var b=v(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function A(){return function(){return""}}function B(){return function(a,b){return""===b}}b.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw p('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:r,rs:u,ps:w,es:y,none:A})[c](d),verify:({hs:t,rs:v,ps:x,es:z,none:B})[c](d)}}},53379,(a,b,c)=>{var d=a.r(874).Buffer;b.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},73546,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(60597),f=a.r(79418),g=a.r(88947),h=a.r(53379),i=a.r(24361);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),n=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),o=m.sign(n,k);return i.format("%s.%s",n,o)}function l(a){var b=a.secret;if(b=null==(b=null==b?a.privateKey:b)?a.key:b,!0===/^hs/i.test(a.header.alg)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=c,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,b.exports=l},45712,(a,b,c)=>{var d=a.r(74898).Buffer,e=a.r(60597),f=a.r(79418),g=a.r(88947),h=a.r(53379),i=a.r(24361),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function n(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function o(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function p(a){var b=(a=a||{}).secret;if(b=null==(b=null==b?a.publicKey:b)?a.key:b,!0===/^hs/i.test(a.algorithm)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=c,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(p,g),p.prototype.verify=function(){try{var a=n(this.signature.buffer,this.algorithm,this.key.buffer),b=o(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},p.decode=o,p.isValid=m,p.verify=n,b.exports=p},38823,(a,b,c)=>{var d=a.r(73546),e=a.r(45712);c.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],c.sign=d.sign,c.verify=e.verify,c.decode=e.decode,c.isValid=e.isValid,c.createSign=function(a){return new d(a)},c.createVerify=function(a){return new e(a)}},6122,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleToken=void 0;var d,e=j(a.r(22734)),f=a.r(99853),g=j(a.r(38823)),h=j(a.r(14747)),i=a.r(24361);function j(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(j=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=k(a)&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(var h in a)"default"!==h&&({}).hasOwnProperty.call(a,h)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,h))&&(f.get||f.set)?e(g,h,f):g[h]=a[h]);return g})(a,b)}function k(a){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function l(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function m(a,b,c){return a.set(n(a,b),c),c}function n(a,b,c){if("function"==typeof a?a===b:a.has(b))return arguments.length<3?b:c;throw TypeError("Private element is not present on this object")}function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,w(d.key),d)}}function p(a,b,c){return b&&o(a.prototype,b),c&&o(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function q(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function r(a){var b="function"==typeof Map?new Map:void 0;return(r=function(a){if(null===a||!function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}function c(){return function(a,b,c){if(s())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,b);var e=new(a.bind.apply(a,d));return c&&t(e,c.prototype),e}(a,arguments,u(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),t(c,a)})(a)}function s(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(s=function(){return!!a})()}function t(a,b){return(t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function v(a,b,c){return(b=w(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function w(a){var b=function(a,b){if("object"!=k(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=k(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==k(b)?b:b+""}function x(){var a,b,c="function"==typeof Symbol?Symbol:{},d=c.iterator||"@@iterator",e=c.toStringTag||"@@toStringTag";function f(c,d,e,f){var i=Object.create((d&&d.prototype instanceof h?d:h).prototype);return y(i,"_invoke",function(c,d,e){var f,h,i,j=0,k=e||[],l=!1,m={p:0,n:0,v:a,a:n,f:n.bind(a,4),d:function(b,c){return f=b,h=0,i=a,m.n=c,g}};function n(c,d){for(h=c,i=d,b=0;!l&&j&&!e&&b<k.length;b++){var e,f=k[b],n=m.p,o=f[2];c>3?(e=o===d)&&(i=f[(h=f[4])?5:(h=3,3)],f[4]=f[5]=a):f[0]<=n&&((e=c<2&&n<f[1])?(h=0,m.v=d,m.n=f[1]):n<o&&(e=c<3||f[0]>d||d>o)&&(f[4]=c,f[5]=d,m.n=o,h=0))}if(e||c>1)return g;throw l=!0,d}return function(e,k,o){if(j>1)throw TypeError("Generator is already running");for(l&&1===k&&n(k,o),h=k,i=o;(b=h<2?a:i)||!l;){f||(h?h<3?(h>1&&(m.n=-1),n(h,i)):m.n=i:m.v=i);try{if(j=2,f){if(h||(e="next"),b=f[e]){if(!(b=b.call(f,i)))throw TypeError("iterator result is not an object");if(!b.done)return b;i=b.value,h<2&&(h=0)}else 1===h&&(b=f.return)&&b.call(f),h<2&&(i=TypeError("The iterator does not provide a '"+e+"' method"),h=1);f=a}else if((b=(l=m.n<0)?i:c.call(d,m))!==g)break}catch(b){f=a,h=1,i=b}finally{j=1}}return{value:b,done:l}}}(c,e,f),!0),i}var g={};function h(){}function i(){}function j(){}b=Object.getPrototypeOf;var k=j.prototype=h.prototype=Object.create([][d]?b(b([][d]())):(y(b={},d,function(){return this}),b));function l(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,j):(a.__proto__=j,y(a,e,"GeneratorFunction")),a.prototype=Object.create(k),a}return i.prototype=j,y(k,"constructor",j),y(j,"constructor",i),i.displayName="GeneratorFunction",y(j,e,"GeneratorFunction"),y(k),y(k,e,"Generator"),y(k,d,function(){return this}),y(k,"toString",function(){return"[object Generator]"}),(x=function(){return{w:f,m:l}})()}function y(a,b,c,d){var e=Object.defineProperty;try{e({},"",{})}catch(a){e=0}(y=function(a,b,c,d){if(b)e?e(a,b,{value:c,enumerable:!d,configurable:!d,writable:!d}):a[b]=c;else{var f=function(b,c){y(a,b,function(a){return this._invoke(b,c,a)})};f("next",0),f("throw",1),f("return",2)}})(a,b,c,d)}function z(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function A(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){z(f,d,e,g,h,"next",a)}function h(a){z(f,d,e,g,h,"throw",a)}g(void 0)})}}var B=e.readFile?(0,i.promisify)(e.readFile):A(x().m(function a(){return x().w(function(a){for(;;)switch(a.n){case 0:throw new D("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return a.a(2)}},a)})),C="https://oauth2.googleapis.com/token",D=function(a){function b(a,c){var d,e,f;return q(this,b),e=b,f=[a],e=u(e),v(d=function(a,b){if(b&&("object"==k(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,s()?Reflect.construct(e,f||[],u(this).constructor):e.apply(this,f)),"code",void 0),d.code=c,d}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),a&&t(b,a),p(b)}(r(Error)),E=new WeakMap,F=new WeakSet;function G(a){return H.apply(this,arguments)}function H(){return(H=A(x().m(function a(b){return x().w(function(a){for(;;)switch(a.n){case 0:if(!E.get(n(E,this))||b.forceRefresh){a.n=1;break}return a.a(2,E.get(n(E,this)));case 1:return a.p=1,a.n=2,m(E,this,n(F,this,I).call(this,b));case 2:return a.a(2,a.v);case 3:return a.p=3,m(E,this,void 0),a.f(3);case 4:return a.a(2)}},a,this,[[1,,3,4]])}))).apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){return(J=A(x().m(function a(b){var c;return x().w(function(a){for(;;)switch(a.n){case 0:if(!1!==this.isTokenExpiring()||!1!==b.forceRefresh){a.n=1;break}return a.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){a.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){a.n=4;break}return a.n=3,this.getCredentials(this.keyFile);case 3:c=a.v,this.key=c.privateKey,this.iss=c.clientEmail||this.iss,c.clientEmail||n(F,this,K).call(this);case 4:return a.a(2,n(F,this,O).call(this))}},a,this)}))).apply(this,arguments)}function K(){if(!this.iss)throw new D("email is required.","MISSING_CREDENTIALS")}function L(){return M.apply(this,arguments)}function M(){return(M=A(x().m(function a(){var b;return x().w(function(a){for(;;)switch(a.n){case 0:if(this.accessToken){a.n=1;break}throw Error("No token to revoke.");case 1:return b="https://oauth2.googleapis.com/revoke?token="+this.accessToken,a.n=2,this.transporter.request({url:b,retry:!0});case 2:n(F,this,N).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return a.a(2)}},a,this)}))).apply(this,arguments)}function N(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"===k(a.scope)?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)}function O(){return P.apply(this,arguments)}function P(){return(P=A(x().m(function a(){var b,c,d,e,f,h,i,j,k,l;return x().w(function(a){for(;;)switch(a.n){case 0:return b=Math.floor(new Date().getTime()/1e3),c=this.additionalClaims||{},d=Object.assign({iss:this.iss,scope:this.scope,aud:C,exp:b+3600,iat:b,sub:this.sub},c),e=g.sign({header:{alg:"RS256"},payload:d,secret:this.key}),a.p=1,a.n=2,this.transporter.request({method:"POST",url:C,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return f=a.v,this.rawToken=f.data,this.expiresAt=null===f.data.expires_in||void 0===f.data.expires_in?void 0:(b+f.data.expires_in)*1e3,a.a(2,this.rawToken);case 3:throw a.p=3,l=a.v,this.rawToken=void 0,this.tokenExpires=void 0,(j=l.response&&null!=(h=l.response)&&h.data?null==(i=l.response)?void 0:i.data:{}).error&&(k=j.error_description?": ".concat(j.error_description):"",l.message="".concat(j.error).concat(k)),l;case 4:return a.a(2)}},a,this,[[1,3]])}))).apply(this,arguments)}c.GoogleToken=p(function a(b){q(this,a),l(this,F),F.add(this),v(this,"expiresAt",void 0),v(this,"key",void 0),v(this,"keyFile",void 0),v(this,"iss",void 0),v(this,"sub",void 0),v(this,"scope",void 0),v(this,"rawToken",void 0),v(this,"tokenExpires",void 0),v(this,"email",void 0),v(this,"additionalClaims",void 0),v(this,"eagerRefreshThresholdMillis",void 0),v(this,"transporter",{request:function(a){return(0,f.request)(a)}}),l(this,E),E.set(this,void 0),n(F,this,N).call(this,b)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var a,b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}},{key:"getToken",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===k(a)&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){var c=a;n(F,this,G).call(this,b).then(function(a){return c(null,a)},a);return}return n(F,this,G).call(this,b)}},{key:"getCredentials",value:(d=A(x().m(function a(b){var c,d,e,f,g;return x().w(function(a){for(;;)switch(a.n){case 0:a.n=".json"===(g=h.extname(b))?1:".der"===g||".crt"===g||".pem"===g?4:".p12"===g||".pfx"===g?6:7;break;case 1:return a.n=2,B(b,"utf8");case 2:if(d=(c=JSON.parse(a.v)).private_key,e=c.client_email,!(!d||!e)){a.n=3;break}throw new D("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return a.a(2,{privateKey:d,clientEmail:e});case 4:return a.n=5,B(b,"utf8");case 5:return f=a.v,a.a(2,{privateKey:f});case 6:throw new D("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new D("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return a.a(2)}},a)})),function(a){return d.apply(this,arguments)})},{key:"revokeToken",value:function(a){return a?void n(F,this,L).call(this).then(function(){return a()},a):n(F,this,L).call(this)}}])},88329,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWTAccess=void 0;let d=a.r(38823),e=a.r(98126),f={alg:"RS256",typ:"JWT"};class g{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new e.LRUCache({capacity:500,maxAge:36e5});constructor(a,b,c,d){this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=d??3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return new Headers(i.headers);let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,n=Object.assign(e,b),o=d.sign({header:m,payload:n,secret:this.key}),p=new Headers({authorization:`Bearer ${o}`});return this.cache.set(h,{expiration:1e3*l,headers:p}),p}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}c.JWTAccess=g},42911,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWT=void 0;let d=a.r(6122),e=a.r(88329),f=a.r(94347),g=a.r(30190);class h extends f.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(a={}){super(a),this.email=a.email,this.keyFile=a.keyFile,this.key=a.key,this.keyId=a.keyId,this.scopes=a.scopes,this.subject=a.subject,this.additionalClaims=a.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${a.id_token}`}))}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(a??void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:new Headers}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(){let a=this.createGToken(),b={access_token:(await a.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:a.expiresAt,id_token:a.idToken};return this.emit("tokens",b),{res:null,tokens:b}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}c.JWT=h},92114,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UserRefreshClient=c.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=a.r(94347),e=a.r(30190);c.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{_refreshToken;constructor(a,b,c,d,e){const f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){let b={...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})};return e.AuthClient.setMethodName(b,"fetchIdToken"),(await this.transporter.request(b)).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}c.UserRefreshClient=f},61576,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Impersonated=c.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=a.r(94347),e=a.r(99853),f=a.r(98126);c.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(a={}){if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=a.sourceClient??new d.OAuth2Client,this.targetPrincipal=a.targetPrincipal??"",this.delegates=a.delegates??[],this.targetScopes=a.targetScopes??[],this.lifetime=a.lifetime??3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=a.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(c){if(!(c instanceof Error))throw c;let a=0,b="";if(c instanceof e.GaxiosError&&(a=c?.response?.data?.error?.status,b=c?.response?.data?.error?.message),a&&b)throw c.message=`${a}: unable to impersonate: ${b}`,c;throw c.message=`unable to impersonate: ${c}`,c}}async fetchIdToken(a,b){await this.sourceClient.getAccessToken();let c=`projects/-/serviceAccounts/${this.targetPrincipal}`,d=`${this.endpoint}/v1/${c}:generateIdToken`,e={delegates:this.delegates,audience:a,includeEmail:b?.includeEmail??!0,useEmailAzp:b?.includeEmail??!0};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:d,data:e,method:"POST"})).data.token}}c.Impersonated=g},21575,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.OAuthClientAuthHandler=void 0,c.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=a.r(99853),e=a.r(65726),f=["PUT","POST","PATCH"];class g{#m=(0,e.createCrypto)();#n;transporter;constructor(a){a&&"clientId"in a?(this.#n=a,this.transporter=new d.Gaxios):(this.#n=a?.clientAuthentication,this.transporter=a?.transporter||new d.Gaxios)}applyClientAuthenticationOptions(a,b){a.headers=d.Gaxios.mergeHeaders(a.headers),this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){if(b)a.headers=d.Gaxios.mergeHeaders(a.headers,{authorization:`Bearer ${b}`});else if(this.#n?.confidentialClientType==="basic"){a.headers=d.Gaxios.mergeHeaders(a.headers);let b=this.#n.clientId,c=this.#n.clientSecret||"",e=this.#m.encodeBase64StringUtf8(`${b}:${c}`);d.Gaxios.mergeHeaders(a.headers,{authorization:`Basic ${e}`})}}injectAuthenticatedRequestBody(a){if(this.#n?.confidentialClientType==="request-body"){let b=(a.method||"GET").toUpperCase();if(!f.includes(b))throw Error(`${b} HTTP method does not support ${this.#n.confidentialClientType} client authentication`);let c=new Headers(a.headers).get("content-type");if(c?.startsWith("application/x-www-form-urlencoded")||a.data instanceof URLSearchParams){let b=new URLSearchParams(a.data??"");b.append("client_id",this.#n.clientId),b.append("client_secret",this.#n.clientSecret||""),a.data=b}else if(c?.startsWith("application/json"))a.data=a.data||{},Object.assign(a.data,{client_id:this.#n.clientId,client_secret:this.#n.clientSecret||""});else throw Error(`${c} content-types are not supported with ${this.#n.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.OAuthClientAuthHandler=g},78794,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StsCredentials=void 0;let d=a.r(99853),e=a.r(30190),f=a.r(21575),g=a.r(98126);class h extends f.OAuthClientAuthHandler{#o;constructor(a={tokenExchangeEndpoint:""},b){("object"!=typeof a||a instanceof URL)&&(a={tokenExchangeEndpoint:a,clientAuthentication:b}),super(a),this.#o=a.tokenExchangeEndpoint}async exchangeToken(a,b,c){let i={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:a.scope?.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:a.actingParty?.actorToken,actor_token_type:a.actingParty?.actorTokenType,options:c&&JSON.stringify(c)},j={...h.RETRY_CONFIG,url:this.#o.toString(),method:"POST",headers:b,data:new URLSearchParams((0,g.removeUndefinedValuesInObject)(i))};e.AuthClient.setMethodName(j,"exchangeToken"),this.applyClientAuthenticationOptions(j);try{let a=await this.transporter.request(j),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,f.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}c.StsCredentials=h},20382,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BaseExternalAccountClient=c.CLOUD_RESOURCE_MANAGER=c.EXTERNAL_ACCOUNT_TYPE=c.EXPIRATION_TIME_OFFSET=void 0;let d=a.r(99853),e=a.r(88947),f=a.r(30190),g=a.r(78794),h=a.r(98126),i=a.r(15204),j="https://www.googleapis.com/auth/cloud-platform";c.EXPIRATION_TIME_OFFSET=3e5,c.EXTERNAL_ACCOUNT_TYPE="external_account",c.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class k extends f.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#p=null;constructor(a){super(a);const b=(0,h.originalOrCamelOptions)(a),d=b.get("type");if(d&&d!==c.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${c.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);const e=b.get("client_id"),f=b.get("client_secret");this.tokenUrl=b.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);const i=b.get("subject_token_type"),k=b.get("workforce_pool_user_project"),l=b.get("service_account_impersonation_url"),m=b.get("service_account_impersonation"),n=(0,h.originalOrCamelOptions)(m).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(b.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),e&&(this.clientAuth={confidentialClientType:"basic",clientId:e,clientSecret:f}),this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=b.get("scopes")||[j],this.cachedAccessToken=null,this.audience=b.get("audience"),this.subjectTokenType=i,this.workforcePoolUserProject=k;const o=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(o))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=l,this.serviceAccountImpersonationLifetime=n,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let a=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return a?.groups?.email||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c={...k.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`};f.AuthClient.setMethodName(c,"getProjectId");let d=await this.transporter.request(c);return this.projectId=d.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){this.#p=this.#p||this.#q();try{return await this.#p}finally{this.#p=null}}async #q(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[j]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...k.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};f.AuthClient.setMethodName(b,"getImpersonatedAccessToken");let c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[j]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${i.pkg.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}c.BaseExternalAccountClient=k},80689,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FileSubjectTokenSupplier=void 0;let d=a.r(24361),e=a.r(22734),f=(0,d.promisify)(e.readFile??(()=>{})),g=(0,d.promisify)(e.realpath??(()=>{})),h=(0,d.promisify)(e.lstat??(()=>{}));c.FileSubjectTokenSupplier=class{filePath;formatType;subjectTokenFieldName;constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(){let a,b=this.filePath;try{if(b=await g(b),!(await h(b)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${b} does not exist, or it is not a file. ${a.message}`),a}let c=await f(b,{encoding:"utf8"});if("text"===this.formatType?a=c:"json"===this.formatType&&this.subjectTokenFieldName&&(a=JSON.parse(c)[this.subjectTokenFieldName]),!a)throw Error("Unable to parse the subject_token from the credential_source file");return a}}},58405,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UrlSubjectTokenSupplier=void 0;let d=a.r(30190);c.UrlSubjectTokenSupplier=class{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(d.AuthClient.setMethodName(c,"getSubjectToken"),"text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}},61890,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CertificateSubjectTokenSupplier=c.InvalidConfigurationError=c.CertificateSourceUnavailableError=c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let d=a.r(98126),e=a.r(22734),f=a.r(54799),g=a.r(24836);c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class h extends Error{constructor(a){super(a),this.name="CertificateSourceUnavailableError"}}c.CertificateSourceUnavailableError=h;class i extends Error{constructor(a){super(a),this.name="InvalidConfigurationError"}}c.InvalidConfigurationError=i,c.CertificateSubjectTokenSupplier=class{certificateConfigPath;trustChainPath;cert;key;constructor(a){if(!a.useDefaultCertificateConfig&&!a.certificateConfigLocation)throw new i("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(a.useDefaultCertificateConfig&&a.certificateConfigLocation)throw new i("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=a.trustChainPath,this.certificateConfigPath=a.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new i("Cannot create mTLS Agent with missing certificate or key");return new g.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#r();let{certPath:a,keyPath:b}=await this.#s();return{cert:this.cert,key:this.key}=await this.#t(a,b),await this.#u(this.cert)}async #r(){let a=this.certificateConfigPath;if(a){if(await (0,d.isValidFile)(a))return a;throw new h(`Provided certificate config path is invalid: ${a}`)}let b=process.env[c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(b){if(await (0,d.isValidFile)(b))return b;throw new h(`Path from environment variable "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${b}`)}let e=(0,d.getWellKnownCertificateConfigFileLocation)();if(await (0,d.isValidFile)(e))return e;throw new h(`Could not find certificate configuration file. Searched override path, the "${c.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${e}).`)}async #s(){let a,b=this.certificateConfigPath;try{a=await e.promises.readFile(b,"utf8")}catch(a){throw new h(`Failed to read certificate config file at: ${b}`)}try{let c=JSON.parse(a),d=c?.cert_configs?.workload?.cert_path,e=c?.cert_configs?.workload?.key_path;if(!d||!e)throw new i(`Certificate config file (${b}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:d,keyPath:e}}catch(a){if(a instanceof i)throw a;throw new i(`Failed to parse certificate config from ${b}: ${a.message}`)}}async #t(a,b){let c,d;try{c=await e.promises.readFile(a),new f.X509Certificate(c)}catch(c){let b=c instanceof Error?c.message:String(c);throw new h(`Failed to read certificate file at ${a}: ${b}`)}try{d=await e.promises.readFile(b),(0,f.createPrivateKey)(d)}catch(c){let a=c instanceof Error?c.message:String(c);throw new h(`Failed to read private key file at ${b}: ${a}`)}return{cert:c,key:d}}async #u(a){let b=new f.X509Certificate(a);if(!this.trustChainPath)return JSON.stringify([b.raw.toString("base64")]);try{let a,c=((await e.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((a,b)=>{try{return new f.X509Certificate(a)}catch(c){let a=c instanceof Error?c.message:String(c);throw new i(`Failed to parse certificate at index ${b} in trust chain file ${this.trustChainPath}: ${a}`)}}),d=c.findIndex(a=>b.raw.equals(a.raw));if(-1===d)a=[b,...c];else if(0===d)a=c;else throw new i(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${d}).`);return JSON.stringify(a.map(a=>a.raw.toString("base64")))}catch(b){if(b instanceof i)throw b;let a=b instanceof Error?b.message:String(b);throw new h(`Failed to process certificate chain from ${this.trustChainPath}: ${a}`)}}}},32386,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdentityPoolClient=void 0;let d=a.r(20382),e=a.r(98126),f=a.r(80689),g=a.r(58405),h=a.r(61890),i=a.r(78794),j=a.r(99853);class k extends d.BaseExternalAccountClient{subjectTokenSupplier;constructor(a){super(a);const b=(0,e.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("subject_token_supplier");if(!c&&!d)throw Error("A credential source or subject token supplier must be specified.");if(c&&d)throw Error("Only one of credential source or subject token supplier can be specified.");if(d)this.subjectTokenSupplier=d,this.credentialSourceType="programmatic";else{const a=(0,e.originalOrCamelOptions)(c),b=(0,e.originalOrCamelOptions)(a.get("format")),d=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==d&&"text"!==d)throw Error(`Invalid credential_source format "${d}"`);if("json"===d&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");const j=a.get("file"),l=a.get("url"),m=a.get("certificate"),n=a.get("headers");if(j&&l||l&&m||j&&m)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(j)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:d,subjectTokenFieldName:i});else if(l)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:l,formatType:d,subjectTokenFieldName:i,headers:n,additionalGaxiosOptions:k.RETRY_CONFIG});else if(m){this.credentialSourceType="certificate";const a=new h.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:m.use_default_certificate_config,certificateConfigLocation:m.certificate_config_location,trustChainPath:m.trust_chain_path});this.subjectTokenSupplier=a}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let a=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof h.CertificateSubjectTokenSupplier){let a=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new i.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new j.Gaxios({agent:a})}),this.transporter=new j.Gaxios({...this.transporter.defaults||{},agent:a})}return a}}c.IdentityPoolClient=k},59660,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsRequestSigner=void 0;let d=a.r(99853),e=a.r(65726),f="AWS4-HMAC-SHA256";async function g(a,b,c){return await a.signWithHmacSha256(b,c)}async function h(a,b,c,d,e){let f=await g(a,`AWS4${b}`,c),h=await g(a,f,d),i=await g(a,h,e);return await g(a,i,"aws4_request")}async function i(a){let b=d.Gaxios.mergeHeaders(a.additionalAmzHeaders),c=a.requestPayload||"",i=a.host.split(".")[0],j=new Date,k=j.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),l=j.toISOString().replace(/[-]/g,"").replace(/T.*/,"");a.securityCredentials.token&&b.set("x-amz-security-token",a.securityCredentials.token);let m=d.Gaxios.mergeHeaders({host:a.host},b.has("date")?{}:{"x-amz-date":k},b),n="",o=[...m.keys()].sort();o.forEach(a=>{n+=`${a}:${m.get(a)}
`});let p=o.join(";"),q=await a.crypto.sha256DigestHex(c),r=`${a.method.toUpperCase()}
${a.canonicalUri}
${a.canonicalQuerystring}
${n}
${p}
${q}`,s=`${l}/${a.region}/${i}/aws4_request`,t=`${f}
${k}
${s}
`+await a.crypto.sha256DigestHex(r),u=await h(a.crypto,a.securityCredentials.secretAccessKey,l,a.region,i),v=await g(a.crypto,u,t),w=`${f} Credential=${a.securityCredentials.accessKeyId}/${s}, SignedHeaders=${p}, Signature=${(0,e.fromArrayBufferToHex)(v)}`;return{amzDate:b.has("date")?void 0:k,authorizationHeader:w,canonicalQuerystring:a.canonicalQuerystring}}c.AwsRequestSigner=class{getCredentials;region;crypto;constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,e.createCrypto)()}async getRequestOptions(a){if(!a.url)throw RangeError('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,e=a.method||"GET",f=a.body||b,g=a.headers,h=await this.getCredentials(),j=new URL(c);if("string"!=typeof f&&void 0!==f)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${f}`);let k=await i({crypto:this.crypto,host:j.host,canonicalUri:j.pathname,canonicalQuerystring:j.search.slice(1),method:e,region:this.region,securityCredentials:h,requestPayload:f,additionalAmzHeaders:g}),l=d.Gaxios.mergeHeaders(k.amzDate?{"x-amz-date":k.amzDate}:{},{authorization:k.authorizationHeader,host:j.host},g||{});h.token&&d.Gaxios.mergeHeaders(l,{"x-amz-security-token":h.token});let m={url:c,method:e,headers:l};return void 0!==f&&(m.body=f),m}}},29723,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultAwsSecurityCredentialsSupplier=void 0;let d=a.r(30190);c.DefaultAwsSecurityCredentialsSupplier=class{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(a){this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(this.#v)return this.#v;let b=new Headers;if(!this.#v&&this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#w(a.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:b};d.AuthClient.setMethodName(c,"getAwsRegion");let e=await a.transporter.request(c);return e.data.substr(0,e.data.length-1)}async getAwsSecurityCredentials(a){if(this.#x)return this.#x;let b=new Headers;this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#w(a.transporter));let c=await this.#y(b,a.transporter),d=await this.#z(c,b,a.transporter);return{accessKeyId:d.AccessKeyId,secretAccessKey:d.SecretAccessKey,token:d.Token}}async #w(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return d.AuthClient.setMethodName(b,"#getImdsV2SessionToken"),(await a.request(b)).data}async #y(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:a};return d.AuthClient.setMethodName(c,"#getAwsRoleName"),(await b.request(c)).data}async #z(a,b,c){let e={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,headers:b};return d.AuthClient.setMethodName(e,"#retrieveAwsSecurityCredentials"),(await c.request(e)).data}get #v(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #x(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}},77961,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsClient=void 0;let d=a.r(59660),e=a.r(20382),f=a.r(29723),g=a.r(98126),h=a.r(99853);class i extends e.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #A="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(a){super(a);const b=(0,g.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("aws_security_credentials_supplier");if(!c&&!d)throw Error("A credential source or AWS security credentials supplier must be specified.");if(c&&d)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(d)this.awsSecurityCredentialsSupplier=d,this.regionalCredVerificationUrl=i.#A,this.credentialSourceType="programmatic";else{const a=(0,g.originalOrCamelOptions)(c);this.environmentId=a.get("environment_id");const b=a.get("region_url"),d=a.get("url"),e=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new f.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:d,imdsV2SessionTokenUrl:e}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let a=this.environmentId?.match(/^(aws)(\d+)$/);if(a&&this.regionalCredVerificationUrl){if(1!==parseInt(a[2],10))throw Error(`aws version "${a[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new d.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...i.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[];return h.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},a.headers).forEach((a,c)=>b.push({key:c,value:a})),encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}c.AwsClient=i},71544,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InvalidSubjectTokenError=c.InvalidMessageFieldError=c.InvalidCodeFieldError=c.InvalidTokenTypeFieldError=c.InvalidExpirationTimeFieldError=c.InvalidSuccessFieldError=c.InvalidVersionFieldError=c.ExecutableResponseError=c.ExecutableResponse=void 0;let d="urn:ietf:params:oauth:token-type:saml2",e="urn:ietf:params:oauth:token-type:id_token",f="urn:ietf:params:oauth:token-type:jwt";c.ExecutableResponse=class{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==d&&this.tokenType!==e&&this.tokenType!==f)throw new j(`Executable response must contain a 'token_type' field when successful and it must be one of ${e}, ${f}, or ${d}.`);if(this.tokenType===d){if(!a.saml_response)throw new m(`Executable response must contain a 'saml_response' field when token_type=${d}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new m(`Executable response must contain a 'id_token' field when token_type=${e} or ${f}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new k("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new l("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableResponseError=g;class h extends g{}c.InvalidVersionFieldError=h;class i extends g{}c.InvalidSuccessFieldError=i,c.InvalidExpirationTimeFieldError=class extends g{};class j extends g{}c.InvalidTokenTypeFieldError=j;class k extends g{}c.InvalidCodeFieldError=k;class l extends g{}c.InvalidMessageFieldError=l;class m extends g{}c.InvalidSubjectTokenError=m},20361,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthHandler=c.ExecutableError=void 0;let d=a.r(71544),e=a.r(33405),f=a.r(22734);class g extends Error{code;constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableError=g;class h{commandComponents;timeoutMillis;outputFile;constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let f=e.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";f.stdout.on("data",a=>{h+=a}),f.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(f.removeAllListeners(),f.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",a=>{if(clearTimeout(i),0!==a)return c(new g(h,a.toString()));try{let a=JSON.parse(h),c=new d.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof d.ExecutableResponseError)return c(a);return c(new d.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await f.promises.realpath(this.outputFile)}catch{return}if(!(await f.promises.lstat(a)).isFile())return;let b=await f.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new d.ExecutableResponse(a).isValid())return new d.ExecutableResponse(a);return}catch(a){if(a instanceof d.ExecutableResponseError)throw a;throw new d.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}c.PluggableAuthHandler=h},18451,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthClient=c.ExecutableError=void 0;let d=a.r(20382),e=a.r(71544),f=a.r(20361);var g=a.r(20361);Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return g.ExecutableError}});class h extends d.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(a){if(super(a),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new f.ExecutableError(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}c.PluggableAuthClient=h},50489,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountClient=void 0;let d=a.r(20382),e=a.r(32386),f=a.r(77961),g=a.r(18451);c.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a){return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?a.credential_source?.environment_id?new f.AwsClient(a):a.credential_source?.executable?new g.PluggableAuthClient(a):new e.IdentityPoolClient(a):null}}},44737,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=a.r(30190),e=a.r(21575),f=a.r(99853),g=a.r(88947),h=a.r(20382);c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{#B;constructor(a){super(a),this.#B=a.tokenRefreshEndpoint}async refreshToken(a,b){let c={...i.RETRY_CONFIG,url:this.#B,method:"POST",headers:b,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:a})};d.AuthClient.setMethodName(c,"refreshToken"),this.applyClientAuthenticationOptions(c);try{let a=await this.transporter.request(c),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(a){super(a),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;const b={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i({tokenRefreshEndpoint:a.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:b}),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof a?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!a?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=f.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.ExternalAccountAuthorizedUserClient=j},35058,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.GoogleAuthExceptionMessages=void 0;let d=a.r(33405),e=a.r(22734),f=a.r(99853),g=a.r(54145),h=a.r(46786),i=a.r(14747),j=a.r(65726),k=a.r(48889),l=a.r(70241),m=a.r(51747),n=a.r(42911),o=a.r(92114),p=a.r(61576),q=a.r(50489),r=a.r(20382),s=a.r(30190),t=a.r(44737),u=a.r(98126);c.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"},c.GoogleAuth=class{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#C=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(a={}){if(this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(c.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if(a||=await this.getProductionProjectId(),a||=await this.getFileProjectId(),a||=await this.getDefaultServiceProjectId(),a||=await this.getGCEProjectId(),a||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=a,a;throw Error(c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let a;try{a=await g.universe("universe-domain"),a||=s.DEFAULT_UNIVERSE}catch(b){if(b&&b?.response?.status===404)a=s.DEFAULT_UNIVERSE;else throw b}return a}async getUniverseDomain(){let a=(0,u.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{a??=(await this.getClient()).universeDomain}catch{a??=s.DEFAULT_UNIVERSE}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let b;if(this.cachedCredential)return await this.#D(this.cachedCredential,null);if((b=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(b=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return b instanceof n.JWT?b.scopes=this.scopes:b instanceof r.BaseExternalAccountClient&&(b.scopes=this.getAnyScopes()),await this.#D(b);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await this.#D(new k.Compute(a));throw Error(c.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #D(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=g.getGCPResidency()||await g.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=i.join(a,".config"))}return(b&&(b=i.join(b,"gcloud","application_default_credentials.json"),e.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=e.realpathSync(a),!e.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=e.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==p.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${p.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let b=this.fromJSON(a.source_credentials);if(a.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url)?.groups?.target;if(!c)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let d=(this.scopes||a.scopes||this.defaultScopes)??[];return new p.Impersonated({...a,sourceClient:b,targetPrincipal:c,targetScopes:Array.isArray(d)?d:[d]})}fromJSON(a,b={}){let c,d=(0,u.originalOrCamelOptions)(b).get("universe_domain");return a.type===o.USER_REFRESH_ACCOUNT_TYPE?(c=new o.UserRefreshClient(b)).fromJSON(a):a.type===p.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===r.EXTERNAL_ACCOUNT_TYPE?(c=q.ExternalAccountClient.fromJSON({...a,...b})).scopes=this.getAnyScopes():a.type===t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new t.ExternalAccountAuthorizedUserClient({...a,...b}):(b.scopes=this.scopes,c=new n.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new n.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new n.JWT({...b,apiKey:a})}_isWindows(){let a=h.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,d.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==r.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await g.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof p.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof r.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([g.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(c.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#C=this.#C||this.#E();try{return await this.#C}finally{this.#C=null}}async #E(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=i.resolve(this.keyFilename),b=e.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await this.#D(a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new l.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a={}){let b=a.url,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=f.Gaxios.mergeHeaders(a.headers,d),a}async fetch(...a){return(await this.getClient()).fetch(...a)}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,m.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof p.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,j.createCrypto)();if(c instanceof n.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}},79746,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IAMAuth=void 0,c.IAMAuth=class{selector;token;constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},43581,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DownscopedClient=c.EXPIRATION_TIME_OFFSET=c.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=a.r(99853),e=a.r(88947),f=a.r(30190),g=a.r(78794);c.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,c.EXPIRATION_TIME_OFFSET=3e5;class h extends f.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(a,b={accessBoundary:{accessBoundaryRules:[]}}){if(super(a instanceof f.AuthClient?{}:a),a instanceof f.AuthClient?(this.authClient=a,this.credentialAccessBoundary=b):(this.authClient=a.authClient,this.credentialAccessBoundary=a.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>c.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${c.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const a of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=(await this.authClient.getAccessToken()).token,b=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),c=this.authClient.credentials?.expiry_date||null,d=b.expires_in?new Date().getTime()+1e3*b.expires_in:c;return this.cachedDownscopedAccessToken={access_token:b.access_token,expiry_date:d,res:b.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.DownscopedClient=h},46183,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PassThroughClient=void 0;let d=a.r(30190);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}c.PassThroughClient=e},28684,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.auth=c.PassThroughClient=c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=c.ExecutableError=c.PluggableAuthClient=c.DownscopedClient=c.BaseExternalAccountClient=c.ExternalAccountClient=c.IdentityPoolClient=c.AwsRequestSigner=c.AwsClient=c.UserRefreshClient=c.LoginTicket=c.ClientAuthentication=c.OAuth2Client=c.CodeChallengeMethod=c.Impersonated=c.JWT=c.JWTAccess=c.IdTokenClient=c.IAMAuth=c.GCPEnv=c.Compute=c.DEFAULT_UNIVERSE=c.AuthClient=c.gaxios=c.gcpMetadata=void 0;let d=a.r(35058);Object.defineProperty(c,"GoogleAuth",{enumerable:!0,get:function(){return d.GoogleAuth}}),c.gcpMetadata=a.r(54145),c.gaxios=a.r(99853);var e=a.r(30190);Object.defineProperty(c,"AuthClient",{enumerable:!0,get:function(){return e.AuthClient}}),Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return e.DEFAULT_UNIVERSE}});var f=a.r(48889);Object.defineProperty(c,"Compute",{enumerable:!0,get:function(){return f.Compute}});var g=a.r(51747);Object.defineProperty(c,"GCPEnv",{enumerable:!0,get:function(){return g.GCPEnv}});var h=a.r(79746);Object.defineProperty(c,"IAMAuth",{enumerable:!0,get:function(){return h.IAMAuth}});var i=a.r(70241);Object.defineProperty(c,"IdTokenClient",{enumerable:!0,get:function(){return i.IdTokenClient}});var j=a.r(88329);Object.defineProperty(c,"JWTAccess",{enumerable:!0,get:function(){return j.JWTAccess}});var k=a.r(42911);Object.defineProperty(c,"JWT",{enumerable:!0,get:function(){return k.JWT}});var l=a.r(61576);Object.defineProperty(c,"Impersonated",{enumerable:!0,get:function(){return l.Impersonated}});var m=a.r(94347);Object.defineProperty(c,"CodeChallengeMethod",{enumerable:!0,get:function(){return m.CodeChallengeMethod}}),Object.defineProperty(c,"OAuth2Client",{enumerable:!0,get:function(){return m.OAuth2Client}}),Object.defineProperty(c,"ClientAuthentication",{enumerable:!0,get:function(){return m.ClientAuthentication}});var n=a.r(98463);Object.defineProperty(c,"LoginTicket",{enumerable:!0,get:function(){return n.LoginTicket}});var o=a.r(92114);Object.defineProperty(c,"UserRefreshClient",{enumerable:!0,get:function(){return o.UserRefreshClient}});var p=a.r(77961);Object.defineProperty(c,"AwsClient",{enumerable:!0,get:function(){return p.AwsClient}});var q=a.r(59660);Object.defineProperty(c,"AwsRequestSigner",{enumerable:!0,get:function(){return q.AwsRequestSigner}});var r=a.r(32386);Object.defineProperty(c,"IdentityPoolClient",{enumerable:!0,get:function(){return r.IdentityPoolClient}});var s=a.r(50489);Object.defineProperty(c,"ExternalAccountClient",{enumerable:!0,get:function(){return s.ExternalAccountClient}});var t=a.r(20382);Object.defineProperty(c,"BaseExternalAccountClient",{enumerable:!0,get:function(){return t.BaseExternalAccountClient}});var u=a.r(43581);Object.defineProperty(c,"DownscopedClient",{enumerable:!0,get:function(){return u.DownscopedClient}});var v=a.r(18451);Object.defineProperty(c,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}}),Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return v.ExecutableError}});var w=a.r(44737);Object.defineProperty(c,"EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE",{enumerable:!0,get:function(){return w.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE}}),Object.defineProperty(c,"ExternalAccountAuthorizedUserClient",{enumerable:!0,get:function(){return w.ExternalAccountAuthorizedUserClient}});var x=a.r(46183);Object.defineProperty(c,"PassThroughClient",{enumerable:!0,get:function(){return x.PassThroughClient}}),c.auth=new d.GoogleAuth},24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},88646,(a,b,c)=>{b.exports=a.x("node:stream/promises",()=>require("node:stream/promises"))},6461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},65514,(a,b,c)=>{"use strict";let d=["nodebuffer","arraybuffer","fragments"],e="undefined"!=typeof Blob;e&&d.push("blob"),b.exports={BINARY_TYPES:d,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:e,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},40352,(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=a.r(65514),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(b.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let a=(()=>{let a=Error("Cannot find module 'bufferutil'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.mask=function(b,c,d,e,g){g<48?f(b,c,d,e,g):a.mask(b,c,d,e,g)},b.exports.unmask=function(b,c){b.length<32?g(b,c):a.unmask(b,c)}}catch(a){}},29110,(a,b,c)=>{"use strict";let d=Symbol("kDone"),e=Symbol("kRun");b.exports=class{constructor(a){this[d]=()=>{this.pending--,this[e]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[e]()}[e](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[d])}}}},19199,(a,b,c)=>{"use strict";let d,e=a.r(6461),f=a.r(40352),g=a.r(29110),{kStatusCode:h}=a.r(65514),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),n=Symbol("buffers"),o=Symbol("error");function p(a){this[n].push(a),this[l]+=a.length}function q(a){(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)?this[n].push(a):(this[o]=RangeError("Max payload size exceeded"),this[o].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[o][h]=1009,this.removeListener("data",q),this.reset())}function r(a){(this[k]._inflate=null,this[o])?this[m](this[o]):(a[h]=1007,this[m](a))}b.exports=class{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[n]=[],this._inflate.on("error",r),this._inflate.on("data",q)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[o];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[n],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[n]=[],this._deflate.on("data",p)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[n],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[n]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}},55572,(a,b,c)=>{"use strict";let{isUtf8:d}=a.r(874),{hasBlob:e}=a.r(65514);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(b.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)b.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let a=(()=>{let a=Error("Cannot find module 'utf-8-validate'");throw a.code="MODULE_NOT_FOUND",a})();b.exports.isValidUTF8=function(b){return b.length<32?f(b):a(b)}}catch(a){}},75091,(a,b,c)=>{"use strict";let{Writable:d}=a.r(88947),e=a.r(19199),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=a.r(65514),{concat:j,toArrayBuffer:k,unmask:l}=a.r(40352),{isValidStatusCode:m,isValidUTF8:n}=a.r(55572),o=Buffer[Symbol.species];b.exports=class extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new o(b.buffer,b.byteOffset+a,b.length-a),new o(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new o(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0)return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop)this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);c>2097151?a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a))}haveLength(a){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!n(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new o(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!n(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}},10697,(a,b,c)=>{"use strict";let d,{Duplex:e}=a.r(88947),{randomFillSync:f}=a.r(54799),g=a.r(19199),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=a.r(65514),{isBlob:k,isValidStatusCode:l}=a.r(55572),{mask:m,toBuffer:n}=a.r(40352),o=Symbol("kByteLength"),p=Buffer.alloc(4),q=8192;class r{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||p,b.generateMask?b.generateMask(c):(8192===q&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),q=0),c[0]=d[q++],c[1]=d[q++],c[2]=d[q++],c[3]=d[q++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[o]?b[o]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[o]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(r.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[o]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(r.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=n(a)).length,e=n.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[o]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[o],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(s,this,a,d);return}this._bufferedBytes-=c[o];let e=n(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(r.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(t,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(r.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[o],this._state=1,e.compress(a,c.fin,(a,b)=>{this._socket.destroyed?s(this,Error("The socket was closed while data was being compressed"),d):(this._bufferedBytes-=c[o],this._state=0,c.readOnly=!1,this.sendFrame(r.frame(b,c),d),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][o],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][o],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function s(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function t(a,b,c){s(a,b,c),a.onerror(b)}b.exports=r},4049,(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=a.r(65514),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class n{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(n.prototype,"target",{enumerable:!0}),Object.defineProperty(n.prototype,"type",{enumerable:!0});class o extends n{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(o.prototype,"code",{enumerable:!0}),Object.defineProperty(o.prototype,"reason",{enumerable:!0}),Object.defineProperty(o.prototype,"wasClean",{enumerable:!0});class p extends n{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(p.prototype,"error",{enumerable:!0}),Object.defineProperty(p.prototype,"message",{enumerable:!0});class q extends n{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function r(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(q.prototype,"data",{enumerable:!0}),b.exports={CloseEvent:o,ErrorEvent:p,Event:n,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new q("message",{data:c?a:a.toString()});d[k]=this,r(b,this,d)};else if("close"===a)f=function(a,c){let d=new o("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,r(b,this,d)};else if("error"===a)f=function(a){let c=new p("error",{error:a,message:a.message});c[k]=this,r(b,this,c)};else{if("open"!==a)return;f=function(){let a=new n("open");a[k]=this,r(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:q}},20529,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}b.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,n=0;for(;n<a.length;n++)if(l=a.charCodeAt(n),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=n);else if(0!==n&&(32===l||9===l))-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=n);else if(32===l||9===l)-1===m&&-1!==k&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,n),k=m=-1;else throw SyntaxError(`Unexpected character at index ${n}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${n}`);-1===k?k=n:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=n);else if(34===l&&-1!==k)j=!1,m=n;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${n}`);else if(34===l&&61===a.charCodeAt(n-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=n);else if(-1!==k&&(32===l||9===l))-1===m&&(m=n);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${n}`);-1===m&&(m=n);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${n}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=n);let o=a.slice(k,m);return void 0===b?e(f,o,g):(void 0===c?e(g,o,!0):h?e(g,c,o.replace(/\\/g,"")):e(g,c,o),e(f,b,g)),f}}},89877,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(24836),f=a.r(21517),g=a.r(4446),h=a.r(55004),{randomBytes:i,createHash:j}=a.r(54799),{Duplex:k,Readable:l}=a.r(88947),{URL:m}=a.r(92509),n=a.r(19199),o=a.r(75091),p=a.r(10697),{isBlob:q}=a.r(55572),{BINARY_TYPES:r,EMPTY_BUFFER:s,GUID:t,kForOnEventAttribute:u,kListener:v,kStatusCode:w,kWebSocket:x,NOOP:y}=a.r(65514),{EventTarget:{addEventListener:z,removeEventListener:A}}=a.r(4049),{format:B,parse:C}=a.r(20529),{toBuffer:D}=a.r(40352),E=Symbol("kAborted"),F=[8,13],G=["CONNECTING","OPEN","CLOSING","CLOSED"],H=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends d{constructor(a,b,c){super(),this._binaryType=r[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=s,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,o,p={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:F[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=p.autoPong,!F.includes(p.protocolVersion))throw RangeError(`Unsupported protocol version: ${p.protocolVersion} (supported versions: ${F.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let q="wss:"===h.protocol,r="ws+unix:"===h.protocol;if("ws:"===h.protocol||q||r?r&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void J(b,a);throw a}let s=q?443:80,u=i(16).toString("base64"),v=q?e.request:f.request,w=new Set;if(p.createConnection=p.createConnection||(q?L:K),p.defaultPort=p.defaultPort||s,p.port=h.port||s,p.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,p.headers={...p.headers,"Sec-WebSocket-Version":p.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket"},p.path=h.pathname+h.search,p.timeout=p.handshakeTimeout,p.perMessageDeflate&&(l=new n(!0!==p.perMessageDeflate?p.perMessageDeflate:{},!1,p.maxPayload),p.headers["Sec-WebSocket-Extensions"]=B({[n.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!H.test(a)||w.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(a)}p.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(p.origin&&(p.protocolVersion<13?p.headers["Sec-WebSocket-Origin"]=p.origin:p.headers.Origin=p.origin),(h.username||h.password)&&(p.auth=`${h.username}:${h.password}`),r){let a=p.path.split(":");p.socketPath=a[0],p.path=a[1]}if(p.followRedirects){if(0===b._redirects){b._originalIpc=r,b._originalSecure=q,b._originalHostOrSocketPath=r?p.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=r?!!b._originalIpc&&p.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete p.headers.authorization,delete p.headers.cookie,a||delete p.headers.host,p.auth=void 0)}p.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(p.auth).toString("base64")),o=b._req=v(p),b._redirects&&b.emit("redirect",b.url,o)}else o=b._req=v(p);p.timeout&&o.on("timeout",()=>{M(b,o,"Opening handshake has timed out")}),o.on("error",a=>{null===o||o[E]||(o=b._req=null,J(b,a))}),o.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&p.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>p.maxRedirects)return void M(b,o,"Maximum redirects exceeded");o.abort();try{e=new m(f,c)}catch(a){J(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",o,e)||M(b,o,`Unexpected server response: ${e.statusCode}`)}),o.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==I.CONNECTING)return;o=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void M(b,c,"Invalid Upgrade header");let g=j("sha1").update(u+t).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void M(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?w.size?w.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":w.size&&(e="Server sent no subprotocol"),e)return void M(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void M(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=C(i)}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==n.extensionName)return void M(b,c,"Server indicated an extension that was not requested");try{l.accept(a[n.extensionName])}catch(a){M(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[n.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:p.allowSynchronousEvents,generateMask:p.generateMask,maxPayload:p.maxPayload,skipUTF8Validation:p.skipUTF8Validation})}),p.finishRequest?p.finishRequest(o,b):o.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){r.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new p(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[x]=this,e[x]=this,a[x]=this,d.on("conclude",O),d.on("drain",P),d.on("error",Q),d.on("message",S),d.on("ping",T),d.on("pong",U),e.onerror=W,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Y),a.on("data",Z),a.on("end",$),a.on("error",_),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[n.extensionName]&&this._extensions[n.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),X(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.ping(a||s,b,c))}pong(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)?N(this,a,c):(void 0===b&&(b=!this._isServer),this._sender.pong(a||s,b,c))}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==I.OPEN)return void N(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[n.extensionName]||(d.compress=!1),this._sender.send(a||s,d,c)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING)return void M(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function J(a,b){a._readyState=I.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function K(a){return a.path=a.socketPath,g.connect(a)}function L(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function M(a,b,c){a._readyState=I.CLOSING;let d=Error(c);Error.captureStackTrace(d,M),b.setHeader?(b[E]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(J,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function N(a,b,c){if(b){let c=q(b)?b.size:D(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${G[a.readyState]})`);process.nextTick(c,b)}}function O(a,b){let c=this[x];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[x]&&(c._socket.removeListener("data",Z),process.nextTick(V,c._socket),1005===a?c.close():c.close(a,b))}function P(){let a=this[x];a.isPaused||a._socket.resume()}function Q(a){let b=this[x];void 0!==b._socket[x]&&(b._socket.removeListener("data",Z),process.nextTick(V,b._socket),b.close(a[w])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function R(){this[x].emitClose()}function S(a,b){this[x].emit("message",a,b)}function T(a){let b=this[x];b._autoPong&&b.pong(a,!this._isServer,y),b.emit("ping",a)}function U(a){this[x].emit("pong",a)}function V(a){a.resume()}function W(a){let b=this[x];b.readyState!==I.CLOSED&&(b.readyState===I.OPEN&&(b._readyState=I.CLOSING,X(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function X(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Y(){let a,b=this[x];this.removeListener("close",Y),this.removeListener("data",Z),this.removeListener("end",$),b._readyState=I.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[x]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",R),b._receiver.on("finish",R))}function Z(a){this[x]._receiver.write(a)||this.pause()}function $(){let a=this[x];a._readyState=I.CLOSING,a._receiver.end(),this.end()}function _(){let a=this[x];this.removeListener("error",_),this.on("error",y),a&&(a._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:G.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:G.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:G.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:G.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(I.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(I.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[u])return b[v];return null},set(b){for(let b of this.listeners(a))if(b[u]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[u]:!0})}})}),I.prototype.addEventListener=z,I.prototype.removeEventListener=A,b.exports=I},29e3,(a,b,c)=>{"use strict";a.r(89877);let{Duplex:d}=a.r(88947);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}b.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){a.readyState===a.CONNECTING?a.once("open",function(){h._final(b)}):null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){a.readyState===a.CONNECTING?a.once("open",function(){h._write(b,c,d)}):a.send(b,d)},h.on("end",f),h.on("error",g),h}},71553,(a,b,c)=>{"use strict";let{tokenChars:d}=a.r(55572);b.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},95837,(a,b,c)=>{"use strict";let d=a.r(27699),e=a.r(21517),{Duplex:f}=a.r(88947),{createHash:g}=a.r(54799),h=a.r(20529),i=a.r(19199),j=a.r(71553),k=a.r(89877),{GUID:l,kWebSocket:m}=a.r(65514),n=/^[+/0-9A-Za-z]{22}==$/;function o(a){a._state=2,a.emit("close")}function p(){this.destroy()}function q(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function r(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,r),a.emit("wsClientError",d,c,b)}else q(c,d,e,f)}b.exports=class extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){const a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(o,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(o,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{o(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",p);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void r(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void r(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!n.test(e))return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void r(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void q(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){r(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],o={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),o[i.extensionName]=c)}catch(c){r(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return q(b,g||401,h,i);this.completeUpgrade(o,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return q(b,401)}this.completeUpgrade(o,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q(e,503);let k=g("sha1").update(b+l).digest("base64"),n=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],r=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(n.push(`Sec-WebSocket-Protocol: ${a}`),r._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});n.push(`Sec-WebSocket-Extensions: ${c}`),r._extensions=a}this.emit("headers",n,d),e.write(n.concat("\r\n").join("\r\n")),e.removeListener("error",p),r.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(r),r.on("close",()=>{this.clients.delete(r),this._shouldEmitClose&&!this.clients.size&&process.nextTick(o,this)})),j(r,d)}}},30100,a=>{"use strict";let b,c,d,e,f,g,h,i,j;var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC=a.i(87924),bD=a.i(72131);let bE=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},bF=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var bG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let bH=(0,bD.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:e="",children:f,iconNode:g,...h},i)=>(0,bD.createElement)("svg",{ref:i,...bG,width:b,height:b,stroke:a,strokeWidth:d?24*Number(c)/Number(b):c,className:bF("lucide",e),...!f&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(h)&&{"aria-hidden":"true"},...h},[...g.map(([a,b])=>(0,bD.createElement)(a,b)),...Array.isArray(f)?f:[f]])),bI=(a,b)=>{let c=(0,bD.forwardRef)(({className:c,...d},e)=>(0,bD.createElement)(bH,{ref:e,iconNode:b,className:bF(`lucide-${bE(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,c),...d}));return c.displayName=bE(a),c},bJ=bI("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),bK=bI("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),bL=bI("brain-circuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),bM=bI("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),bN=bI("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),bO=bI("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),bP=bI("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),bQ=bI("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bR=bI("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),bS=bI("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),bT=bI("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),bU=bI("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),bV=bI("sticky-note",[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]]);var bW=a.i(35112);function bX(a){let b=Object.prototype.toString.call(a);return"[object Window]"===b||"[object global]"===b}function bY(a){return"nodeType"in a}function bZ(a){var b,c;return a?bX(a)?a:bY(a)&&null!=(b=null==(c=a.ownerDocument)?void 0:c.defaultView)?b:window:window}function b$(a){let{Document:b}=bZ(a);return a instanceof b}function b_(a){return!bX(a)&&a instanceof bZ(a).HTMLElement}function b0(a){return a instanceof bZ(a).SVGElement}function b1(a){return a?bX(a)?a.document:bY(a)?b$(a)?a:b_(a)||b0(a)?a.ownerDocument:document:document:document}let b2=bD.useEffect;function b3(a){let b=(0,bD.useRef)(a);return b2(()=>{b.current=a}),(0,bD.useCallback)(function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return null==b.current?void 0:b.current(...c)},[])}function b4(a,b){void 0===b&&(b=[a]);let c=(0,bD.useRef)(a);return b2(()=>{c.current!==a&&(c.current=a)},b),c}function b5(a,b){let c=(0,bD.useRef)();return(0,bD.useMemo)(()=>{let b=a(c.current);return c.current=b,b},[...b])}function b6(a){let b=b3(a),c=(0,bD.useRef)(null),d=(0,bD.useCallback)(a=>{a!==c.current&&(null==b||b(a,c.current)),c.current=a},[]);return[c,d]}function b7(a){let b=(0,bD.useRef)();return(0,bD.useEffect)(()=>{b.current=a},[a]),b.current}let b8={};function b9(a,b){return(0,bD.useMemo)(()=>{if(b)return b;let c=null==b8[a]?0:b8[a]+1;return b8[a]=c,a+"-"+c},[a,b])}function ca(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return d.reduce((b,c)=>{for(let[d,e]of Object.entries(c)){let c=b[d];null!=c&&(b[d]=c+a*e)}return b},{...b})}}let cb=ca(1),cc=ca(-1);function cd(a){if(!a)return!1;let{KeyboardEvent:b}=bZ(a.target);return b&&a instanceof b}function ce(a){if(function(a){if(!a)return!1;let{TouchEvent:b}=bZ(a.target);return b&&a instanceof b}(a)){if(a.touches&&a.touches.length){let{clientX:b,clientY:c}=a.touches[0];return{x:b,y:c}}else if(a.changedTouches&&a.changedTouches.length){let{clientX:b,clientY:c}=a.changedTouches[0];return{x:b,y:c}}}return"clientX"in a&&"clientY"in a?{x:a.clientX,y:a.clientY}:null}let cf=Object.freeze({Translate:{toString(a){if(!a)return;let{x:b,y:c}=a;return"translate3d("+(b?Math.round(b):0)+"px, "+(c?Math.round(c):0)+"px, 0)"}},Scale:{toString(a){if(!a)return;let{scaleX:b,scaleY:c}=a;return"scaleX("+b+") scaleY("+c+")"}},Transform:{toString(a){if(a)return[cf.Translate.toString(a),cf.Scale.toString(a)].join(" ")}},Transition:{toString(a){let{property:b,duration:c,easing:d}=a;return b+" "+c+"ms "+d}}}),cg="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",ch={display:"none"};function ci(a){let{id:b,value:c}=a;return bD.default.createElement("div",{id:b,style:ch},c)}function cj(a){let{id:b,announcement:c,ariaLiveType:d="assertive"}=a;return bD.default.createElement("div",{id:b,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":d,"aria-atomic":!0},c)}let ck=(0,bD.createContext)(null),cl={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},cm={onDragStart(a){let{active:b}=a;return"Picked up draggable item "+b.id+"."},onDragOver(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was moved over droppable area "+c.id+".":"Draggable item "+b.id+" is no longer over a droppable area."},onDragEnd(a){let{active:b,over:c}=a;return c?"Draggable item "+b.id+" was dropped over droppable area "+c.id:"Draggable item "+b.id+" was dropped."},onDragCancel(a){let{active:b}=a;return"Dragging was cancelled. Draggable item "+b.id+" was dropped."}};function cn(a){var b;let c,{announcements:d=cm,container:e,hiddenTextDescribedById:f,screenReaderInstructions:g=cl}=a,{announce:h,announcement:i}=function(){let[a,b]=(0,bD.useState)("");return{announce:(0,bD.useCallback)(a=>{null!=a&&b(a)},[]),announcement:a}}(),j=b9("DndLiveRegion"),[k,l]=(0,bD.useState)(!1);if((0,bD.useEffect)(()=>{l(!0)},[]),b=(0,bD.useMemo)(()=>({onDragStart(a){let{active:b}=a;h(d.onDragStart({active:b}))},onDragMove(a){let{active:b,over:c}=a;d.onDragMove&&h(d.onDragMove({active:b,over:c}))},onDragOver(a){let{active:b,over:c}=a;h(d.onDragOver({active:b,over:c}))},onDragEnd(a){let{active:b,over:c}=a;h(d.onDragEnd({active:b,over:c}))},onDragCancel(a){let{active:b,over:c}=a;h(d.onDragCancel({active:b,over:c}))}}),[h,d]),c=(0,bD.useContext)(ck),(0,bD.useEffect)(()=>{if(!c)throw Error("useDndMonitor must be used within a children of <DndContext>");return c(b)},[b,c]),!k)return null;let m=bD.default.createElement(bD.default.Fragment,null,bD.default.createElement(ci,{id:f,value:g.draggable}),bD.default.createElement(cj,{id:j,announcement:i}));return e?(0,bW.createPortal)(m,e):m}function co(){}function cp(a,b){return(0,bD.useMemo)(()=>({sensor:a,options:null!=b?b:{}}),[a,b])}(k=az||(az={})).DragStart="dragStart",k.DragMove="dragMove",k.DragEnd="dragEnd",k.DragCancel="dragCancel",k.DragOver="dragOver",k.RegisterDroppable="registerDroppable",k.SetDroppableDisabled="setDroppableDisabled",k.UnregisterDroppable="unregisterDroppable";let cq=Object.freeze({x:0,y:0});function cr(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))}function cs(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return c-d}function ct(a,b){let{data:{value:c}}=a,{data:{value:d}}=b;return d-c}function cu(a){let{left:b,top:c,height:d,width:e}=a;return[{x:b,y:c},{x:b+e,y:c},{x:b,y:c+d},{x:b+e,y:c+d}]}function cv(a,b){if(!a||0===a.length)return null;let[c]=a;return b?c[b]:c}function cw(a,b,c){return void 0===b&&(b=a.left),void 0===c&&(c=a.top),{x:b+.5*a.width,y:c+.5*a.height}}let cx=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=cw(b,b.left,b.top),f=[];for(let a of d){let{id:b}=a,d=c.get(b);if(d){let c=cr(cw(d),e);f.push({id:b,data:{droppableContainer:a,value:c}})}}return f.sort(cs)},cy=a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=[];for(let a of d){let{id:d}=a,f=c.get(d);if(f){let c=function(a,b){let c=Math.max(b.top,a.top),d=Math.max(b.left,a.left),e=Math.min(b.left+b.width,a.left+a.width),f=Math.min(b.top+b.height,a.top+a.height);if(d<e&&c<f){let g=b.width*b.height,h=a.width*a.height,i=(e-d)*(f-c);return Number((i/(g+h-i)).toFixed(4))}return 0}(f,b);c>0&&e.push({id:d,data:{droppableContainer:a,value:c}})}}return e.sort(ct)};function cz(a,b){return a&&b?{x:a.left-b.left,y:a.top-b.top}:cq}let cA=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return c.reduce((a,b)=>({...a,top:a.top+ +b.y,bottom:a.bottom+ +b.y,left:a.left+ +b.x,right:a.right+ +b.x}),{...a})},cB={ignoreTransform:!1};function cC(a,b){void 0===b&&(b=cB);let c=a.getBoundingClientRect();if(b.ignoreTransform){let{transform:b,transformOrigin:d}=bZ(a).getComputedStyle(a);b&&(c=function(a,b,c){let d=function(a){if(a.startsWith("matrix3d(")){let b=a.slice(9,-1).split(/, /);return{x:+b[12],y:+b[13],scaleX:+b[0],scaleY:+b[5]}}if(a.startsWith("matrix(")){let b=a.slice(7,-1).split(/, /);return{x:+b[4],y:+b[5],scaleX:+b[0],scaleY:+b[3]}}return null}(b);if(!d)return a;let{scaleX:e,scaleY:f,x:g,y:h}=d,i=a.left-g-(1-e)*parseFloat(c),j=a.top-h-(1-f)*parseFloat(c.slice(c.indexOf(" ")+1)),k=e?a.width/e:a.width,l=f?a.height/f:a.height;return{width:k,height:l,top:j,right:i+k,bottom:j+l,left:i}}(c,b,d))}let{top:d,left:e,width:f,height:g,bottom:h,right:i}=c;return{top:d,left:e,width:f,height:g,bottom:h,right:i}}function cD(a){return cC(a,{ignoreTransform:!0})}function cE(a,b){let c=[];return a?function d(e){var f,g;let h;if(null!=b&&c.length>=b||!e)return c;if(b$(e)&&null!=e.scrollingElement&&!c.includes(e.scrollingElement))return c.push(e.scrollingElement),c;if(!b_(e)||b0(e)||c.includes(e))return c;let i=bZ(a).getComputedStyle(e);return(e!==a&&(void 0===(f=i)&&(f=bZ(e).getComputedStyle(e)),h=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(a=>{let b=f[a];return"string"==typeof b&&h.test(b)}))&&c.push(e),void 0===(g=i)&&(g=bZ(e).getComputedStyle(e)),"fixed"===g.position)?c:d(e.parentNode)}(a):c}function cF(a){let[b]=cE(a,1);return null!=b?b:null}function cG(a){return bX(a)?a.scrollX:a.scrollLeft}function cH(a){return bX(a)?a.scrollY:a.scrollTop}function cI(a){return{x:cG(a),y:cH(a)}}function cJ(a){let b={x:0,y:0},c={height:a.clientHeight,width:a.clientWidth},d={x:a.scrollWidth-c.width,y:a.scrollHeight-c.height},e=a.scrollTop<=b.y,f=a.scrollLeft<=b.x;return{isTop:e,isLeft:f,isBottom:a.scrollTop>=d.y,isRight:a.scrollLeft>=d.x,maxScroll:d,minScroll:b}}(l=aA||(aA={}))[l.Forward=1]="Forward",l[l.Backward=-1]="Backward";let cK={x:.2,y:.2};function cL(a){return a.reduce((a,b)=>cb(a,cI(b)),cq)}let cM=[["x",["left","right"],function(a){return a.reduce((a,b)=>a+cG(b),0)}],["y",["top","bottom"],function(a){return a.reduce((a,b)=>a+cH(b),0)}]];class cN{constructor(a,b){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const c=cE(b),d=cL(c);for(const[b,e,f]of(this.rect={...a},this.width=a.width,this.height=a.height,cM))for(const a of e)Object.defineProperty(this,a,{get:()=>{let e=f(c),g=d[b]-e;return this.rect[a]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class cO{constructor(a){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(a=>{var b;return null==(b=this.target)?void 0:b.removeEventListener(...a)})},this.target=a}add(a,b,c){var d;null==(d=this.target)||d.addEventListener(a,b,c),this.listeners.push([a,b,c])}}function cP(a,b){let c=Math.abs(a.x),d=Math.abs(a.y);return"number"==typeof b?Math.sqrt(c**2+d**2)>b:"x"in b&&"y"in b?c>b.x&&d>b.y:"x"in b?c>b.x:"y"in b&&d>b.y}function cQ(a){a.preventDefault()}function cR(a){a.stopPropagation()}(m=aB||(aB={})).Click="click",m.DragStart="dragstart",m.Keydown="keydown",m.ContextMenu="contextmenu",m.Resize="resize",m.SelectionChange="selectionchange",m.VisibilityChange="visibilitychange",(n=aC||(aC={})).Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab";let cS={start:[aC.Space,aC.Enter],cancel:[aC.Esc],end:[aC.Space,aC.Enter,aC.Tab]},cT=(a,b)=>{let{currentCoordinates:c}=b;switch(a.code){case aC.Right:return{...c,x:c.x+25};case aC.Left:return{...c,x:c.x-25};case aC.Down:return{...c,y:c.y+25};case aC.Up:return{...c,y:c.y-25}}};class cU{constructor(a){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=a;const{event:{target:b}}=a;this.props=a,this.listeners=new cO(b1(b)),this.windowListeners=new cO(bZ(b)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(aB.Resize,this.handleCancel),this.windowListeners.add(aB.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(aB.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:a,onStart:b}=this.props,c=a.node.current;c&&function(a,b){if(void 0===b&&(b=cC),!a)return;let{top:c,left:d,bottom:e,right:f}=b(a);cF(a)&&(e<=0||f<=0||c>=window.innerHeight||d>=window.innerWidth)&&a.scrollIntoView({block:"center",inline:"center"})}(c),b(cq)}handleKeyDown(a){if(cd(a)){let{active:b,context:c,options:d}=this.props,{keyboardCodes:e=cS,coordinateGetter:f=cT,scrollBehavior:g="smooth"}=d,{code:h}=a;if(e.end.includes(h))return void this.handleEnd(a);if(e.cancel.includes(h))return void this.handleCancel(a);let{collisionRect:i}=c.current,j=i?{x:i.left,y:i.top}:cq;this.referenceCoordinates||(this.referenceCoordinates=j);let k=f(a,{active:b,context:c.current,currentCoordinates:j});if(k){let b=cc(k,j),d={x:0,y:0},{scrollableAncestors:e}=c.current;for(let c of e){let e=a.code,{isTop:f,isRight:h,isLeft:i,isBottom:j,maxScroll:l,minScroll:m}=cJ(c),n=function(a){if(a===document.scrollingElement){let{innerWidth:a,innerHeight:b}=window;return{top:0,left:0,right:a,bottom:b,width:a,height:b}}let{top:b,left:c,right:d,bottom:e}=a.getBoundingClientRect();return{top:b,left:c,right:d,bottom:e,width:a.clientWidth,height:a.clientHeight}}(c),o={x:Math.min(e===aC.Right?n.right-n.width/2:n.right,Math.max(e===aC.Right?n.left:n.left+n.width/2,k.x)),y:Math.min(e===aC.Down?n.bottom-n.height/2:n.bottom,Math.max(e===aC.Down?n.top:n.top+n.height/2,k.y))},p=e===aC.Right&&!h||e===aC.Left&&!i,q=e===aC.Down&&!j||e===aC.Up&&!f;if(p&&o.x!==k.x){let a=c.scrollLeft+b.x,f=e===aC.Right&&a<=l.x||e===aC.Left&&a>=m.x;if(f&&!b.y)return void c.scrollTo({left:a,behavior:g});f?d.x=c.scrollLeft-a:d.x=e===aC.Right?c.scrollLeft-l.x:c.scrollLeft-m.x,d.x&&c.scrollBy({left:-d.x,behavior:g});break}if(q&&o.y!==k.y){let a=c.scrollTop+b.y,f=e===aC.Down&&a<=l.y||e===aC.Up&&a>=m.y;if(f&&!b.x)return void c.scrollTo({top:a,behavior:g});f?d.y=c.scrollTop-a:d.y=e===aC.Down?c.scrollTop-l.y:c.scrollTop-m.y,d.y&&c.scrollBy({top:-d.y,behavior:g});break}}this.handleMove(a,cb(cc(k,this.referenceCoordinates),d))}}}handleMove(a,b){let{onMove:c}=this.props;a.preventDefault(),c(b)}handleEnd(a){let{onEnd:b}=this.props;a.preventDefault(),this.detach(),b()}handleCancel(a){let{onCancel:b}=this.props;a.preventDefault(),this.detach(),b()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function cV(a){return!!(a&&"distance"in a)}function cW(a){return!!(a&&"delay"in a)}cU.activators=[{eventName:"onKeyDown",handler:(a,b,c)=>{let{keyboardCodes:d=cS,onActivation:e}=b,{active:f}=c,{code:g}=a.nativeEvent;if(d.start.includes(g)){let b=f.activatorNode.current;return(!b||a.target===b)&&(a.preventDefault(),null==e||e({event:a.nativeEvent}),!0)}return!1}}];class cX{constructor(a,b,c){var d;void 0===c&&(c=function(a){let{EventTarget:b}=bZ(a);return a instanceof b?a:b1(a)}(a.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=a,this.events=b;const{event:e}=a,{target:f}=e;this.props=a,this.events=b,this.document=b1(f),this.documentListeners=new cO(this.document),this.listeners=new cO(c),this.windowListeners=new cO(bZ(f)),this.initialCoordinates=null!=(d=ce(e))?d:cq,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:a,props:{options:{activationConstraint:b,bypassActivationConstraint:c}}}=this;if(this.listeners.add(a.move.name,this.handleMove,{passive:!1}),this.listeners.add(a.end.name,this.handleEnd),a.cancel&&this.listeners.add(a.cancel.name,this.handleCancel),this.windowListeners.add(aB.Resize,this.handleCancel),this.windowListeners.add(aB.DragStart,cQ),this.windowListeners.add(aB.VisibilityChange,this.handleCancel),this.windowListeners.add(aB.ContextMenu,cQ),this.documentListeners.add(aB.Keydown,this.handleKeydown),b){if(null!=c&&c({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(cW(b)){this.timeoutId=setTimeout(this.handleStart,b.delay),this.handlePending(b);return}if(cV(b))return void this.handlePending(b)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(a,b){let{active:c,onPending:d}=this.props;d(c,a,this.initialCoordinates,b)}handleStart(){let{initialCoordinates:a}=this,{onStart:b}=this.props;a&&(this.activated=!0,this.documentListeners.add(aB.Click,cR,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(aB.SelectionChange,this.removeTextSelection),b(a))}handleMove(a){var b;let{activated:c,initialCoordinates:d,props:e}=this,{onMove:f,options:{activationConstraint:g}}=e;if(!d)return;let h=null!=(b=ce(a))?b:cq,i=cc(d,h);if(!c&&g){if(cV(g)){if(null!=g.tolerance&&cP(i,g.tolerance))return this.handleCancel();if(cP(i,g.distance))return this.handleStart()}return cW(g)&&cP(i,g.tolerance)?this.handleCancel():void this.handlePending(g,i)}a.cancelable&&a.preventDefault(),f(h)}handleEnd(){let{onAbort:a,onEnd:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleCancel(){let{onAbort:a,onCancel:b}=this.props;this.detach(),this.activated||a(this.props.active),b()}handleKeydown(a){a.code===aC.Esc&&this.handleCancel()}removeTextSelection(){var a;null==(a=this.document.getSelection())||a.removeAllRanges()}}let cY={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class cZ extends cX{constructor(a){const{event:b}=a;super(a,cY,b1(b.target))}}cZ.activators=[{eventName:"onPointerDown",handler:(a,b)=>{let{nativeEvent:c}=a,{onActivation:d}=b;return!!c.isPrimary&&0===c.button&&(null==d||d({event:c}),!0)}}];(o=aD||(aD={}))[o.RightClick=2]="RightClick";(p=aE||(aE={}))[p.Pointer=0]="Pointer",p[p.DraggableRect=1]="DraggableRect",(q=aF||(aF={}))[q.TreeOrder=0]="TreeOrder",q[q.ReversedTreeOrder=1]="ReversedTreeOrder";let c$={x:{[aA.Backward]:!1,[aA.Forward]:!1},y:{[aA.Backward]:!1,[aA.Forward]:!1}};(r=aG||(aG={}))[r.Always=0]="Always",r[r.BeforeDragging=1]="BeforeDragging",r[r.WhileDragging=2]="WhileDragging",(aH||(aH={})).Optimized="optimized";let c_=new Map;function c0(a,b){return b5(c=>a?c||("function"==typeof b?b(a):a):null,[b,a])}function c1(a){let{callback:b,disabled:c}=a;b3(b);let d=(0,bD.useMemo)(()=>{},[c]);return(0,bD.useEffect)(()=>()=>null==d?void 0:d.disconnect(),[d]),d}function c2(a){return new cN(cC(a),a)}function c3(a,b,c){void 0===b&&(b=c2);let[d,e]=(0,bD.useState)(null);function f(){e(d=>{if(!a)return null;if(!1===a.isConnected){var e;return null!=(e=null!=d?d:c)?e:null}let f=b(a);return JSON.stringify(d)===JSON.stringify(f)?d:f})}let g=function(a){let{callback:b,disabled:c}=a,d=b3(b),e=(0,bD.useMemo)(()=>{},[d,c]);return(0,bD.useEffect)(()=>()=>null==e?void 0:e.disconnect(),[e]),e}({callback(b){if(a)for(let c of b){let{type:b,target:d}=c;if("childList"===b&&d instanceof HTMLElement&&d.contains(a)){f();break}}}}),h=c1({callback:f});return b2(()=>{f(),a?(null==h||h.observe(a),null==g||g.observe(document.body,{childList:!0,subtree:!0})):(null==h||h.disconnect(),null==g||g.disconnect())},[a]),d}let c4=[];function c5(a,b){void 0===b&&(b=[]);let c=(0,bD.useRef)(null);return(0,bD.useEffect)(()=>{c.current=null},b),(0,bD.useEffect)(()=>{let b=a!==cq;b&&!c.current&&(c.current=a),!b&&c.current&&(c.current=null)},[a]),c.current?cc(a,c.current):cq}function c6(a){return(0,bD.useMemo)(()=>{let b,c;return a?(b=a.innerWidth,{top:0,left:0,right:b,bottom:c=a.innerHeight,width:b,height:c}):null},[a])}let c7=[],c8=[{sensor:cZ,options:{}},{sensor:cU,options:{}}],c9={current:{}},da={draggable:{measure:cD},droppable:{measure:cD,strategy:aG.WhileDragging,frequency:aH.Optimized},dragOverlay:{measure:cC}};class db extends Map{get(a){var b;return null!=a&&null!=(b=super.get(a))?b:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(a=>{let{disabled:b}=a;return!b})}getNodeFor(a){var b,c;return null!=(b=null==(c=this.get(a))?void 0:c.node.current)?b:void 0}}let dc={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new db,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:co},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:da,measureDroppableContainers:co,windowRect:null,measuringScheduled:!1},dd={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:co,draggableNodes:new Map,over:null,measureDroppableContainers:co},de=(0,bD.createContext)(dd),df=(0,bD.createContext)(dc);function dg(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new db}}}function dh(a,b){switch(b.type){case az.DragStart:return{...a,draggable:{...a.draggable,initialCoordinates:b.initialCoordinates,active:b.active}};case az.DragMove:if(null==a.draggable.active)return a;return{...a,draggable:{...a.draggable,translate:{x:b.coordinates.x-a.draggable.initialCoordinates.x,y:b.coordinates.y-a.draggable.initialCoordinates.y}}};case az.DragEnd:case az.DragCancel:return{...a,draggable:{...a.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case az.RegisterDroppable:{let{element:c}=b,{id:d}=c,e=new db(a.droppable.containers);return e.set(d,c),{...a,droppable:{...a.droppable,containers:e}}}case az.SetDroppableDisabled:{let{id:c,key:d,disabled:e}=b,f=a.droppable.containers.get(c);if(!f||d!==f.key)return a;let g=new db(a.droppable.containers);return g.set(c,{...f,disabled:e}),{...a,droppable:{...a.droppable,containers:g}}}case az.UnregisterDroppable:{let{id:c,key:d}=b,e=a.droppable.containers.get(c);if(!e||d!==e.key)return a;let f=new db(a.droppable.containers);return f.delete(c),{...a,droppable:{...a.droppable,containers:f}}}default:return a}}function di(a){let{disabled:b}=a,{active:c,activatorEvent:d,draggableNodes:e}=(0,bD.useContext)(de),f=b7(d),g=b7(null==c?void 0:c.id);return(0,bD.useEffect)(()=>{if(!b&&!d&&f&&null!=g){if(!cd(f)||document.activeElement===f.target)return;let a=e.get(g);if(!a)return;let{activatorNode:b,node:c}=a;(b.current||c.current)&&requestAnimationFrame(()=>{for(let a of[b.current,c.current]){if(!a)continue;let b=a.matches(cg)?a:a.querySelector(cg);if(b){b.focus();break}}})}},[d,b,e,g,f]),null}let dj=(0,bD.createContext)({...cq,scaleX:1,scaleY:1});(s=aI||(aI={}))[s.Uninitialized=0]="Uninitialized",s[s.Initializing=1]="Initializing",s[s.Initialized=2]="Initialized";let dk=(0,bD.memo)(function(a){var b,c,d,e,f,g,h,i;let j,k,l,m,n,o,p,q,{id:r,accessibility:s,autoScroll:t=!0,children:u,sensors:v=c8,collisionDetection:w=cy,measuring:x,modifiers:y,...z}=a,[A,B]=(0,bD.useReducer)(dh,void 0,dg),[C,D]=function(){let[a]=(0,bD.useState)(()=>new Set),b=(0,bD.useCallback)(b=>(a.add(b),()=>a.delete(b)),[a]);return[(0,bD.useCallback)(b=>{let{type:c,event:d}=b;a.forEach(a=>{var b;return null==(b=a[c])?void 0:b.call(a,d)})},[a]),b]}(),[E,F]=(0,bD.useState)(aI.Uninitialized),G=E===aI.Initialized,{draggable:{active:H,nodes:I,translate:J},droppable:{containers:K}}=A,L=null!=H?I.get(H):null,M=(0,bD.useRef)({initial:null,translated:null}),N=(0,bD.useMemo)(()=>{var a;return null!=H?{id:H,data:null!=(a=null==L?void 0:L.data)?a:c9,rect:M}:null},[H,L]),O=(0,bD.useRef)(null),[P,Q]=(0,bD.useState)(null),[R,S]=(0,bD.useState)(null),T=b4(z,Object.values(z)),U=b9("DndDescribedBy",r),V=(0,bD.useMemo)(()=>K.getEnabled(),[K]),W=(0,bD.useMemo)(()=>({draggable:{...da.draggable,...null==x?void 0:x.draggable},droppable:{...da.droppable,...null==x?void 0:x.droppable},dragOverlay:{...da.dragOverlay,...null==x?void 0:x.dragOverlay}}),[null==x?void 0:x.draggable,null==x?void 0:x.droppable,null==x?void 0:x.dragOverlay]),{droppableRects:X,measureDroppableContainers:Y,measuringScheduled:Z}=function(a,b){let{dragging:c,dependencies:d,config:e}=b,[f,g]=(0,bD.useState)(null),{frequency:h,measure:i,strategy:j}=e,k=(0,bD.useRef)(a),l=function(){switch(j){case aG.Always:return!1;case aG.BeforeDragging:return c;default:return!c}}(),m=b4(l),n=(0,bD.useCallback)(function(a){void 0===a&&(a=[]),m.current||g(b=>null===b?a:b.concat(a.filter(a=>!b.includes(a))))},[m]),o=(0,bD.useRef)(null),p=b5(b=>{if(l&&!c)return c_;if(!b||b===c_||k.current!==a||null!=f){let b=new Map;for(let c of a){if(!c)continue;if(f&&f.length>0&&!f.includes(c.id)&&c.rect.current){b.set(c.id,c.rect.current);continue}let a=c.node.current,d=a?new cN(i(a),a):null;c.rect.current=d,d&&b.set(c.id,d)}return b}return b},[a,f,c,l,i]);return(0,bD.useEffect)(()=>{k.current=a},[a]),(0,bD.useEffect)(()=>{l||n()},[c,l]),(0,bD.useEffect)(()=>{f&&f.length>0&&g(null)},[JSON.stringify(f)]),(0,bD.useEffect)(()=>{l||"number"!=typeof h||null!==o.current||(o.current=setTimeout(()=>{n(),o.current=null},h))},[h,l,n,...d]),{droppableRects:p,measureDroppableContainers:n,measuringScheduled:null!=f}}(V,{dragging:G,dependencies:[J.x,J.y],config:W.droppable}),$=b5(a=>{var b;return null==H?null:null!=(b=null!=n?n:a)?b:null},[n=(m=null!=H?I.get(H):void 0)?m.node.current:null,H]),_=(0,bD.useMemo)(()=>R?ce(R):null,[R]),aa=(j=(null==P?void 0:P.autoScrollEnabled)===!1,k="object"==typeof t?!1===t.enabled:!1===t,l=G&&!j&&!k,"object"==typeof t?{...t,enabled:l}:{enabled:l}),ab=c0($,W.draggable.measure);!function(a){let{activeNode:b,measure:c,initialRect:d,config:e=!0}=a,f=(0,bD.useRef)(!1),{x:g,y:h}="boolean"==typeof e?{x:e,y:e}:e;b2(()=>{if(!g&&!h||!b){f.current=!1;return}if(f.current||!d)return;let a=null==b?void 0:b.node.current;if(!a||!1===a.isConnected)return;let e=cz(c(a),d);if(g||(e.x=0),h||(e.y=0),f.current=!0,Math.abs(e.x)>0||Math.abs(e.y)>0){let b=cF(a);b&&b.scrollBy({top:e.y,left:e.x})}},[b,g,h,d,c])}({activeNode:null!=H?I.get(H):null,config:aa.layoutShiftCompensation,initialRect:ab,measure:W.draggable.measure});let ac=c3($,W.draggable.measure,ab),ad=c3($?$.parentElement:null),ae=(0,bD.useRef)({activatorEvent:null,active:null,activeNode:$,collisionRect:null,collisions:null,droppableRects:X,draggableNodes:I,draggingNode:null,draggingNodeRect:null,droppableContainers:K,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),af=K.getNodeFor(null==(b=ae.current.over)?void 0:b.id),ag=function(a){let{measure:b}=a,[c,d]=(0,bD.useState)(null),e=c1({callback:(0,bD.useCallback)(a=>{for(let{target:c}of a)if(b_(c)){d(a=>{let d=b(c);return a?{...a,width:d.width,height:d.height}:d});break}},[b])}),[f,g]=b6((0,bD.useCallback)(a=>{let c=function(a){if(!a)return null;if(a.children.length>1)return a;let b=a.children[0];return b_(b)?b:a}(a);null==e||e.disconnect(),c&&(null==e||e.observe(c)),d(c?b(c):null)},[b,e]));return(0,bD.useMemo)(()=>({nodeRef:f,rect:c,setRef:g}),[c,f,g])}({measure:W.dragOverlay.measure}),ah=null!=(c=ag.nodeRef.current)?c:$,ai=G?null!=(d=ag.rect)?d:ac:null,aj=!!(ag.nodeRef.current&&ag.rect),ak=(o=c0(f=aj?null:ac),cz(f,o)),al=c6(ah?bZ(ah):null),am=(g=G?null!=af?af:$:null,p=(0,bD.useRef)(g),q=b5(a=>g?a&&a!==c4&&g&&p.current&&g.parentNode===p.current.parentNode?a:cE(g):c4,[g]),(0,bD.useEffect)(()=>{p.current=g},[g]),q),an=function(a,b){void 0===b&&(b=cC);let[c]=a,d=c6(c?bZ(c):null),[e,f]=(0,bD.useState)(c7);function g(){f(()=>a.length?a.map(a=>new cN(b(a),a)):c7)}let h=c1({callback:g});return b2(()=>{null==h||h.disconnect(),g(),a.forEach(a=>null==h?void 0:h.observe(a))},[a]),e}(am),ao=function(a,b){let{transform:c,...d}=b;return null!=a&&a.length?a.reduce((a,b)=>b({transform:a,...d}),c):c}(y,{transform:{x:J.x-ak.x,y:J.y-ak.y,scaleX:1,scaleY:1},activatorEvent:R,active:N,activeNodeRect:ac,containerNodeRect:ad,draggingNodeRect:ai,over:ae.current.over,overlayNodeRect:ag.rect,scrollableAncestors:am,scrollableAncestorRects:an,windowRect:al}),ap=_?cb(_,J):null,aq=function(a){let[b,c]=(0,bD.useState)(null),d=(0,bD.useRef)(a),e=(0,bD.useCallback)(a=>{var b;let d=(b=a.target,null);d&&c(a=>a?(a.set(d,cI(d)),new Map(a)):null)},[]);return(0,bD.useEffect)(()=>{let b=d.current;if(a!==b){f(b);let g=a.map(a=>{var b;let c=(b=0,null);return c?(c.addEventListener("scroll",e,{passive:!0}),[c,cI(c)]):null}).filter(a=>null!=a);c(g.length?new Map(g):null),d.current=a}return()=>{f(a),f(b)};function f(a){a.forEach(a=>{let b=null;null==b||b.removeEventListener("scroll",e)})}},[e,a]),(0,bD.useMemo)(()=>a.length?b?Array.from(b.values()).reduce((a,b)=>cb(a,b),cq):cL(a):cq,[a,b])}(am),ar=c5(aq),as=c5(aq,[ac]),at=cb(ao,ar),au=ai?cA(ai,ao):null,av=N&&au?w({active:N,collisionRect:au,droppableRects:X,droppableContainers:V,pointerCoordinates:ap}):null,aw=cv(av,"id"),[ax,ay]=(0,bD.useState)(null),aB=(h=aj?ao:cb(ao,as),i=null!=(e=null==ax?void 0:ax.rect)?e:null,{...h,scaleX:i&&ac?i.width/ac.width:1,scaleY:i&&ac?i.height/ac.height:1}),aC=(0,bD.useRef)(null),aD=(0,bD.useCallback)((a,b)=>{let{sensor:c,options:d}=b;if(null==O.current)return;let e=I.get(O.current);if(!e)return;let f=a.nativeEvent,g=new c({active:O.current,activeNode:e,event:f,options:d,context:ae,onAbort(a){if(!I.get(a))return;let{onDragAbort:b}=T.current,c={id:a};null==b||b(c),C({type:"onDragAbort",event:c})},onPending(a,b,c,d){if(!I.get(a))return;let{onDragPending:e}=T.current,f={id:a,constraint:b,initialCoordinates:c,offset:d};null==e||e(f),C({type:"onDragPending",event:f})},onStart(a){let b=O.current;if(null==b)return;let c=I.get(b);if(!c)return;let{onDragStart:d}=T.current,e={activatorEvent:f,active:{id:b,data:c.data,rect:M}};(0,bW.unstable_batchedUpdates)(()=>{null==d||d(e),F(aI.Initializing),B({type:az.DragStart,initialCoordinates:a,active:b}),C({type:"onDragStart",event:e}),Q(aC.current),S(f)})},onMove(a){B({type:az.DragMove,coordinates:a})},onEnd:h(az.DragEnd),onCancel:h(az.DragCancel)});function h(a){return async function(){let{active:b,collisions:c,over:d,scrollAdjustedTranslate:e}=ae.current,g=null;if(b&&e){let{cancelDrop:h}=T.current;g={activatorEvent:f,active:b,collisions:c,delta:e,over:d},a===az.DragEnd&&"function"==typeof h&&await Promise.resolve(h(g))&&(a=az.DragCancel)}O.current=null,(0,bW.unstable_batchedUpdates)(()=>{B({type:a}),F(aI.Uninitialized),ay(null),Q(null),S(null),aC.current=null;let b=a===az.DragEnd?"onDragEnd":"onDragCancel";if(g){let a=T.current[b];null==a||a(g),C({type:b,event:g})}})}}aC.current=g},[I]),aH=(0,bD.useCallback)((a,b)=>(c,d)=>{let e=c.nativeEvent,f=I.get(d);null!==O.current||!f||e.dndKit||e.defaultPrevented||!0===a(c,b.options,{active:f})&&(e.dndKit={capturedBy:b.sensor},O.current=d,aD(c,b))},[I,aD]),aJ=(0,bD.useMemo)(()=>v.reduce((a,b)=>{let{sensor:c}=b;return[...a,...c.activators.map(a=>({eventName:a.eventName,handler:aH(a.handler,b)}))]},[]),[v,aH]);(0,bD.useEffect)(()=>{},v.map(a=>{let{sensor:b}=a;return b})),b2(()=>{ac&&E===aI.Initializing&&F(aI.Initialized)},[ac,E]),(0,bD.useEffect)(()=>{let{onDragMove:a}=T.current,{active:b,activatorEvent:c,collisions:d,over:e}=ae.current;if(!b||!c)return;let f={active:b,activatorEvent:c,collisions:d,delta:{x:at.x,y:at.y},over:e};(0,bW.unstable_batchedUpdates)(()=>{null==a||a(f),C({type:"onDragMove",event:f})})},[at.x,at.y]),(0,bD.useEffect)(()=>{let{active:a,activatorEvent:b,collisions:c,droppableContainers:d,scrollAdjustedTranslate:e}=ae.current;if(!a||null==O.current||!b||!e)return;let{onDragOver:f}=T.current,g=d.get(aw),h=g&&g.rect.current?{id:g.id,rect:g.rect.current,data:g.data,disabled:g.disabled}:null,i={active:a,activatorEvent:b,collisions:c,delta:{x:e.x,y:e.y},over:h};(0,bW.unstable_batchedUpdates)(()=>{ay(h),null==f||f(i),C({type:"onDragOver",event:i})})},[aw]),b2(()=>{ae.current={activatorEvent:R,active:N,activeNode:$,collisionRect:au,collisions:av,droppableRects:X,draggableNodes:I,draggingNode:ah,draggingNodeRect:ai,droppableContainers:K,over:ax,scrollableAncestors:am,scrollAdjustedTranslate:at},M.current={initial:ai,translated:au}},[N,$,av,au,I,ah,ai,X,K,ax,am,at]),function(a){let b,{acceleration:c,activator:d=aE.Pointer,canScroll:e,draggingRect:f,enabled:g,interval:h=5,order:i=aF.TreeOrder,pointerCoordinates:j,scrollableAncestors:k,scrollableAncestorRects:l,delta:m,threshold:n}=a,o=function(a){let{delta:b,disabled:c}=a,d=b7(b);return b5(a=>{if(c||!d||!a)return c$;let e={x:Math.sign(b.x-d.x),y:Math.sign(b.y-d.y)};return{x:{[aA.Backward]:a.x[aA.Backward]||-1===e.x,[aA.Forward]:a.x[aA.Forward]||1===e.x},y:{[aA.Backward]:a.y[aA.Backward]||-1===e.y,[aA.Forward]:a.y[aA.Forward]||1===e.y}}},[c,b,d])}({delta:m,disabled:!g}),[p,q]=(b=(0,bD.useRef)(null),[(0,bD.useCallback)((a,c)=>{b.current=setInterval(a,c)},[]),(0,bD.useCallback)(()=>{null!==b.current&&(clearInterval(b.current),b.current=null)},[])]),r=(0,bD.useRef)({x:0,y:0}),s=(0,bD.useRef)({x:0,y:0}),t=(0,bD.useMemo)(()=>{switch(d){case aE.Pointer:return j?{top:j.y,bottom:j.y,left:j.x,right:j.x}:null;case aE.DraggableRect:return f}},[d,f,j]),u=(0,bD.useRef)(null),v=(0,bD.useCallback)(()=>{let a=u.current;if(!a)return;let b=r.current.x*s.current.x,c=r.current.y*s.current.y;a.scrollBy(b,c)},[]),w=(0,bD.useMemo)(()=>i===aF.TreeOrder?[...k].reverse():k,[i,k]);(0,bD.useEffect)(()=>{if(!g||!k.length||!t)return void q();for(let a of w){if((null==e?void 0:e(a))===!1)continue;let b=l[k.indexOf(a)];if(!b)continue;let{direction:d,speed:f}=function(a,b,c,d,e){let{top:f,left:g,right:h,bottom:i}=c;void 0===d&&(d=10),void 0===e&&(e=cK);let{isTop:j,isBottom:k,isLeft:l,isRight:m}=cJ(a),n={x:0,y:0},o={x:0,y:0},p={height:b.height*e.y,width:b.width*e.x};return!j&&f<=b.top+p.height?(n.y=aA.Backward,o.y=d*Math.abs((b.top+p.height-f)/p.height)):!k&&i>=b.bottom-p.height&&(n.y=aA.Forward,o.y=d*Math.abs((b.bottom-p.height-i)/p.height)),!m&&h>=b.right-p.width?(n.x=aA.Forward,o.x=d*Math.abs((b.right-p.width-h)/p.width)):!l&&g<=b.left+p.width&&(n.x=aA.Backward,o.x=d*Math.abs((b.left+p.width-g)/p.width)),{direction:n,speed:o}}(a,b,t,c,n);for(let a of["x","y"])o[a][d[a]]||(f[a]=0,d[a]=0);if(f.x>0||f.y>0){q(),u.current=a,p(v,h),r.current=f,s.current=d;return}}r.current={x:0,y:0},s.current={x:0,y:0},q()},[c,v,e,q,g,h,JSON.stringify(t),JSON.stringify(o),p,k,w,l,JSON.stringify(n)])}({...aa,delta:J,draggingRect:au,pointerCoordinates:ap,scrollableAncestors:am,scrollableAncestorRects:an});let aK=(0,bD.useMemo)(()=>({active:N,activeNode:$,activeNodeRect:ac,activatorEvent:R,collisions:av,containerNodeRect:ad,dragOverlay:ag,draggableNodes:I,droppableContainers:K,droppableRects:X,over:ax,measureDroppableContainers:Y,scrollableAncestors:am,scrollableAncestorRects:an,measuringConfiguration:W,measuringScheduled:Z,windowRect:al}),[N,$,ac,R,av,ad,ag,I,K,X,ax,Y,am,an,W,Z,al]),aL=(0,bD.useMemo)(()=>({activatorEvent:R,activators:aJ,active:N,activeNodeRect:ac,ariaDescribedById:{draggable:U},dispatch:B,draggableNodes:I,over:ax,measureDroppableContainers:Y}),[R,aJ,N,ac,B,U,I,ax,Y]);return bD.default.createElement(ck.Provider,{value:D},bD.default.createElement(de.Provider,{value:aL},bD.default.createElement(df.Provider,{value:aK},bD.default.createElement(dj.Provider,{value:aB},u)),bD.default.createElement(di,{disabled:(null==s?void 0:s.restoreFocus)===!1})),bD.default.createElement(cn,{...s,hiddenTextDescribedById:U}))}),dl=(0,bD.createContext)(null),dm="button",dn={timeout:25},dp={position:"fixed",touchAction:"none"},dq=a=>cd(a)?"transform 250ms ease":void 0;function dr(a,b,c){let d=a.slice();return d.splice(c<0?d.length+c:c,0,d.splice(b,1)[0]),d}function ds(a){return null!==a&&a>=0}(a,b)=>{let{as:c,activatorEvent:d,adjustScale:e,children:f,className:g,rect:h,style:i,transform:j,transition:k=dq}=a;if(!h)return null;let l=e?j:{...j,scaleX:1,scaleY:1},m={...dp,width:h.width,height:h.height,top:h.top,left:h.left,transform:cf.Transform.toString(l),transformOrigin:e&&d?function(a,b){let c=ce(a);if(!c)return"0 0";let d={x:(c.x-b.left)/b.width*100,y:(c.y-b.top)/b.height*100};return d.x+"% "+d.y+"%"}(d,h):void 0,transition:"function"==typeof k?k(d):k,...i};return bD.default.createElement(c,{className:g,style:m,ref:b},f)},f={styles:{active:{opacity:"0"}}};let dt=a=>{let{rects:b,activeIndex:c,overIndex:d,index:e}=a,f=dr(b,d,c),g=b[e],h=f[e];return h&&g?{x:h.left-g.left,y:h.top-g.top,scaleX:h.width/g.width,scaleY:h.height/g.height}:null},du="Sortable",dv=bD.default.createContext({activeIndex:-1,containerId:du,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:dt,disabled:{draggable:!1,droppable:!1}});function dw(a){let{children:b,id:c,items:d,strategy:e=dt,disabled:f=!1}=a,{active:g,dragOverlay:h,droppableRects:i,over:j,measureDroppableContainers:k}=(0,bD.useContext)(df),l=b9(du,c),m=null!==h.rect,n=(0,bD.useMemo)(()=>d.map(a=>"object"==typeof a&&"id"in a?a.id:a),[d]),o=null!=g,p=g?n.indexOf(g.id):-1,q=j?n.indexOf(j.id):-1,r=(0,bD.useRef)(n),s=!function(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}(n,r.current),t=-1!==q&&-1===p||s,u="boolean"==typeof f?{draggable:f,droppable:f}:f;b2(()=>{s&&o&&k(n)},[s,n,o,k]),(0,bD.useEffect)(()=>{r.current=n},[n]);let v=(0,bD.useMemo)(()=>({activeIndex:p,containerId:l,disabled:u,disableTransforms:t,items:n,overIndex:q,useDragOverlay:m,sortedRects:n.reduce((a,b,c)=>{let d=i.get(b);return d&&(a[c]=d),a},Array(n.length)),strategy:e}),[p,l,u.draggable,u.droppable,t,n,q,i,m,e]);return bD.default.createElement(dv.Provider,{value:v},b)}let dx=a=>{let{id:b,items:c,activeIndex:d,overIndex:e}=a;return dr(c,d,e).indexOf(b)},dy=a=>{let{containerId:b,isSorting:c,wasDragging:d,index:e,items:f,newIndex:g,previousItems:h,previousContainerId:i,transition:j}=a;return!!j&&!!d&&(h===f||e!==g)&&(!!c||g!==e&&b===i)},dz={duration:200,easing:"ease"},dA="transform",dB=cf.Transition.toString({property:dA,duration:0,easing:"linear"}),dC={roleDescription:"sortable"};function dD(a){if(!a)return!1;let b=a.data.current;return!!b&&"sortable"in b&&"object"==typeof b.sortable&&"containerId"in b.sortable&&"items"in b.sortable&&"index"in b.sortable}let dE=[aC.Down,aC.Right,aC.Up,aC.Left],dF=(a,b)=>{let{context:{active:c,collisionRect:d,droppableRects:e,droppableContainers:f,over:g,scrollableAncestors:h}}=b;if(dE.includes(a.code)){if(a.preventDefault(),!c||!d)return;let b=[];f.getEnabled().forEach(c=>{if(!c||null!=c&&c.disabled)return;let f=e.get(c.id);if(f)switch(a.code){case aC.Down:d.top<f.top&&b.push(c);break;case aC.Up:d.top>f.top&&b.push(c);break;case aC.Left:d.left>f.left&&b.push(c);break;case aC.Right:d.left<f.left&&b.push(c)}});let k=(a=>{let{collisionRect:b,droppableRects:c,droppableContainers:d}=a,e=cu(b),f=[];for(let a of d){let{id:b}=a,d=c.get(b);if(d){let c=cu(d),g=Number((e.reduce((a,b,d)=>a+cr(c[d],b),0)/4).toFixed(4));f.push({id:b,data:{droppableContainer:a,value:g}})}}return f.sort(cs)})({active:c,collisionRect:d,droppableRects:e,droppableContainers:b,pointerCoordinates:null}),l=cv(k,"id");if(l===(null==g?void 0:g.id)&&k.length>1&&(l=k[1].id),null!=l){let a=f.get(c.id),b=f.get(l),g=b?e.get(b.id):null,k=null==b?void 0:b.node.current;if(k&&g&&a&&b){var i,j;let c=cE(k).some((a,b)=>h[b]!==a),e=dG(a,b),f=(i=a,j=b,!!dD(i)&&!!dD(j)&&!!dG(i,j)&&i.data.current.sortable.index<j.data.current.sortable.index),l=c||!e?{x:0,y:0}:{x:f?d.width-g.width:0,y:f?d.height-g.height:0},m={x:g.left,y:g.top};return l.x&&l.y?m:cc(m,l)}}}};function dG(a,b){return!!dD(a)&&!!dD(b)&&a.data.current.sortable.containerId===b.data.current.sortable.containerId}function dH(a){return null!==a&&"object"==typeof a&&"function"==typeof a.start}let dI=a=>Array.isArray(a);function dJ(a,b){if(!Array.isArray(b))return!1;let c=b.length;if(c!==a.length)return!1;for(let d=0;d<c;d++)if(b[d]!==a[d])return!1;return!0}function dK(a){return"string"==typeof a||Array.isArray(a)}function dL(a){let b=[{},{}];return null==a||a.values.forEach((a,c)=>{b[0][c]=a.get(),b[1][c]=a.getVelocity()}),b}function dM(a,b,c,d){if("function"==typeof b){let[e,f]=dL(d);b=b(void 0!==c?c:a.custom,e,f)}if("string"==typeof b&&(b=a.variants&&a.variants[b]),"function"==typeof b){let[e,f]=dL(d);b=b(void 0!==c?c:a.custom,e,f)}return b}function dN(a,b,c){let d=a.getProps();return dM(d,b,void 0!==c?c:d.custom,a)}let dO=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dP=["initial",...dO],dQ=a=>a;function dR(a){let b;return()=>(void 0===b&&(b=a()),b)}let dS=(a,b,c)=>{let d=b-a;return 0===d?1:(c-a)/d},dT=a=>1e3*a,dU=dR(()=>void 0!==window.ScrollTimeline);class dV{constructor(a){this.stop=()=>this.runAll("stop"),this.animations=a.filter(Boolean)}get finished(){return Promise.all(this.animations.map(a=>"finished"in a?a.finished:a))}getAll(a){return this.animations[0][a]}setAll(a,b){for(let c=0;c<this.animations.length;c++)this.animations[c][a]=b}attachTimeline(a,b){let c=this.animations.map(c=>dU()&&c.attachTimeline?c.attachTimeline(a):"function"==typeof b?b(c):void 0);return()=>{c.forEach((a,b)=>{a&&a(),this.animations[b].stop()})}}get time(){return this.getAll("time")}set time(a){this.setAll("time",a)}get speed(){return this.getAll("speed")}set speed(a){this.setAll("speed",a)}get startTime(){return this.getAll("startTime")}get duration(){let a=0;for(let b=0;b<this.animations.length;b++)a=Math.max(a,this.animations[b].duration);return a}runAll(a){this.animations.forEach(b=>b[a]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class dW extends dV{then(a,b){return Promise.all(this.animations).then(a).catch(b)}}function dX(a,b){return a?a[b]||a.default||a:void 0}function dY(a){let b=0,c=a.next(b);for(;!c.done&&b<2e4;)b+=50,c=a.next(b);return b>=2e4?1/0:b}function dZ(a){return"function"==typeof a}function d$(a,b){a.timeline=b,a.onfinish=null}let d_=a=>Array.isArray(a)&&"number"==typeof a[0],d0,d1=(g=dR(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(a){return!1}return!0}),()=>{var a;return null!=(a=d0)?a:g()}),d2=(a,b,c=10)=>{let d="",e=Math.max(Math.round(b/c),2);for(let b=0;b<e;b++)d+=a(dS(0,e-1,b))+", ";return`linear(${d.substring(0,d.length-2)})`},d3=([a,b,c,d])=>`cubic-bezier(${a}, ${b}, ${c}, ${d})`,d4={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:d3([0,.65,.55,1]),circOut:d3([.55,0,1,.45]),backIn:d3([.31,.01,.66,-.59]),backOut:d3([.33,1.53,.69,.99])},d5={x:!1,y:!1};function d6(a,b){let c=function(a,b,c){if(a instanceof Element)return[a];if("string"==typeof a){let b=document.querySelectorAll(a);return b?Array.from(b):[]}return Array.from(a)}(a),d=new AbortController;return[c,{passive:!0,...b,signal:d.signal},()=>d.abort()]}function d7(a){return b=>{"touch"===b.pointerType||d5.x||d5.y||a(b)}}let d8=(a,b)=>!!b&&(a===b||d8(a,b.parentElement)),d9=a=>"mouse"===a.pointerType?"number"!=typeof a.button||a.button<=0:!1!==a.isPrimary,ea=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),eb=new WeakSet;function ec(a){return b=>{"Enter"===b.key&&a(b)}}function ed(a,b){a.dispatchEvent(new PointerEvent("pointer"+b,{isPrimary:!0,bubbles:!0}))}function ee(a){return d9(a)&&!(d5.x||d5.y)}let ef=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],eg=new Set(ef),eh=new Set(["width","height","top","left","right","bottom",...ef]),ei=a=>dI(a)?a[a.length-1]||0:a,ej=["read","resolveKeyframes","update","preRender","render","postRender"];function ek(a,b){let c=!1,d=!0,e={delta:0,timestamp:0,isProcessing:!1},f=()=>c=!0,g=ej.reduce((a,b)=>(a[b]=function(a){let b=new Set,c=new Set,d=!1,e=!1,f=new WeakSet,g={delta:0,timestamp:0,isProcessing:!1};function h(b){f.has(b)&&(i.schedule(b),a()),b(g)}let i={schedule:(a,e=!1,g=!1)=>{let h=g&&d?b:c;return e&&f.add(a),h.has(a)||h.add(a),a},cancel:a=>{c.delete(a),f.delete(a)},process:a=>{if(g=a,d){e=!0;return}d=!0,[b,c]=[c,b],b.forEach(h),b.clear(),d=!1,e&&(e=!1,i.process(a))}};return i}(f),a),{}),{read:h,resolveKeyframes:i,update:j,preRender:k,render:l,postRender:m}=g,n=()=>{let f=performance.now();c=!1,e.delta=d?1e3/60:Math.max(Math.min(f-e.timestamp,40),1),e.timestamp=f,e.isProcessing=!0,h.process(e),i.process(e),j.process(e),k.process(e),l.process(e),m.process(e),e.isProcessing=!1,c&&b&&(d=!1,a(n))};return{schedule:ej.reduce((b,f)=>{let h=g[f];return b[f]=(b,f=!1,g=!1)=>(!c&&(c=!0,d=!0,e.isProcessing||a(n)),h.schedule(b,f,g)),b},{}),cancel:a=>{for(let b=0;b<ej.length;b++)g[ej[b]].cancel(a)},state:e,steps:g}}let{schedule:el,cancel:em,state:en,steps:eo}=ek("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:dQ,!0);function ep(){b=void 0}let eq={now:()=>(void 0===b&&eq.set(en.isProcessing?en.timestamp:performance.now()),b),set:a=>{b=a,queueMicrotask(ep)}};function er(a,b){-1===a.indexOf(b)&&a.push(b)}function es(a,b){let c=a.indexOf(b);c>-1&&a.splice(c,1)}class et{constructor(){this.subscriptions=[]}add(a){return er(this.subscriptions,a),()=>es(this.subscriptions,a)}notify(a,b,c){let d=this.subscriptions.length;if(d)if(1===d)this.subscriptions[0](a,b,c);else for(let e=0;e<d;e++){let d=this.subscriptions[e];d&&d(a,b,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}class eu{constructor(a,b={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(a,b=!0)=>{let c=eq.now();this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),b&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(a),this.owner=b.owner}setCurrent(a){this.current=a,this.updatedAt=eq.now(),null===this.canTrackVelocity&&void 0!==a&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(a=this.current){this.prevFrameValue=a,this.prevUpdatedAt=this.updatedAt}onChange(a){return this.on("change",a)}on(a,b){this.events[a]||(this.events[a]=new et);let c=this.events[a].add(b);return"change"===a?()=>{c(),el.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(let a in this.events)this.events[a].clear()}attach(a,b){this.passiveEffect=a,this.stopPassiveEffect=b}set(a,b=!0){b&&this.passiveEffect?this.passiveEffect(a,this.updateAndNotify):this.updateAndNotify(a,b)}setWithVelocity(a,b,c){this.set(b),this.prev=void 0,this.prevFrameValue=a,this.prevUpdatedAt=this.updatedAt-c}jump(a,b=!0){this.updateAndNotify(a),this.prev=a,this.prevUpdatedAt=this.prevFrameValue=void 0,b&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return j&&j.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var a;let b=eq.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||b-this.updatedAt>30)return 0;let c=Math.min(this.updatedAt-this.prevUpdatedAt,30);return a=parseFloat(this.current)-parseFloat(this.prevFrameValue),c?1e3/c*a:0}start(a){return this.stop(),new Promise(b=>{this.hasAnimated=!0,this.animation=a(b),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ev(a,b){return new eu(a,b)}let ew=a=>!!(a&&a.getVelocity);function ex(a,b){let c=a.getValue("willChange");if(ew(c)&&c.add)return c.add(b)}let ey=a=>a.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ez="data-"+ey("framerAppearId"),eA=(a,b,c)=>(((1-3*c+3*b)*a+(3*c-6*b))*a+3*b)*a;function eB(a,b,c,d){return a===b&&c===d?dQ:e=>0===e||1===e?e:eA(function(a,b,c,d,e){let f,g,h=0;do(f=eA(g=b+(c-b)/2,d,e)-a)>0?c=g:b=g;while(Math.abs(f)>1e-7&&++h<12)return g}(e,0,1,a,c),b,d)}let eC=a=>b=>b<=.5?a(2*b)/2:(2-a(2*(1-b)))/2,eD=a=>b=>1-a(1-b),eE=eB(.33,1.53,.69,.99),eF=eD(eE),eG=eC(eF),eH=a=>(a*=2)<1?.5*eF(a):.5*(2-Math.pow(2,-10*(a-1))),eI=a=>1-Math.sin(Math.acos(a)),eJ=eD(eI),eK=eC(eI),eL=(a,b,c)=>c>b?b:c<a?a:c,eM={test:a=>"number"==typeof a,parse:parseFloat,transform:a=>a},eN={...eM,transform:a=>eL(0,1,a)},eO={...eM,default:1},eP=a=>Math.round(1e5*a)/1e5,eQ=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,eR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,eS=(a,b)=>c=>!!("string"==typeof c&&eR.test(c)&&c.startsWith(a)||b&&null!=c&&Object.prototype.hasOwnProperty.call(c,b)),eT=(a,b,c)=>d=>{if("string"!=typeof d)return d;let[e,f,g,h]=d.match(eQ);return{[a]:parseFloat(e),[b]:parseFloat(f),[c]:parseFloat(g),alpha:void 0!==h?parseFloat(h):1}},eU={...eM,transform:a=>Math.round(eL(0,255,a))},eV={test:eS("rgb","red"),parse:eT("red","green","blue"),transform:({red:a,green:b,blue:c,alpha:d=1})=>"rgba("+eU.transform(a)+", "+eU.transform(b)+", "+eU.transform(c)+", "+eP(eN.transform(d))+")"},eW={test:eS("#"),parse:function(a){let b="",c="",d="",e="";return a.length>5?(b=a.substring(1,3),c=a.substring(3,5),d=a.substring(5,7),e=a.substring(7,9)):(b=a.substring(1,2),c=a.substring(2,3),d=a.substring(3,4),e=a.substring(4,5),b+=b,c+=c,d+=d,e+=e),{red:parseInt(b,16),green:parseInt(c,16),blue:parseInt(d,16),alpha:e?parseInt(e,16)/255:1}},transform:eV.transform},eX=a=>({test:b=>"string"==typeof b&&b.endsWith(a)&&1===b.split(" ").length,parse:parseFloat,transform:b=>`${b}${a}`}),eY=eX("deg"),eZ=eX("%"),e$=eX("px"),e_=eX("vh"),e0=eX("vw"),e1={...eZ,parse:a=>eZ.parse(a)/100,transform:a=>eZ.transform(100*a)},e2={test:eS("hsl","hue"),parse:eT("hue","saturation","lightness"),transform:({hue:a,saturation:b,lightness:c,alpha:d=1})=>"hsla("+Math.round(a)+", "+eZ.transform(eP(b))+", "+eZ.transform(eP(c))+", "+eP(eN.transform(d))+")"},e3={test:a=>eV.test(a)||eW.test(a)||e2.test(a),parse:a=>eV.test(a)?eV.parse(a):e2.test(a)?e2.parse(a):eW.parse(a),transform:a=>"string"==typeof a?a:a.hasOwnProperty("red")?eV.transform(a):e2.transform(a)},e4=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,e5="number",e6="color",e7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function e8(a){let b=a.toString(),c=[],d={color:[],number:[],var:[]},e=[],f=0,g=b.replace(e7,a=>(e3.test(a)?(d.color.push(f),e.push(e6),c.push(e3.parse(a))):a.startsWith("var(")?(d.var.push(f),e.push("var"),c.push(a)):(d.number.push(f),e.push(e5),c.push(parseFloat(a))),++f,"${}")).split("${}");return{values:c,split:g,indexes:d,types:e}}function e9(a){return e8(a).values}function fa(a){let{split:b,types:c}=e8(a),d=b.length;return a=>{let e="";for(let f=0;f<d;f++)if(e+=b[f],void 0!==a[f]){let b=c[f];b===e5?e+=eP(a[f]):b===e6?e+=e3.transform(a[f]):e+=a[f]}return e}}let fb=a=>"number"==typeof a?0:a,fc={test:function(a){var b,c;return isNaN(a)&&"string"==typeof a&&((null==(b=a.match(eQ))?void 0:b.length)||0)+((null==(c=a.match(e4))?void 0:c.length)||0)>0},parse:e9,createTransformer:fa,getAnimatableNone:function(a){let b=e9(a);return fa(a)(b.map(fb))}},fd=new Set(["brightness","contrast","saturate","opacity"]);function fe(a){let[b,c]=a.slice(0,-1).split("(");if("drop-shadow"===b)return a;let[d]=c.match(eQ)||[];if(!d)return a;let e=c.replace(d,""),f=+!!fd.has(b);return d!==c&&(f*=100),b+"("+f+e+")"}let ff=/\b([a-z-]*)\(.*?\)/gu,fg={...fc,getAnimatableNone:a=>{let b=a.match(ff);return b?b.map(fe).join(" "):a}},fh={...eM,transform:Math.round},fi={borderWidth:e$,borderTopWidth:e$,borderRightWidth:e$,borderBottomWidth:e$,borderLeftWidth:e$,borderRadius:e$,radius:e$,borderTopLeftRadius:e$,borderTopRightRadius:e$,borderBottomRightRadius:e$,borderBottomLeftRadius:e$,width:e$,maxWidth:e$,height:e$,maxHeight:e$,top:e$,right:e$,bottom:e$,left:e$,padding:e$,paddingTop:e$,paddingRight:e$,paddingBottom:e$,paddingLeft:e$,margin:e$,marginTop:e$,marginRight:e$,marginBottom:e$,marginLeft:e$,backgroundPositionX:e$,backgroundPositionY:e$,rotate:eY,rotateX:eY,rotateY:eY,rotateZ:eY,scale:eO,scaleX:eO,scaleY:eO,scaleZ:eO,skew:eY,skewX:eY,skewY:eY,distance:e$,translateX:e$,translateY:e$,translateZ:e$,x:e$,y:e$,z:e$,perspective:e$,transformPerspective:e$,opacity:eN,originX:e1,originY:e1,originZ:e$,zIndex:fh,size:e$,fillOpacity:eN,strokeOpacity:eN,numOctaves:fh},fj={...fi,color:e3,backgroundColor:e3,outlineColor:e3,fill:e3,stroke:e3,borderColor:e3,borderTopColor:e3,borderRightColor:e3,borderBottomColor:e3,borderLeftColor:e3,filter:fg,WebkitFilter:fg},fk=a=>fj[a];function fl(a,b){let c=fk(a);return c!==fg&&(c=fc),c.getAnimatableNone?c.getAnimatableNone(b):void 0}let fm=new Set(["auto","none","0"]),fn=a=>a===eM||a===e$,fo=(a,b)=>parseFloat(a.split(", ")[b]),fp=(a,b)=>(c,{transform:d})=>{if("none"===d||!d)return 0;let e=d.match(/^matrix3d\((.+)\)$/u);if(e)return fo(e[1],b);{let b=d.match(/^matrix\((.+)\)$/u);return b?fo(b[1],a):0}},fq=new Set(["x","y","z"]),fr=ef.filter(a=>!fq.has(a)),fs={width:({x:a},{paddingLeft:b="0",paddingRight:c="0"})=>a.max-a.min-parseFloat(b)-parseFloat(c),height:({y:a},{paddingTop:b="0",paddingBottom:c="0"})=>a.max-a.min-parseFloat(b)-parseFloat(c),top:(a,{top:b})=>parseFloat(b),left:(a,{left:b})=>parseFloat(b),bottom:({y:a},{top:b})=>parseFloat(b)+(a.max-a.min),right:({x:a},{left:b})=>parseFloat(b)+(a.max-a.min),x:fp(4,13),y:fp(5,14)};fs.translateX=fs.x,fs.translateY=fs.y;let ft=new Set,fu=!1,fv=!1;function fw(){if(fv){let a=Array.from(ft).filter(a=>a.needsMeasurement),b=new Set(a.map(a=>a.element)),c=new Map;b.forEach(a=>{let b,d=(b=[],fr.forEach(c=>{let d=a.getValue(c);void 0!==d&&(b.push([c,d.get()]),d.set(+!!c.startsWith("scale")))}),b);d.length&&(c.set(a,d),a.render())}),a.forEach(a=>a.measureInitialState()),b.forEach(a=>{a.render();let b=c.get(a);b&&b.forEach(([b,c])=>{var d;null==(d=a.getValue(b))||d.set(c)})}),a.forEach(a=>a.measureEndState()),a.forEach(a=>{void 0!==a.suspendedScrollY&&window.scrollTo(0,a.suspendedScrollY)})}fv=!1,fu=!1,ft.forEach(a=>a.complete()),ft.clear()}function fx(){ft.forEach(a=>{a.readKeyframes(),a.needsMeasurement&&(fv=!0)})}class fy{constructor(a,b,c,d,e,f=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...a],this.onComplete=b,this.name=c,this.motionValue=d,this.element=e,this.isAsync=f}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ft.add(this),fu||(fu=!0,el.read(fx),el.resolveKeyframes(fw))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:a,name:b,element:c,motionValue:d}=this;for(let e=0;e<a.length;e++)if(null===a[e])if(0===e){let e=null==d?void 0:d.get(),f=a[a.length-1];if(void 0!==e)a[0]=e;else if(c&&b){let d=c.readValue(b,f);null!=d&&(a[0]=d)}void 0===a[0]&&(a[0]=f),d&&void 0===e&&d.set(a[0])}else a[e]=a[e-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ft.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ft.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}let fz=a=>b=>"string"==typeof b&&b.startsWith(a),fA=fz("--"),fB=fz("var(--"),fC=a=>!!fB(a)&&fD.test(a.split("/*")[0].trim()),fD=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,fE=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,fF=a=>b=>b.test(a),fG=[eM,e$,eZ,eY,e0,e_,{test:a=>"auto"===a,parse:a=>a}],fH=a=>fG.find(fF(a));class fI extends fy{constructor(a,b,c,d,e){super(a,b,c,d,e,!0)}readKeyframes(){let{unresolvedKeyframes:a,element:b,name:c}=this;if(!b||!b.current)return;super.readKeyframes();for(let c=0;c<a.length;c++){let d=a[c];if("string"==typeof d&&fC(d=d.trim())){let e=function a(b,c,d=1){dQ(d<=4,`Max CSS variable fallback depth detected in property "${b}". This may indicate a circular fallback dependency.`);let[e,f]=function(a){let b=fE.exec(a);if(!b)return[,];let[,c,d,e]=b;return[`--${null!=c?c:d}`,e]}(b);if(!e)return;let g=window.getComputedStyle(c).getPropertyValue(e);if(g){let a=g.trim();return/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(a)?parseFloat(a):a}return fC(f)?a(f,c,d+1):f}(d,b.current);void 0!==e&&(a[c]=e),c===a.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!eh.has(c)||2!==a.length)return;let[d,e]=a,f=fH(d),g=fH(e);if(f!==g)if(fn(f)&&fn(g))for(let b=0;b<a.length;b++){let c=a[b];"string"==typeof c&&(a[b]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){let{unresolvedKeyframes:a,name:b}=this,c=[];for(let b=0;b<a.length;b++)(function(a){if("number"==typeof a)return 0===a;if(null===a)return!0;return"none"===a||"0"===a||/^0[^.\s]+$/u.test(a)})(a[b])&&c.push(b);c.length&&function(a,b,c){let d,e=0;for(;e<a.length&&!d;){let b=a[e];"string"==typeof b&&!fm.has(b)&&e8(b).values.length&&(d=a[e]),e++}if(d&&c)for(let e of b)a[e]=fl(c,d)}(a,c,b)}measureInitialState(){let{element:a,unresolvedKeyframes:b,name:c}=this;if(!a||!a.current)return;"height"===c&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fs[c](a.measureViewportBox(),window.getComputedStyle(a.current)),b[0]=this.measuredOrigin;let d=b[b.length-1];void 0!==d&&a.getValue(c,d).jump(d,!1)}measureEndState(){var a;let{element:b,name:c,unresolvedKeyframes:d}=this;if(!b||!b.current)return;let e=b.getValue(c);e&&e.jump(this.measuredOrigin,!1);let f=d.length-1,g=d[f];d[f]=fs[c](b.measureViewportBox(),window.getComputedStyle(b.current)),null!==g&&void 0===this.finalKeyframe&&(this.finalKeyframe=g),(null==(a=this.removedTransforms)?void 0:a.length)&&this.removedTransforms.forEach(([a,c])=>{b.getValue(a).set(c)}),this.resolveNoneKeyframes()}}let fJ=(a,b)=>"zIndex"!==b&&!!("number"==typeof a||Array.isArray(a)||"string"==typeof a&&(fc.test(a)||"0"===a)&&!a.startsWith("url(")),fK=a=>null!==a;function fL(a,{repeat:b,repeatType:c="loop"},d){let e=a.filter(fK),f=b&&"loop"!==c&&b%2==1?0:e.length-1;return f&&void 0!==d?d:e[f]}class fM{constructor({autoplay:a=!0,delay:b=0,type:c="keyframes",repeat:d=0,repeatDelay:e=0,repeatType:f="loop",...g}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=eq.now(),this.options={autoplay:a,delay:b,type:c,repeat:d,repeatDelay:e,repeatType:f,...g},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(fx(),fw()),this._resolved}onKeyframesResolved(a,b){this.resolvedAt=eq.now(),this.hasAttemptedResolve=!0;let{name:c,type:d,velocity:e,delay:f,onComplete:g,onUpdate:h,isGenerator:i}=this.options;if(!i&&!function(a,b,c,d){let e=a[0];if(null===e)return!1;if("display"===b||"visibility"===b)return!0;let f=a[a.length-1],g=fJ(e,b),h=fJ(f,b);return dQ(g===h,`You are trying to animate ${b} from "${e}" to "${f}". ${e} is not an animatable value - to enable this animation set ${e} to a value animatable to ${f} via the \`style\` property.`),!!g&&!!h&&(function(a){let b=a[0];if(1===a.length)return!0;for(let c=0;c<a.length;c++)if(a[c]!==b)return!0}(a)||("spring"===c||dZ(c))&&d)}(a,c,d,e))if(f)this.options.duration=0;else{h&&h(fL(a,this.options,b)),g&&g(),this.resolveFinishedPromise();return}let j=this.initPlayback(a,b);!1!==j&&(this._resolved={keyframes:a,finalKeyframe:b,...j},this.onPostResolved())}onPostResolved(){}then(a,b){return this.currentFinishedPromise.then(a,b)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(a=>{this.resolveFinishedPromise=a})}}let fN=(a,b,c)=>a+(b-a)*c;function fO(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}function fP(a,b){return c=>c>0?b:a}let fQ=(a,b,c)=>{let d=a*a,e=c*(b*b-d)+d;return e<0?0:Math.sqrt(e)},fR=[eW,eV,e2];function fS(a){let b=fR.find(b=>b.test(a));if(dQ(!!b,`'${a}' is not an animatable color. Use the equivalent color code instead.`),!b)return!1;let c=b.parse(a);return b===e2&&(c=function({hue:a,saturation:b,lightness:c,alpha:d}){a/=360,c/=100;let e=0,f=0,g=0;if(b/=100){let d=c<.5?c*(1+b):c+b-c*b,h=2*c-d;e=fO(h,d,a+1/3),f=fO(h,d,a),g=fO(h,d,a-1/3)}else e=f=g=c;return{red:Math.round(255*e),green:Math.round(255*f),blue:Math.round(255*g),alpha:d}}(c)),c}let fT=(a,b)=>{let c=fS(a),d=fS(b);if(!c||!d)return fP(a,b);let e={...c};return a=>(e.red=fQ(c.red,d.red,a),e.green=fQ(c.green,d.green,a),e.blue=fQ(c.blue,d.blue,a),e.alpha=fN(c.alpha,d.alpha,a),eV.transform(e))},fU=(a,b)=>c=>b(a(c)),fV=(...a)=>a.reduce(fU),fW=new Set(["none","hidden"]);function fX(a,b){return c=>fN(a,b,c)}function fY(a){return"number"==typeof a?fX:"string"==typeof a?fC(a)?fP:e3.test(a)?fT:f_:Array.isArray(a)?fZ:"object"==typeof a?e3.test(a)?fT:f$:fP}function fZ(a,b){let c=[...a],d=c.length,e=a.map((a,c)=>fY(a)(a,b[c]));return a=>{for(let b=0;b<d;b++)c[b]=e[b](a);return c}}function f$(a,b){let c={...a,...b},d={};for(let e in c)void 0!==a[e]&&void 0!==b[e]&&(d[e]=fY(a[e])(a[e],b[e]));return a=>{for(let b in d)c[b]=d[b](a);return c}}let f_=(a,b)=>{let c=fc.createTransformer(b),d=e8(a),e=e8(b);if(!(d.indexes.var.length===e.indexes.var.length&&d.indexes.color.length===e.indexes.color.length&&d.indexes.number.length>=e.indexes.number.length))return dQ(!0,`Complex values '${a}' and '${b}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),fP(a,b);if(fW.has(a)&&!e.values.length||fW.has(b)&&!d.values.length)return fW.has(a)?c=>c<=0?a:b:c=>c>=1?b:a;return fV(fZ(function(a,b){var c;let d=[],e={color:0,var:0,number:0};for(let f=0;f<b.values.length;f++){let g=b.types[f],h=a.indexes[g][e[g]],i=null!=(c=a.values[h])?c:0;d[f]=i,e[g]++}return d}(d,e),e.values),c)};function f0(a,b,c){return"number"==typeof a&&"number"==typeof b&&"number"==typeof c?fN(a,b,c):fY(a)(a,b)}function f1(a,b,c){var d,e;let f=Math.max(b-5,0);return d=c-a(f),(e=b-f)?1e3/e*d:0}let f2=.01,f3=2,f4=.005,f5=.5;function f6(a,b){return a*Math.sqrt(1-b*b)}let f7=["duration","bounce"],f8=["stiffness","damping","mass"];function f9(a,b){return b.some(b=>void 0!==a[b])}function ga(a=.3,b=.3){let c,d="object"!=typeof a?{visualDuration:a,keyframes:[0,1],bounce:b}:a,{restSpeed:e,restDelta:f}=d,g=d.keyframes[0],h=d.keyframes[d.keyframes.length-1],i={done:!1,value:g},{stiffness:j,damping:k,mass:l,duration:m,velocity:n,isResolvedFromDuration:o}=function(a){let b={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...a};if(!f9(a,f8)&&f9(a,f7))if(a.visualDuration){let c=2*Math.PI/(1.2*a.visualDuration),d=c*c,e=2*eL(.05,1,1-(a.bounce||0))*Math.sqrt(d);b={...b,mass:1,stiffness:d,damping:e}}else{let c=function({duration:a=800,bounce:b=.3,velocity:c=0,mass:d=1}){let e,f;dQ(a<=dT(10),"Spring duration must be 10 seconds or less");let g=1-b;g=eL(.05,1,g),a=eL(.01,10,a/1e3),g<1?(e=b=>{let d=b*g,e=d*a;return .001-(d-c)/f6(b,g)*Math.exp(-e)},f=b=>{let d=b*g*a,f=Math.pow(g,2)*Math.pow(b,2)*a,h=Math.exp(-d),i=f6(Math.pow(b,2),g);return(d*c+c-f)*h*(-e(b)+.001>0?-1:1)/i}):(e=b=>-.001+Math.exp(-b*a)*((b-c)*a+1),f=b=>a*a*(c-b)*Math.exp(-b*a));let h=function(a,b,c){let d=c;for(let c=1;c<12;c++)d-=a(d)/b(d);return d}(e,f,5/a);if(a=dT(a),isNaN(h))return{stiffness:100,damping:10,duration:a};{let b=Math.pow(h,2)*d;return{stiffness:b,damping:2*g*Math.sqrt(d*b),duration:a}}}(a);(b={...b,...c,mass:1}).isResolvedFromDuration=!0}return b}({...d,velocity:-((d.velocity||0)/1e3)}),p=n||0,q=k/(2*Math.sqrt(j*l)),r=h-g,s=Math.sqrt(j/l)/1e3,t=5>Math.abs(r);if(e||(e=t?f2:f3),f||(f=t?f4:f5),q<1){let a=f6(s,q);c=b=>h-Math.exp(-q*s*b)*((p+q*s*r)/a*Math.sin(a*b)+r*Math.cos(a*b))}else if(1===q)c=a=>h-Math.exp(-s*a)*(r+(p+s*r)*a);else{let a=s*Math.sqrt(q*q-1);c=b=>{let c=Math.exp(-q*s*b),d=Math.min(a*b,300);return h-c*((p+q*s*r)*Math.sinh(d)+a*r*Math.cosh(d))/a}}let u={calculatedDuration:o&&m||null,next:a=>{let b=c(a);if(o)i.done=a>=m;else{let d=0;q<1&&(d=0===a?dT(p):f1(c,a,b));let g=Math.abs(h-b)<=f;i.done=Math.abs(d)<=e&&g}return i.value=i.done?h:b,i},toString:()=>{let a=Math.min(dY(u),2e4),b=d2(b=>u.next(a*b).value,a,30);return a+"ms "+b}};return u}function gb({keyframes:a,velocity:b=0,power:c=.8,timeConstant:d=325,bounceDamping:e=10,bounceStiffness:f=500,modifyTarget:g,min:h,max:i,restDelta:j=.5,restSpeed:k}){let l,m,n=a[0],o={done:!1,value:n},p=c*b,q=n+p,r=void 0===g?q:g(q);r!==q&&(p=r-n);let s=a=>-p*Math.exp(-a/d),t=a=>r+s(a),u=a=>{let b=s(a),c=t(a);o.done=Math.abs(b)<=j,o.value=o.done?r:c},v=a=>{let b;if(b=o.value,void 0!==h&&b<h||void 0!==i&&b>i){var c;l=a,m=ga({keyframes:[o.value,(c=o.value,void 0===h?i:void 0===i||Math.abs(h-c)<Math.abs(i-c)?h:i)],velocity:f1(t,a,o.value),damping:e,stiffness:f,restDelta:j,restSpeed:k})}};return v(0),{calculatedDuration:null,next:a=>{let b=!1;return(m||void 0!==l||(b=!0,u(a),v(a)),void 0!==l&&a>=l)?m.next(a-l):(b||u(a),o)}}}let gc=eB(.42,0,1,1),gd=eB(0,0,.58,1),ge=eB(.42,0,.58,1),gf={linear:dQ,easeIn:gc,easeInOut:ge,easeOut:gd,circIn:eI,circInOut:eK,circOut:eJ,backIn:eF,backInOut:eG,backOut:eE,anticipate:eH},gg=a=>{if(d_(a)){dQ(4===a.length,"Cubic bezier arrays must contain four numerical values.");let[b,c,d,e]=a;return eB(b,c,d,e)}return"string"==typeof a?(dQ(void 0!==gf[a],`Invalid easing type '${a}'`),gf[a]):a};function gh({duration:a=300,keyframes:b,times:c,ease:d="easeInOut"}){var e;let f,g=Array.isArray(d)&&"number"!=typeof d[0]?d.map(gg):gg(d),h={done:!1,value:b[0]},i=function(a,b,{clamp:c=!0,ease:d,mixer:e}={}){let f=a.length;if(dQ(f===b.length,"Both input and output ranges must be the same length"),1===f)return()=>b[0];if(2===f&&b[0]===b[1])return()=>b[1];let g=a[0]===a[1];a[0]>a[f-1]&&(a=[...a].reverse(),b=[...b].reverse());let h=function(a,b,c){let d=[],e=c||f0,f=a.length-1;for(let c=0;c<f;c++){let f=e(a[c],a[c+1]);b&&(f=fV(Array.isArray(b)?b[c]||dQ:b,f)),d.push(f)}return d}(b,d,e),i=h.length,j=c=>{if(g&&c<a[0])return b[0];let d=0;if(i>1)for(;d<a.length-2&&!(c<a[d+1]);d++);let e=dS(a[d],a[d+1],c);return h[d](e)};return c?b=>j(eL(a[0],a[f-1],b)):j}((e=c&&c.length===b.length?c:(!function(a,b){let c=a[a.length-1];for(let d=1;d<=b;d++){let e=dS(0,b,d);a.push(fN(c,1,e))}}(f=[0],b.length-1),f),e.map(b=>b*a)),b,{ease:Array.isArray(g)?g:b.map(()=>g||ge).splice(0,b.length-1)});return{calculatedDuration:a,next:b=>(h.value=i(b),h.done=b>=a,h)}}let gi=a=>{let b=({timestamp:b})=>a(b);return{start:()=>el.update(b,!0),stop:()=>em(b),now:()=>en.isProcessing?en.timestamp:eq.now()}},gj={decay:gb,inertia:gb,tween:gh,keyframes:gh,spring:ga},gk=a=>a/100;class gl extends fM{constructor(a){super(a),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();let{onStop:a}=this.options;a&&a()};const{name:b,motionValue:c,element:d,keyframes:e}=this.options,f=(null==d?void 0:d.KeyframeResolver)||fy,g=(a,b)=>this.onKeyframesResolved(a,b);this.resolver=new f(e,g,b,c,d),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(a){let b,c,{type:d="keyframes",repeat:e=0,repeatDelay:f=0,repeatType:g,velocity:h=0}=this.options,i=dZ(d)?d:gj[d]||gh;i!==gh&&"number"!=typeof a[0]&&(b=fV(gk,f0(a[0],a[1])),a=[0,100]);let j=i({...this.options,keyframes:a});"mirror"===g&&(c=i({...this.options,keyframes:[...a].reverse(),velocity:-h})),null===j.calculatedDuration&&(j.calculatedDuration=dY(j));let{calculatedDuration:k}=j,l=k+f;return{generator:j,mirroredGenerator:c,mapPercentToKeyframes:b,calculatedDuration:k,resolvedDuration:l,totalDuration:l*(e+1)-f}}onPostResolved(){let{autoplay:a=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&a?this.state=this.pendingPlayState:this.pause()}tick(a,b=!1){let{resolved:c}=this;if(!c){let{keyframes:a}=this.options;return{done:!0,value:a[a.length-1]}}let{finalKeyframe:d,generator:e,mirroredGenerator:f,mapPercentToKeyframes:g,keyframes:h,calculatedDuration:i,totalDuration:j,resolvedDuration:k}=c;if(null===this.startTime)return e.next(0);let{delay:l,repeat:m,repeatType:n,repeatDelay:o,onUpdate:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,a):this.speed<0&&(this.startTime=Math.min(a-j/this.speed,this.startTime)),b?this.currentTime=a:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(a-this.startTime)*this.speed;let q=this.currentTime-l*(this.speed>=0?1:-1),r=this.speed>=0?q<0:q>j;this.currentTime=Math.max(q,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=j);let s=this.currentTime,t=e;if(m){let a=Math.min(this.currentTime,j)/k,b=Math.floor(a),c=a%1;!c&&a>=1&&(c=1),1===c&&b--,(b=Math.min(b,m+1))%2&&("reverse"===n?(c=1-c,o&&(c-=o/k)):"mirror"===n&&(t=f)),s=eL(0,1,c)*k}let u=r?{done:!1,value:h[0]}:t.next(s);g&&(u.value=g(u.value));let{done:v}=u;r||null===i||(v=this.speed>=0?this.currentTime>=j:this.currentTime<=0);let w=null===this.holdTime&&("finished"===this.state||"running"===this.state&&v);return w&&void 0!==d&&(u.value=fL(h,this.options,d)),p&&p(u.value),w&&this.finish(),u}get duration(){let{resolved:a}=this;return a?a.calculatedDuration/1e3:0}get time(){return this.currentTime/1e3}set time(a){a=dT(a),this.currentTime=a,null!==this.holdTime||0===this.speed?this.holdTime=a:this.driver&&(this.startTime=this.driver.now()-a/this.speed)}get speed(){return this.playbackSpeed}set speed(a){let b=this.playbackSpeed!==a;this.playbackSpeed=a,b&&(this.time=this.currentTime/1e3)}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;let{driver:a=gi,onPlay:b,startTime:c}=this.options;this.driver||(this.driver=a(a=>this.tick(a))),b&&b();let d=this.driver.now();null!==this.holdTime?this.startTime=d-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=d):this.startTime=null!=c?c:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var a;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=null!=(a=this.currentTime)?a:0}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";let{onComplete:a}=this.options;a&&a()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(a){return this.startTime=0,this.tick(a,!0)}}let gm=new Set(["opacity","clipPath","filter","transform"]),gn=dR(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),go={anticipate:eH,backInOut:eG,circInOut:eK};class gp extends fM{constructor(a){super(a);const{name:b,motionValue:c,element:d,keyframes:e}=this.options;this.resolver=new fI(e,(a,b)=>this.onKeyframesResolved(a,b),b,c,d),this.resolver.scheduleResolve()}initPlayback(a,b){var c;let{duration:d=300,times:e,ease:f,type:g,motionValue:h,name:i,startTime:j}=this.options;if(!h.owner||!h.owner.current)return!1;if("string"==typeof f&&d1()&&f in go&&(f=go[f]),dZ((c=this.options).type)||"spring"===c.type||!function a(b){return!!("function"==typeof b&&d1()||!b||"string"==typeof b&&(b in d4||d1())||d_(b)||Array.isArray(b)&&b.every(a))}(c.ease)){let{onComplete:b,onUpdate:c,motionValue:h,element:i,...j}=this.options,k=function(a,b){let c=new gl({...b,keyframes:a,repeat:0,delay:0,isGenerator:!0}),d={done:!1,value:a[0]},e=[],f=0;for(;!d.done&&f<2e4;)e.push((d=c.sample(f)).value),f+=10;return{times:void 0,keyframes:e,duration:f-10,ease:"linear"}}(a,j);1===(a=k.keyframes).length&&(a[1]=a[0]),d=k.duration,e=k.times,f=k.ease,g="keyframes"}let k=function(a,b,c,{delay:d=0,duration:e=300,repeat:f=0,repeatType:g="loop",ease:h="easeInOut",times:i}={}){let j={[b]:c};i&&(j.offset=i);let k=function a(b,c){if(b)return"function"==typeof b&&d1()?d2(b,c):d_(b)?d3(b):Array.isArray(b)?b.map(b=>a(b,c)||d4.easeOut):d4[b]}(h,e);return Array.isArray(k)&&(j.easing=k),a.animate(j,{delay:d,duration:e,easing:Array.isArray(k)?"linear":k,fill:"both",iterations:f+1,direction:"reverse"===g?"alternate":"normal"})}(h.owner.current,i,a,{...this.options,duration:d,times:e,ease:f});return k.startTime=null!=j?j:this.calcStartTime(),this.pendingTimeline?(d$(k,this.pendingTimeline),this.pendingTimeline=void 0):k.onfinish=()=>{let{onComplete:c}=this.options;h.set(fL(a,this.options,b)),c&&c(),this.cancel(),this.resolveFinishedPromise()},{animation:k,duration:d,times:e,type:g,ease:f,keyframes:a}}get duration(){let{resolved:a}=this;if(!a)return 0;let{duration:b}=a;return b/1e3}get time(){let{resolved:a}=this;if(!a)return 0;let{animation:b}=a;return(b.currentTime||0)/1e3}set time(a){let{resolved:b}=this;if(!b)return;let{animation:c}=b;c.currentTime=dT(a)}get speed(){let{resolved:a}=this;if(!a)return 1;let{animation:b}=a;return b.playbackRate}set speed(a){let{resolved:b}=this;if(!b)return;let{animation:c}=b;c.playbackRate=a}get state(){let{resolved:a}=this;if(!a)return"idle";let{animation:b}=a;return b.playState}get startTime(){let{resolved:a}=this;if(!a)return null;let{animation:b}=a;return b.startTime}attachTimeline(a){if(this._resolved){let{resolved:b}=this;if(!b)return dQ;let{animation:c}=b;d$(c,a)}else this.pendingTimeline=a;return dQ}play(){if(this.isStopped)return;let{resolved:a}=this;if(!a)return;let{animation:b}=a;"finished"===b.playState&&this.updateFinishedPromise(),b.play()}pause(){let{resolved:a}=this;if(!a)return;let{animation:b}=a;b.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();let{resolved:a}=this;if(!a)return;let{animation:b,keyframes:c,duration:d,type:e,ease:f,times:g}=a;if("idle"===b.playState||"finished"===b.playState)return;if(this.time){let{motionValue:a,onUpdate:b,onComplete:h,element:i,...j}=this.options,k=new gl({...j,keyframes:c,duration:d,type:e,ease:f,times:g,isGenerator:!0}),l=dT(this.time);a.setWithVelocity(k.sample(l-10).value,k.sample(l).value,10)}let{onStop:h}=this.options;h&&h(),this.cancel()}complete(){let{resolved:a}=this;a&&a.animation.finish()}cancel(){let{resolved:a}=this;a&&a.animation.cancel()}static supports(a){let{motionValue:b,name:c,repeatDelay:d,repeatType:e,damping:f,type:g}=a;if(!b||!b.owner||!(b.owner.current instanceof HTMLElement))return!1;let{onUpdate:h,transformTemplate:i}=b.owner.getProps();return gn()&&c&&gm.has(c)&&!h&&!i&&!d&&"mirror"!==e&&0!==f&&"inertia"!==g}}let gq={type:"spring",stiffness:500,damping:25,restSpeed:10},gr={type:"keyframes",duration:.8},gs={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gt=(a,b,c,d={},e,f)=>g=>{let h=dX(d,a)||{},i=h.delay||d.delay||0,{elapsed:j=0}=d;j-=dT(i);let k={keyframes:Array.isArray(c)?c:[null,c],ease:"easeOut",velocity:b.getVelocity(),...h,delay:-j,onUpdate:a=>{b.set(a),h.onUpdate&&h.onUpdate(a)},onComplete:()=>{g(),h.onComplete&&h.onComplete()},name:a,motionValue:b,element:f?void 0:e};!function({when:a,delay:b,delayChildren:c,staggerChildren:d,staggerDirection:e,repeat:f,repeatType:g,repeatDelay:h,from:i,elapsed:j,...k}){return!!Object.keys(k).length}(h)&&(k={...k,...((a,{keyframes:b})=>b.length>2?gr:eg.has(a)?a.startsWith("scale")?{type:"spring",stiffness:550,damping:0===b[1]?2*Math.sqrt(550):30,restSpeed:10}:gq:gs)(a,k)}),k.duration&&(k.duration=dT(k.duration)),k.repeatDelay&&(k.repeatDelay=dT(k.repeatDelay)),void 0!==k.from&&(k.keyframes[0]=k.from);let l=!1;if(!1!==k.type&&(0!==k.duration||k.repeatDelay)||(k.duration=0,0===k.delay&&(l=!0)),l&&!f&&void 0!==b.get()){let a=fL(k.keyframes,h);if(void 0!==a)return el.update(()=>{k.onUpdate(a),k.onComplete()}),new dW([])}return!f&&gp.supports(k)?new gp(k):new gl(k)};function gu(a,b,{delay:c=0,transitionOverride:d,type:e}={}){var f;let{transition:g=a.getDefaultTransition(),transitionEnd:h,...i}=b;d&&(g=d);let j=[],k=e&&a.animationState&&a.animationState.getState()[e];for(let b in i){let d=a.getValue(b,null!=(f=a.latestValues[b])?f:null),e=i[b];if(void 0===e||k&&function({protectedKeys:a,needsAnimating:b},c){let d=a.hasOwnProperty(c)&&!0!==b[c];return b[c]=!1,d}(k,b))continue;let h={delay:c,...dX(g||{},b)},l=!1;if(window.MotionHandoffAnimation){let c=a.props[ez];if(c){let a=window.MotionHandoffAnimation(c,b,el);null!==a&&(h.startTime=a,l=!0)}}ex(a,b),d.start(gt(b,d,e,a.shouldReduceMotion&&eh.has(b)?{type:!1}:h,a,l));let m=d.animation;m&&j.push(m)}return h&&Promise.all(j).then(()=>{el.update(()=>{h&&function(a,b){let{transitionEnd:c={},transition:d={},...e}=dN(a,b)||{};for(let b in e={...e,...c}){let c=ei(e[b]);a.hasValue(b)?a.getValue(b).set(c):a.addValue(b,ev(c))}}(a,h)})}),j}function gv(a,b,c={}){var d;let e=dN(a,b,"exit"===c.type?null==(d=a.presenceContext)?void 0:d.custom:void 0),{transition:f=a.getDefaultTransition()||{}}=e||{};c.transitionOverride&&(f=c.transitionOverride);let g=e?()=>Promise.all(gu(a,e,c)):()=>Promise.resolve(),h=a.variantChildren&&a.variantChildren.size?(d=0)=>{let{delayChildren:e=0,staggerChildren:g,staggerDirection:h}=f;return function(a,b,c=0,d=0,e=1,f){let g=[],h=(a.variantChildren.size-1)*d,i=1===e?(a=0)=>a*d:(a=0)=>h-a*d;return Array.from(a.variantChildren).sort(gw).forEach((a,d)=>{a.notify("AnimationStart",b),g.push(gv(a,b,{...f,delay:c+i(d)}).then(()=>a.notify("AnimationComplete",b)))}),Promise.all(g)}(a,b,e+d,g,h,c)}:()=>Promise.resolve(),{when:i}=f;if(!i)return Promise.all([g(),h(c.delay)]);{let[a,b]="beforeChildren"===i?[g,h]:[h,g];return a().then(()=>b())}}function gw(a,b){return a.sortNodePosition(b)}let gx=dP.length,gy=[...dO].reverse(),gz=dO.length;function gA(a=!1){return{isActive:a,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gB(){return{animate:gA(!0),whileInView:gA(),whileHover:gA(),whileTap:gA(),whileDrag:gA(),whileFocus:gA(),exit:gA()}}class gC{constructor(a){this.isMounted=!1,this.node=a}update(){}}let gD=0;function gE(a,b,c,d={passive:!0}){return a.addEventListener(b,c,d),()=>a.removeEventListener(b,c)}function gF(a){return{point:{x:a.pageX,y:a.pageY}}}function gG(a,b,c,d){return gE(a,b,a=>d9(a)&&c(a,gF(a)),d)}let gH=(a,b)=>Math.abs(a-b);class gI{constructor(a,b,{transformPagePoint:c,contextWindow:d,dragSnapToOrigin:e=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{var a,b;if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let c=gL(this.lastMoveEventInfo,this.history),d=null!==this.startEvent,e=(a=c.offset,b={x:0,y:0},Math.sqrt(gH(a.x,b.x)**2+gH(a.y,b.y)**2)>=3);if(!d&&!e)return;let{point:f}=c,{timestamp:g}=en;this.history.push({...f,timestamp:g});let{onStart:h,onMove:i}=this.handlers;d||(h&&h(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),i&&i(this.lastMoveEvent,c)},this.handlePointerMove=(a,b)=>{this.lastMoveEvent=a,this.lastMoveEventInfo=gJ(b,this.transformPagePoint),el.update(this.updatePoint,!0)},this.handlePointerUp=(a,b)=>{this.end();let{onEnd:c,onSessionEnd:d,resumeAnimation:e}=this.handlers;if(this.dragSnapToOrigin&&e&&e(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let f=gL("pointercancel"===a.type?this.lastMoveEventInfo:gJ(b,this.transformPagePoint),this.history);this.startEvent&&c&&c(a,f),d&&d(a,f)},!d9(a))return;this.dragSnapToOrigin=e,this.handlers=b,this.transformPagePoint=c,this.contextWindow=d||window;const f=gJ(gF(a),this.transformPagePoint),{point:g}=f,{timestamp:h}=en;this.history=[{...g,timestamp:h}];const{onSessionStart:i}=b;i&&i(a,gL(f,this.history)),this.removeListeners=fV(gG(this.contextWindow,"pointermove",this.handlePointerMove),gG(this.contextWindow,"pointerup",this.handlePointerUp),gG(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(a){this.handlers=a}end(){this.removeListeners&&this.removeListeners(),em(this.updatePoint)}}function gJ(a,b){return b?{point:b(a.point)}:a}function gK(a,b){return{x:a.x-b.x,y:a.y-b.y}}function gL({point:a},b){return{point:a,delta:gK(a,gM(b)),offset:gK(a,b[0]),velocity:function(a,b){if(a.length<2)return{x:0,y:0};let c=a.length-1,d=null,e=gM(a);for(;c>=0&&(d=a[c],!(e.timestamp-d.timestamp>dT(.1)));)c--;if(!d)return{x:0,y:0};let f=(e.timestamp-d.timestamp)/1e3;if(0===f)return{x:0,y:0};let g={x:(e.x-d.x)/f,y:(e.y-d.y)/f};return g.x===1/0&&(g.x=0),g.y===1/0&&(g.y=0),g}(b,.1)}}function gM(a){return a[a.length-1]}function gN(a){return a&&"object"==typeof a&&Object.prototype.hasOwnProperty.call(a,"current")}function gO(a){return a.max-a.min}function gP(a,b,c,d=.5){a.origin=d,a.originPoint=fN(b.min,b.max,a.origin),a.scale=gO(c)/gO(b),a.translate=fN(c.min,c.max,a.origin)-a.originPoint,(a.scale>=.9999&&a.scale<=1.0001||isNaN(a.scale))&&(a.scale=1),(a.translate>=-.01&&a.translate<=.01||isNaN(a.translate))&&(a.translate=0)}function gQ(a,b,c,d){gP(a.x,b.x,c.x,d?d.originX:void 0),gP(a.y,b.y,c.y,d?d.originY:void 0)}function gR(a,b,c){a.min=c.min+b.min,a.max=a.min+gO(b)}function gS(a,b,c){a.min=b.min-c.min,a.max=a.min+gO(b)}function gT(a,b,c){gS(a.x,b.x,c.x),gS(a.y,b.y,c.y)}function gU(a,b,c){return{min:void 0!==b?a.min+b:void 0,max:void 0!==c?a.max+c-(a.max-a.min):void 0}}function gV(a,b){let c=b.min-a.min,d=b.max-a.max;return b.max-b.min<a.max-a.min&&([c,d]=[d,c]),{min:c,max:d}}function gW(a,b,c){return{min:gX(a,b),max:gX(a,c)}}function gX(a,b){return"number"==typeof a?a:a[b]||0}let gY=()=>({translate:0,scale:1,origin:0,originPoint:0}),gZ=()=>({x:gY(),y:gY()}),g$=()=>({min:0,max:0}),g_=()=>({x:g$(),y:g$()});function g0(a){return[a("x"),a("y")]}function g1({top:a,left:b,right:c,bottom:d}){return{x:{min:b,max:c},y:{min:a,max:d}}}function g2(a){return void 0===a||1===a}function g3({scale:a,scaleX:b,scaleY:c}){return!g2(a)||!g2(b)||!g2(c)}function g4(a){return g3(a)||g5(a)||a.z||a.rotate||a.rotateX||a.rotateY||a.skewX||a.skewY}function g5(a){var b,c;return(b=a.x)&&"0%"!==b||(c=a.y)&&"0%"!==c}function g6(a,b,c,d,e){return void 0!==e&&(a=d+e*(a-d)),d+c*(a-d)+b}function g7(a,b=0,c=1,d,e){a.min=g6(a.min,b,c,d,e),a.max=g6(a.max,b,c,d,e)}function g8(a,{x:b,y:c}){g7(a.x,b.translate,b.scale,b.originPoint),g7(a.y,c.translate,c.scale,c.originPoint)}function g9(a,b){a.min=a.min+b,a.max=a.max+b}function ha(a,b,c,d,e=.5){let f=fN(a.min,a.max,e);g7(a,b,c,f,d)}function hb(a,b){ha(a.x,b.x,b.scaleX,b.scale,b.originX),ha(a.y,b.y,b.scaleY,b.scale,b.originY)}function hc(a,b){return g1(function(a,b){if(!b)return a;let c=b({x:a.left,y:a.top}),d=b({x:a.right,y:a.bottom});return{top:c.y,left:c.x,bottom:d.y,right:d.x}}(a.getBoundingClientRect(),b))}let hd=({current:a})=>a?a.ownerDocument.defaultView:null,he=new WeakMap;class hf{constructor(a){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=g_(),this.visualElement=a}start(a,{snapToCursor:b=!1}={}){let{presenceContext:c}=this.visualElement;if(c&&!1===c.isPresent)return;let d=a=>{let{dragSnapToOrigin:c}=this.getProps();c?this.pauseAnimation():this.stopAnimation(),b&&this.snapToCursor(gF(a).point)},e=(a,b)=>{let{drag:c,dragPropagation:d,onDragStart:e}=this.getProps();if(c&&!d&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(a){if("x"===a||"y"===a)if(d5[a])return null;else return d5[a]=!0,()=>{d5[a]=!1};return d5.x||d5.y?null:(d5.x=d5.y=!0,()=>{d5.x=d5.y=!1})}(c),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),g0(a=>{let b=this.getAxisMotionValue(a).get()||0;if(eZ.test(b)){let{projection:c}=this.visualElement;if(c&&c.layout){let d=c.layout.layoutBox[a];d&&(b=gO(d)*(parseFloat(b)/100))}}this.originPoint[a]=b}),e&&el.postRender(()=>e(a,b)),ex(this.visualElement,"transform");let{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},f=(a,b)=>{let{dragPropagation:c,dragDirectionLock:d,onDirectionLock:e,onDrag:f}=this.getProps();if(!c&&!this.openDragLock)return;let{offset:g}=b;if(d&&null===this.currentDirection){this.currentDirection=function(a,b=10){let c=null;return Math.abs(a.y)>b?c="y":Math.abs(a.x)>b&&(c="x"),c}(g),null!==this.currentDirection&&e&&e(this.currentDirection);return}this.updateAxis("x",b.point,g),this.updateAxis("y",b.point,g),this.visualElement.render(),f&&f(a,b)},g=(a,b)=>this.stop(a,b),h=()=>g0(a=>{var b;return"paused"===this.getAnimationState(a)&&(null==(b=this.getAxisMotionValue(a).animation)?void 0:b.play())}),{dragSnapToOrigin:i}=this.getProps();this.panSession=new gI(a,{onSessionStart:d,onStart:e,onMove:f,onSessionEnd:g,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:hd(this.visualElement)})}stop(a,b){let c=this.isDragging;if(this.cancel(),!c)return;let{velocity:d}=b;this.startAnimation(d);let{onDragEnd:e}=this.getProps();e&&el.postRender(()=>e(a,b))}cancel(){this.isDragging=!1;let{projection:a,animationState:b}=this.visualElement;a&&(a.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:c}=this.getProps();!c&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),b&&b.setActive("whileDrag",!1)}updateAxis(a,b,c){let{drag:d}=this.getProps();if(!c||!hg(a,d,this.currentDirection))return;let e=this.getAxisMotionValue(a),f=this.originPoint[a]+c[a];this.constraints&&this.constraints[a]&&(f=function(a,{min:b,max:c},d){return void 0!==b&&a<b?a=d?fN(b,a,d.min):Math.max(a,b):void 0!==c&&a>c&&(a=d?fN(c,a,d.max):Math.min(a,c)),a}(f,this.constraints[a],this.elastic[a])),e.set(f)}resolveConstraints(){var a;let{dragConstraints:b,dragElastic:c}=this.getProps(),d=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(a=this.visualElement.projection)?void 0:a.layout,e=this.constraints;b&&gN(b)?this.constraints||(this.constraints=this.resolveRefConstraints()):b&&d?this.constraints=function(a,{top:b,left:c,bottom:d,right:e}){return{x:gU(a.x,c,e),y:gU(a.y,b,d)}}(d.layoutBox,b):this.constraints=!1,this.elastic=function(a=.35){return!1===a?a=0:!0===a&&(a=.35),{x:gW(a,"left","right"),y:gW(a,"top","bottom")}}(c),e!==this.constraints&&d&&this.constraints&&!this.hasMutatedConstraints&&g0(a=>{var b,c;let e;!1!==this.constraints&&this.getAxisMotionValue(a)&&(this.constraints[a]=(b=d.layoutBox[a],c=this.constraints[a],e={},void 0!==c.min&&(e.min=c.min-b.min),void 0!==c.max&&(e.max=c.max-b.min),e))})}resolveRefConstraints(){var a;let{dragConstraints:b,onMeasureDragConstraints:c}=this.getProps();if(!b||!gN(b))return!1;let d=b.current;dQ(null!==d,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:e}=this.visualElement;if(!e||!e.layout)return!1;let f=function(a,b,c){let d=hc(a,c),{scroll:e}=b;return e&&(g9(d.x,e.offset.x),g9(d.y,e.offset.y)),d}(d,e.root,this.visualElement.getTransformPagePoint()),g=(a=e.layout.layoutBox,{x:gV(a.x,f.x),y:gV(a.y,f.y)});if(c){let a=c(function({x:a,y:b}){return{top:b.min,right:a.max,bottom:b.max,left:a.min}}(g));this.hasMutatedConstraints=!!a,a&&(g=g1(a))}return g}startAnimation(a){let{drag:b,dragMomentum:c,dragElastic:d,dragTransition:e,dragSnapToOrigin:f,onDragTransitionEnd:g}=this.getProps(),h=this.constraints||{};return Promise.all(g0(g=>{if(!hg(g,b,this.currentDirection))return;let i=h&&h[g]||{};f&&(i={min:0,max:0});let j={type:"inertia",velocity:c?a[g]:0,bounceStiffness:d?200:1e6,bounceDamping:d?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...e,...i};return this.startAxisValueAnimation(g,j)})).then(g)}startAxisValueAnimation(a,b){let c=this.getAxisMotionValue(a);return ex(this.visualElement,a),c.start(gt(a,c,0,b,this.visualElement,!1))}stopAnimation(){g0(a=>this.getAxisMotionValue(a).stop())}pauseAnimation(){g0(a=>{var b;return null==(b=this.getAxisMotionValue(a).animation)?void 0:b.pause()})}getAnimationState(a){var b;return null==(b=this.getAxisMotionValue(a).animation)?void 0:b.state}getAxisMotionValue(a){let b=`_drag${a.toUpperCase()}`,c=this.visualElement.getProps();return c[b]||this.visualElement.getValue(a,(c.initial?c.initial[a]:void 0)||0)}snapToCursor(a){g0(b=>{let{drag:c}=this.getProps();if(!hg(b,c,this.currentDirection))return;let{projection:d}=this.visualElement,e=this.getAxisMotionValue(b);if(d&&d.layout){let{min:c,max:f}=d.layout.layoutBox[b];e.set(a[b]-fN(c,f,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:a,dragConstraints:b}=this.getProps(),{projection:c}=this.visualElement;if(!gN(b)||!c||!this.constraints)return;this.stopAnimation();let d={x:0,y:0};g0(a=>{let b=this.getAxisMotionValue(a);if(b&&!1!==this.constraints){var c,e;let f,g,h,i=b.get();d[a]=(c={min:i,max:i},e=this.constraints[a],f=.5,g=gO(c),(h=gO(e))>g?f=dS(e.min,e.max-g,c.min):g>h&&(f=dS(c.min,c.max-h,e.min)),eL(0,1,f))}});let{transformTemplate:e}=this.visualElement.getProps();this.visualElement.current.style.transform=e?e({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),g0(b=>{if(!hg(b,a,null))return;let c=this.getAxisMotionValue(b),{min:e,max:f}=this.constraints[b];c.set(fN(e,f,d[b]))})}addListeners(){if(!this.visualElement.current)return;he.set(this.visualElement,this);let a=gG(this.visualElement.current,"pointerdown",a=>{let{drag:b,dragListener:c=!0}=this.getProps();b&&c&&this.start(a)}),b=()=>{let{dragConstraints:a}=this.getProps();gN(a)&&a.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,d=c.addEventListener("measure",b);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),el.read(b);let e=gE(window,"resize",()=>this.scalePositionWithinConstraints()),f=c.addEventListener("didUpdate",({delta:a,hasLayoutChanged:b})=>{this.isDragging&&b&&(g0(b=>{let c=this.getAxisMotionValue(b);c&&(this.originPoint[b]+=a[b].translate,c.set(c.get()+a[b].translate))}),this.visualElement.render())});return()=>{e(),a(),d(),f&&f()}}getProps(){let a=this.visualElement.getProps(),{drag:b=!1,dragDirectionLock:c=!1,dragPropagation:d=!1,dragConstraints:e=!1,dragElastic:f=.35,dragMomentum:g=!0}=a;return{...a,drag:b,dragDirectionLock:c,dragPropagation:d,dragConstraints:e,dragElastic:f,dragMomentum:g}}}function hg(a,b,c){return(!0===b||b===a)&&(null===c||c===a)}let hh=a=>(b,c)=>{a&&el.postRender(()=>a(b,c))};var hi=bD;let hj=(0,bD.createContext)(null),hk=(0,bD.createContext)({}),hl=(0,bD.createContext)({}),hm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function hn(a,b){return b.max===b.min?0:a/(b.max-b.min)*100}let ho={correct:(a,b)=>{if(!b.target)return a;if("string"==typeof a)if(!e$.test(a))return a;else a=parseFloat(a);let c=hn(a,b.target.x),d=hn(a,b.target.y);return`${c}% ${d}%`}},hp={},{schedule:hq,cancel:hr}=ek(queueMicrotask,!1);class hs extends hi.Component{componentDidMount(){let{visualElement:a,layoutGroup:b,switchLayoutGroup:c,layoutId:d}=this.props,{projection:e}=a;Object.assign(hp,hu),e&&(b.group&&b.group.add(e),c&&c.register&&d&&c.register(e),e.root.didUpdate(),e.addEventListener("animationComplete",()=>{this.safeToRemove()}),e.setOptions({...e.options,onExitComplete:()=>this.safeToRemove()})),hm.hasEverUpdated=!0}getSnapshotBeforeUpdate(a){let{layoutDependency:b,visualElement:c,drag:d,isPresent:e}=this.props,f=c.projection;return f&&(f.isPresent=e,d||a.layoutDependency!==b||void 0===b?f.willUpdate():this.safeToRemove(),a.isPresent!==e&&(e?f.promote():f.relegate()||el.postRender(()=>{let a=f.getStack();a&&a.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:a}=this.props.visualElement;a&&(a.root.didUpdate(),hq.postRender(()=>{!a.currentAnimation&&a.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:a,layoutGroup:b,switchLayoutGroup:c}=this.props,{projection:d}=a;d&&(d.scheduleCheckAfterUnmount(),b&&b.group&&b.group.remove(d),c&&c.deregister&&c.deregister(d))}safeToRemove(){let{safeToRemove:a}=this.props;a&&a()}render(){return null}}function ht(a){let[b,c]=function(a=!0){let b=(0,bD.useContext)(hj);if(null===b)return[!0,null];let{isPresent:c,onExitComplete:d,register:e}=b,f=(0,bD.useId)();(0,bD.useEffect)(()=>{a&&e(f)},[a]);let g=(0,bD.useCallback)(()=>a&&d&&d(f),[f,d,a]);return!c&&d?[!1,g]:[!0]}(),d=(0,hi.useContext)(hk);return(0,bC.jsx)(hs,{...a,layoutGroup:d,switchLayoutGroup:(0,hi.useContext)(hl),isPresent:b,safeToRemove:c})}let hu={borderRadius:{...ho,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ho,borderTopRightRadius:ho,borderBottomLeftRadius:ho,borderBottomRightRadius:ho,boxShadow:{correct:(a,{treeScale:b,projectionDelta:c})=>{let d=fc.parse(a);if(d.length>5)return a;let e=fc.createTransformer(a),f=+("number"!=typeof d[0]),g=c.x.scale*b.x,h=c.y.scale*b.y;d[0+f]/=g,d[1+f]/=h;let i=fN(g,h,.5);return"number"==typeof d[2+f]&&(d[2+f]/=i),"number"==typeof d[3+f]&&(d[3+f]/=i),e(d)}}},hv=(a,b)=>a.depth-b.depth;class hw{constructor(){this.children=[],this.isDirty=!1}add(a){er(this.children,a),this.isDirty=!0}remove(a){es(this.children,a),this.isDirty=!0}forEach(a){this.isDirty&&this.children.sort(hv),this.isDirty=!1,this.children.forEach(a)}}function hx(a){let b=ew(a)?a.get():a;return b&&"object"==typeof b&&b.mix&&b.toValue?b.toValue():b}let hy=["TopLeft","TopRight","BottomLeft","BottomRight"],hz=hy.length,hA=a=>"string"==typeof a?parseFloat(a):a,hB=a=>"number"==typeof a||e$.test(a);function hC(a,b){return void 0!==a[b]?a[b]:a.borderRadius}let hD=hF(0,.5,eJ),hE=hF(.5,.95,dQ);function hF(a,b,c){return d=>d<a?0:d>b?1:c(dS(a,b,d))}function hG(a,b){a.min=b.min,a.max=b.max}function hH(a,b){hG(a.x,b.x),hG(a.y,b.y)}function hI(a,b){a.translate=b.translate,a.scale=b.scale,a.originPoint=b.originPoint,a.origin=b.origin}function hJ(a,b,c,d,e){return a-=b,a=d+1/c*(a-d),void 0!==e&&(a=d+1/e*(a-d)),a}function hK(a,b,[c,d,e],f,g){!function(a,b=0,c=1,d=.5,e,f=a,g=a){if(eZ.test(b)&&(b=parseFloat(b),b=fN(g.min,g.max,b/100)-g.min),"number"!=typeof b)return;let h=fN(f.min,f.max,d);a===f&&(h-=b),a.min=hJ(a.min,b,c,h,e),a.max=hJ(a.max,b,c,h,e)}(a,b[c],b[d],b[e],b.scale,f,g)}let hL=["x","scaleX","originX"],hM=["y","scaleY","originY"];function hN(a,b,c,d){hK(a.x,b,hL,c?c.x:void 0,d?d.x:void 0),hK(a.y,b,hM,c?c.y:void 0,d?d.y:void 0)}function hO(a){return 0===a.translate&&1===a.scale}function hP(a){return hO(a.x)&&hO(a.y)}function hQ(a,b){return a.min===b.min&&a.max===b.max}function hR(a,b){return Math.round(a.min)===Math.round(b.min)&&Math.round(a.max)===Math.round(b.max)}function hS(a,b){return hR(a.x,b.x)&&hR(a.y,b.y)}function hT(a){return gO(a.x)/gO(a.y)}function hU(a,b){return a.translate===b.translate&&a.scale===b.scale&&a.originPoint===b.originPoint}class hV{constructor(){this.members=[]}add(a){er(this.members,a),a.scheduleRender()}remove(a){if(es(this.members,a),a===this.prevLead&&(this.prevLead=void 0),a===this.lead){let a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(a){let b,c=this.members.findIndex(b=>a===b);if(0===c)return!1;for(let a=c;a>=0;a--){let c=this.members[a];if(!1!==c.isPresent){b=c;break}}return!!b&&(this.promote(b),!0)}promote(a,b){let c=this.lead;if(a!==c&&(this.prevLead=c,this.lead=a,a.show(),c)){c.instance&&c.scheduleRender(),a.scheduleRender(),a.resumeFrom=c,b&&(a.resumeFrom.preserveOpacity=!0),c.snapshot&&(a.snapshot=c.snapshot,a.snapshot.latestValues=c.animationValues||c.latestValues),a.root&&a.root.isUpdating&&(a.isLayoutDirty=!0);let{crossfade:d}=a.options;!1===d&&c.hide()}}exitAnimationComplete(){this.members.forEach(a=>{let{options:b,resumingFrom:c}=a;b.onExitComplete&&b.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(a=>{a.instance&&a.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let hW=["","X","Y","Z"],hX={visibility:"hidden"},hY=0;function hZ(a,b,c,d){let{latestValues:e}=b;e[a]&&(c[a]=e[a],b.setStaticValue(a,0),d&&(d[a]=0))}function h$({attachResizeListener:a,defaultParent:b,measureScroll:c,checkIsScrollRoot:d,resetTransform:e}){return class{constructor(a={},c=null==b?void 0:b()){this.id=hY++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(h1),this.nodes.forEach(h8),this.nodes.forEach(h9),this.nodes.forEach(h2)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new hw)}addEventListener(a,b){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new et),this.eventHandlers.get(a).add(b)}notifyListeners(a,...b){let c=this.eventHandlers.get(a);c&&c.notify(...b)}hasListeners(a){return this.eventHandlers.has(a)}mount(b,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=b instanceof SVGElement&&"svg"!==b.tagName,this.instance=b;let{layoutId:d,layout:e,visualElement:f}=this.options;if(f&&!f.current&&f.mount(b),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(e||d)&&(this.isLayoutDirty=!0),a){let c,d=()=>this.root.updateBlockedByResize=!1;a(b,()=>{let a,b;this.root.updateBlockedByResize=!0,c&&c(),a=eq.now(),b=({timestamp:c})=>{let e=c-a;e>=250&&(em(b),d(e-250))},el.read(b,!0),c=()=>em(b),hm.hasAnimatedSinceResize&&(hm.hasAnimatedSinceResize=!1,this.nodes.forEach(h7))})}d&&this.root.registerSharedNode(d,this),!1!==this.options.animate&&f&&(d||e)&&this.addEventListener("didUpdate",({delta:a,hasLayoutChanged:b,hasRelativeTargetChanged:c,layout:d})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let e=this.options.transition||f.getDefaultTransition()||ig,{onLayoutAnimationStart:g,onLayoutAnimationComplete:h}=f.getProps(),i=!this.targetLayout||!hS(this.targetLayout,d)||c,j=!b&&c;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||j||b&&(i||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(a,j);let b={...dX(e,"layout"),onPlay:g,onComplete:h};(f.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else b||h7(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=d})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,em(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ia),this.animationId++)}getTransformTemplate(){let{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function a(b){if(b.hasCheckedOptimisedAppear=!0,b.root===b)return;let{visualElement:c}=b.options;if(!c)return;let d=c.props[ez];if(window.MotionHasOptimisedAnimation(d,"transform")){let{layout:a,layoutId:c}=b.options;window.MotionCancelOptimisedAnimation(d,"transform",el,!(a||c))}let{parent:e}=b;e&&!e.hasCheckedOptimisedAppear&&a(e)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){let b=this.path[a];b.shouldResetTransform=!0,b.updateScroll("snapshot"),b.options.layoutRoot&&b.willUpdate(!1)}let{layoutId:b,layout:c}=this.options;if(void 0===b&&!c)return;let d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(h4);return}this.isUpdating||this.nodes.forEach(h5),this.isUpdating=!1,this.nodes.forEach(h6),this.nodes.forEach(h_),this.nodes.forEach(h0),this.clearAllSnapshots();let a=eq.now();en.delta=eL(0,1e3/60,a-en.timestamp),en.timestamp=a,en.isProcessing=!0,eo.update.process(en),eo.preRender.process(en),eo.render.process(en),en.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,hq.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(h3),this.sharedNodes.forEach(ib)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,el.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){el.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();let a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=g_(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:b}=this.options;b&&b.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let b=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(b=!1),b){let b=d(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:b,offset:c(this.instance),wasRoot:this.scroll?this.scroll.isRoot:b}}}resetTransform(){if(!e)return;let a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,b=this.projectionDelta&&!hP(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;a&&(b||g4(this.latestValues)||f)&&(e(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){var b;let c=this.measurePageBox(),d=this.removeElementScroll(c);return a&&(d=this.removeTransform(d)),ij((b=d).x),ij(b.y),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var a;let{visualElement:b}=this.options;if(!b)return g_();let c=b.measureViewportBox();if(!((null==(a=this.scroll)?void 0:a.wasRoot)||this.path.some(il))){let{scroll:a}=this.root;a&&(g9(c.x,a.offset.x),g9(c.y,a.offset.y))}return c}removeElementScroll(a){var b;let c=g_();if(hH(c,a),null==(b=this.scroll)?void 0:b.wasRoot)return c;for(let b=0;b<this.path.length;b++){let d=this.path[b],{scroll:e,options:f}=d;d!==this.root&&e&&f.layoutScroll&&(e.wasRoot&&hH(c,a),g9(c.x,e.offset.x),g9(c.y,e.offset.y))}return c}applyTransform(a,b=!1){let c=g_();hH(c,a);for(let a=0;a<this.path.length;a++){let d=this.path[a];!b&&d.options.layoutScroll&&d.scroll&&d!==d.root&&hb(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),g4(d.latestValues)&&hb(c,d.latestValues)}return g4(this.latestValues)&&hb(c,this.latestValues),c}removeTransform(a){let b=g_();hH(b,a);for(let a=0;a<this.path.length;a++){let c=this.path[a];if(!c.instance||!g4(c.latestValues))continue;g3(c.latestValues)&&c.updateSnapshot();let d=g_();hH(d,c.measurePageBox()),hN(b,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return g4(this.latestValues)&&hN(b,this.latestValues),b}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:void 0===a.crossfade||a.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==en.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var b,c,d,e;let f=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=f.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=f.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=f.isSharedProjectionDirty);let g=!!this.resumingFrom||this!==f;if(!(a||g&&this.isSharedProjectionDirty||this.isProjectionDirty||(null==(b=this.parent)?void 0:b.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:h,layoutId:i}=this.options;if(this.layout&&(h||i)){if(this.resolvedRelativeTargetAt=en.timestamp,!this.targetDelta&&!this.relativeTarget){let a=this.getClosestProjectingParent();a&&a.layout&&1!==this.animationProgress?(this.relativeParent=a,this.forceRelativeParentToResolveTarget(),this.relativeTarget=g_(),this.relativeTargetOrigin=g_(),gT(this.relativeTargetOrigin,this.layout.layoutBox,a.layout.layoutBox),hH(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if((this.relativeTarget||this.targetDelta)&&((this.target||(this.target=g_(),this.targetWithTransforms=g_()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),c=this.target,d=this.relativeTarget,e=this.relativeParent.target,gR(c.x,d.x,e.x),gR(c.y,d.y,e.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):hH(this.target,this.layout.layoutBox),g8(this.target,this.targetDelta)):hH(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;let a=this.getClosestProjectingParent();a&&!!a.resumingFrom==!!this.resumingFrom&&!a.options.layoutScroll&&a.target&&1!==this.animationProgress?(this.relativeParent=a,this.forceRelativeParentToResolveTarget(),this.relativeTarget=g_(),this.relativeTargetOrigin=g_(),gT(this.relativeTargetOrigin,this.target,a.target),hH(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||g3(this.parent.latestValues)||g5(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;let b=this.getLead(),c=!!this.resumingFrom||this!==b,d=!0;if((this.isProjectionDirty||(null==(a=this.parent)?void 0:a.isProjectionDirty))&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===en.timestamp&&(d=!1),d)return;let{layout:e,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(e||f))return;hH(this.layoutCorrected,this.layout.layoutBox);let g=this.treeScale.x,h=this.treeScale.y;!function(a,b,c,d=!1){let e,f,g=c.length;if(g){b.x=b.y=1;for(let h=0;h<g;h++){f=(e=c[h]).projectionDelta;let{visualElement:g}=e.options;(!g||!g.props.style||"contents"!==g.props.style.display)&&(d&&e.options.layoutScroll&&e.scroll&&e!==e.root&&hb(a,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),f&&(b.x*=f.x.scale,b.y*=f.y.scale,g8(a,f)),d&&g4(e.latestValues)&&hb(a,e.latestValues))}b.x<1.0000000000001&&b.x>.999999999999&&(b.x=1),b.y<1.0000000000001&&b.y>.999999999999&&(b.y=1)}}(this.layoutCorrected,this.treeScale,this.path,c),b.layout&&!b.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(b.target=b.layout.layoutBox,b.targetWithTransforms=g_());let{target:i}=b;if(!i){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(hI(this.prevProjectionDelta.x,this.projectionDelta.x),hI(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),gQ(this.projectionDelta,this.layoutCorrected,i,this.latestValues),this.treeScale.x===g&&this.treeScale.y===h&&hU(this.projectionDelta.x,this.prevProjectionDelta.x)&&hU(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",i))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var b;if(null==(b=this.options.visualElement)||b.scheduleRender(),a){let a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=gZ(),this.projectionDelta=gZ(),this.projectionDeltaWithTransform=gZ()}setAnimationOrigin(a,b=!1){let c,d=this.snapshot,e=d?d.latestValues:{},f={...this.latestValues},g=gZ();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!b;let h=g_(),i=(d?d.source:void 0)!==(this.layout?this.layout.source:void 0),j=this.getStack(),k=!j||j.members.length<=1,l=!!(i&&!k&&!0===this.options.crossfade&&!this.path.some(ie));this.animationProgress=0,this.mixTargetDelta=b=>{let d=b/1e3;if(ic(g.x,a.x,d),ic(g.y,a.y,d),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var j,m,n,o,p,q;gT(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),n=this.relativeTarget,o=this.relativeTargetOrigin,p=h,q=d,id(n.x,o.x,p.x,q),id(n.y,o.y,p.y,q),c&&(j=this.relativeTarget,m=c,hQ(j.x,m.x)&&hQ(j.y,m.y))&&(this.isProjectionDirty=!1),c||(c=g_()),hH(c,this.relativeTarget)}i&&(this.animationValues=f,function(a,b,c,d,e,f){e?(a.opacity=fN(0,void 0!==c.opacity?c.opacity:1,hD(d)),a.opacityExit=fN(void 0!==b.opacity?b.opacity:1,0,hE(d))):f&&(a.opacity=fN(void 0!==b.opacity?b.opacity:1,void 0!==c.opacity?c.opacity:1,d));for(let e=0;e<hz;e++){let f=`border${hy[e]}Radius`,g=hC(b,f),h=hC(c,f);(void 0!==g||void 0!==h)&&(g||(g=0),h||(h=0),0===g||0===h||hB(g)===hB(h)?(a[f]=Math.max(fN(hA(g),hA(h),d),0),(eZ.test(h)||eZ.test(g))&&(a[f]+="%")):a[f]=h)}(b.rotate||c.rotate)&&(a.rotate=fN(b.rotate||0,c.rotate||0,d))}(f,e,this.latestValues,d,l,k)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=d},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(em(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=el.update(()=>{var b;let c;hm.hasAnimatedSinceResize=!0,this.currentAnimation=(b={...a,onUpdate:b=>{this.mixTargetDelta(b),a.onUpdate&&a.onUpdate(b)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}},(c=ew(0)?0:ev(0)).start(gt("",c,1e3,b)),c.animation),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let a=this.getLead(),{targetWithTransforms:b,target:c,layout:d,latestValues:e}=a;if(b&&c&&d){if(this!==a&&this.layout&&d&&ik(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||g_();let b=gO(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+b;let d=gO(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+d}hH(b,c),hb(b,e),gQ(this.projectionDeltaWithTransform,this.layoutCorrected,b,e)}}registerSharedNode(a,b){this.sharedNodes.has(a)||this.sharedNodes.set(a,new hV),this.sharedNodes.get(a).add(b);let c=b.options.initialPromotionConfig;b.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(b):void 0})}isLead(){let a=this.getStack();return!a||a.lead===this}getLead(){var a;let{layoutId:b}=this.options;return b&&(null==(a=this.getStack())?void 0:a.lead)||this}getPrevLead(){var a;let{layoutId:b}=this.options;return b?null==(a=this.getStack())?void 0:a.prevLead:void 0}getStack(){let{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:b,preserveFollowOpacity:c}={}){let d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),b&&this.setOptions({transition:b})}relegate(){let a=this.getStack();return!!a&&a.relegate(this)}resetSkewAndRotation(){let{visualElement:a}=this.options;if(!a)return;let b=!1,{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(b=!0),!b)return;let d={};c.z&&hZ("z",a,d,this.animationValues);for(let b=0;b<hW.length;b++)hZ(`rotate${hW[b]}`,a,d,this.animationValues),hZ(`skew${hW[b]}`,a,d,this.animationValues);for(let b in a.render(),d)a.setStaticValue(b,d[b]),this.animationValues&&(this.animationValues[b]=d[b]);a.scheduleRender()}getProjectionStyles(a){var b,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hX;let d={visibility:""},e=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=hx(null==a?void 0:a.pointerEvents)||"",d.transform=e?e(this.latestValues,""):"none",d;let f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){let b={};return this.options.layoutId&&(b.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,b.pointerEvents=hx(null==a?void 0:a.pointerEvents)||""),this.hasProjected&&!g4(this.latestValues)&&(b.transform=e?e({},""):"none",this.hasProjected=!1),b}let g=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=function(a,b,c){let d="",e=a.x.translate/b.x,f=a.y.translate/b.y,g=(null==c?void 0:c.z)||0;if((e||f||g)&&(d=`translate3d(${e}px, ${f}px, ${g}px) `),(1!==b.x||1!==b.y)&&(d+=`scale(${1/b.x}, ${1/b.y}) `),c){let{transformPerspective:a,rotate:b,rotateX:e,rotateY:f,skewX:g,skewY:h}=c;a&&(d=`perspective(${a}px) ${d}`),b&&(d+=`rotate(${b}deg) `),e&&(d+=`rotateX(${e}deg) `),f&&(d+=`rotateY(${f}deg) `),g&&(d+=`skewX(${g}deg) `),h&&(d+=`skewY(${h}deg) `)}let h=a.x.scale*b.x,i=a.y.scale*b.y;return(1!==h||1!==i)&&(d+=`scale(${h}, ${i})`),d||"none"}(this.projectionDeltaWithTransform,this.treeScale,g),e&&(d.transform=e(g,d.transform));let{x:h,y:i}=this.projectionDelta;for(let a in d.transformOrigin=`${100*h.origin}% ${100*i.origin}% 0`,f.animationValues?d.opacity=f===this?null!=(c=null!=(b=g.opacity)?b:this.latestValues.opacity)?c:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:d.opacity=f===this?void 0!==g.opacity?g.opacity:"":void 0!==g.opacityExit?g.opacityExit:0,hp){if(void 0===g[a])continue;let{correct:b,applyTo:c}=hp[a],e="none"===d.transform?g[a]:b(g[a],f);if(c){let a=c.length;for(let b=0;b<a;b++)d[c[b]]=e}else d[a]=e}return this.options.layoutId&&(d.pointerEvents=f===this?hx(null==a?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var b;return null==(b=a.currentAnimation)?void 0:b.stop()}),this.root.nodes.forEach(h4),this.root.sharedNodes.clear()}}}function h_(a){a.updateLayout()}function h0(a){var b;let c=(null==(b=a.resumeFrom)?void 0:b.snapshot)||a.snapshot;if(a.isLead()&&a.layout&&c&&a.hasListeners("didUpdate")){let{layoutBox:b,measuredBox:d}=a.layout,{animationType:e}=a.options,f=c.source!==a.layout.source;"size"===e?g0(a=>{let d=f?c.measuredBox[a]:c.layoutBox[a],e=gO(d);d.min=b[a].min,d.max=d.min+e}):ik(e,c.layoutBox,b)&&g0(d=>{let e=f?c.measuredBox[d]:c.layoutBox[d],g=gO(b[d]);e.max=e.min+g,a.relativeTarget&&!a.currentAnimation&&(a.isProjectionDirty=!0,a.relativeTarget[d].max=a.relativeTarget[d].min+g)});let g=gZ();gQ(g,b,c.layoutBox);let h=gZ();f?gQ(h,a.applyTransform(d,!0),c.measuredBox):gQ(h,b,c.layoutBox);let i=!hP(g),j=!1;if(!a.resumeFrom){let d=a.getClosestProjectingParent();if(d&&!d.resumeFrom){let{snapshot:e,layout:f}=d;if(e&&f){let g=g_();gT(g,c.layoutBox,e.layoutBox);let h=g_();gT(h,b,f.layoutBox),hS(g,h)||(j=!0),d.options.layoutRoot&&(a.relativeTarget=h,a.relativeTargetOrigin=g,a.relativeParent=d)}}}a.notifyListeners("didUpdate",{layout:b,snapshot:c,delta:h,layoutDelta:g,hasLayoutChanged:i,hasRelativeTargetChanged:j})}else if(a.isLead()){let{onExitComplete:b}=a.options;b&&b()}a.options.transition=void 0}function h1(a){a.parent&&(a.isProjecting()||(a.isProjectionDirty=a.parent.isProjectionDirty),a.isSharedProjectionDirty||(a.isSharedProjectionDirty=!!(a.isProjectionDirty||a.parent.isProjectionDirty||a.parent.isSharedProjectionDirty)),a.isTransformDirty||(a.isTransformDirty=a.parent.isTransformDirty))}function h2(a){a.isProjectionDirty=a.isSharedProjectionDirty=a.isTransformDirty=!1}function h3(a){a.clearSnapshot()}function h4(a){a.clearMeasurements()}function h5(a){a.isLayoutDirty=!1}function h6(a){let{visualElement:b}=a.options;b&&b.getProps().onBeforeLayoutMeasure&&b.notify("BeforeLayoutMeasure"),a.resetTransform()}function h7(a){a.finishAnimation(),a.targetDelta=a.relativeTarget=a.target=void 0,a.isProjectionDirty=!0}function h8(a){a.resolveTargetDelta()}function h9(a){a.calcProjection()}function ia(a){a.resetSkewAndRotation()}function ib(a){a.removeLeadSnapshot()}function ic(a,b,c){a.translate=fN(b.translate,0,c),a.scale=fN(b.scale,1,c),a.origin=b.origin,a.originPoint=b.originPoint}function id(a,b,c,d){a.min=fN(b.min,c.min,d),a.max=fN(b.max,c.max,d)}function ie(a){return a.animationValues&&void 0!==a.animationValues.opacityExit}let ig={duration:.45,ease:[.4,0,.1,1]},ih=a=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(a),ii=ih("applewebkit/")&&!ih("chrome/")?Math.round:dQ;function ij(a){a.min=ii(a.min),a.max=ii(a.max)}function ik(a,b,c){return"position"===a||"preserve-aspect"===a&&!(.2>=Math.abs(hT(b)-hT(c)))}function il(a){var b;return a!==a.root&&(null==(b=a.scroll)?void 0:b.wasRoot)}let im=h$({attachResizeListener:(a,b)=>gE(a,"resize",b),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),io={current:void 0},ip=h$({measureScroll:a=>({x:a.scrollLeft,y:a.scrollTop}),defaultParent:()=>{if(!io.current){let a=new im({});a.mount(window),a.setOptions({layoutScroll:!0}),io.current=a}return io.current},resetTransform:(a,b)=>{a.style.transform=void 0!==b?b:"none"},checkIsScrollRoot:a=>"fixed"===window.getComputedStyle(a).position});function iq(a,b,c){let{props:d}=a;a.animationState&&d.whileHover&&a.animationState.setActive("whileHover","Start"===c);let e=d["onHover"+c];e&&el.postRender(()=>e(b,gF(b)))}function ir(a,b,c){let{props:d}=a;a.animationState&&d.whileTap&&a.animationState.setActive("whileTap","Start"===c);let e=d["onTap"+("End"===c?"":c)];e&&el.postRender(()=>e(b,gF(b)))}let is=new WeakMap,it=new WeakMap,iu=a=>{let b=is.get(a.target);b&&b(a)},iv=a=>{a.forEach(iu)},iw={some:0,all:1},ix=((0,bD.createContext)({strict:!1}),(0,bD.createContext)({transformPagePoint:a=>a,isStatic:!1,reducedMotion:"never"})),iy=(0,bD.createContext)({});function iz(a){return dH(a.animate)||dP.some(b=>dK(a[b]))}function iA(a){return!!(iz(a)||a.variants)}function iB(a){return Array.isArray(a)?a.join(" "):a}let iC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},iD={};for(let a in iC)iD[a]={isEnabled:b=>iC[a].some(a=>!!b[a])};let iE=Symbol.for("motionComponentSymbol"),iF=(bD.useEffect,["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"]);function iG(a){if("string"!=typeof a||a.includes("-"));else if(iF.indexOf(a)>-1||/[A-Z]/u.test(a))return!0;return!1}let iH=a=>(b,c)=>{let d,e=(0,bD.useContext)(iy),f=(0,bD.useContext)(hj),g=()=>(function({scrapeMotionValuesFromProps:a,createRenderState:b,onUpdate:c},d,e,f){let g={latestValues:function(a,b,c,d){let e={},f=d(a,{});for(let a in f)e[a]=hx(f[a]);let{initial:g,animate:h}=a,i=iz(a),j=iA(a);b&&j&&!i&&!1!==a.inherit&&(void 0===g&&(g=b.initial),void 0===h&&(h=b.animate));let k=!!c&&!1===c.initial,l=(k=k||!1===g)?h:g;if(l&&"boolean"!=typeof l&&!dH(l)){let b=Array.isArray(l)?l:[l];for(let c=0;c<b.length;c++){let d=dM(a,b[c]);if(d){let{transitionEnd:a,transition:b,...c}=d;for(let a in c){let b=c[a];if(Array.isArray(b)){let a=k?b.length-1:0;b=b[a]}null!==b&&(e[a]=b)}for(let b in a)e[b]=a[b]}}}return e}(d,e,f,a),renderState:b()};return c&&(g.onMount=a=>c({props:d,current:a,...g}),g.onUpdate=a=>c(a)),g})(a,b,e,f);return c?g():(null===(d=(0,bD.useRef)(null)).current&&(d.current=g()),d.current)},iI=(a,b)=>b&&"number"==typeof a?b.transform(a):a,iJ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},iK=ef.length;function iL(a,b,c){let{style:d,vars:e,transformOrigin:f}=a,g=!1,h=!1;for(let a in b){let c=b[a];if(eg.has(a)){g=!0;continue}if(fA(a)){e[a]=c;continue}{let b=iI(c,fi[a]);a.startsWith("origin")?(h=!0,f[a]=b):d[a]=b}}if(!b.transform&&(g||c?d.transform=function(a,b,c){let d="",e=!0;for(let f=0;f<iK;f++){let g=ef[f],h=a[g];if(void 0===h)continue;let i=!0;if(!(i="number"==typeof h?h===+!!g.startsWith("scale"):0===parseFloat(h))||c){let a=iI(h,fi[g]);if(!i){e=!1;let b=iJ[g]||g;d+=`${b}(${a}) `}c&&(b[g]=a)}}return d=d.trim(),c?d=c(b,e?"":d):e&&(d="none"),d}(b,a.transform,c):d.transform&&(d.transform="none")),h){let{originX:a="50%",originY:b="50%",originZ:c=0}=f;d.transformOrigin=`${a} ${b} ${c}`}}let iM={offset:"stroke-dashoffset",array:"stroke-dasharray"},iN={offset:"strokeDashoffset",array:"strokeDasharray"};function iO(a,b,c){return"string"==typeof a?a:e$.transform(b+c*a)}function iP(a,{attrX:b,attrY:c,attrScale:d,originX:e,originY:f,pathLength:g,pathSpacing:h=1,pathOffset:i=0,...j},k,l){let m,n;if(iL(a,j,l),k){a.style.viewBox&&(a.attrs.viewBox=a.style.viewBox);return}a.attrs=a.style,a.style={};let{attrs:o,style:p,dimensions:q}=a;o.transform&&(q&&(p.transform=o.transform),delete o.transform),q&&(void 0!==e||void 0!==f||p.transform)&&(m=iO(void 0!==e?e:.5,q.x,q.width),n=iO(void 0!==f?f:.5,q.y,q.height),p.transformOrigin=`${m} ${n}`),void 0!==b&&(o.x=b),void 0!==c&&(o.y=c),void 0!==d&&(o.scale=d),void 0!==g&&function(a,b,c=1,d=0,e=!0){a.pathLength=1;let f=e?iM:iN;a[f.offset]=e$.transform(-d);let g=e$.transform(b),h=e$.transform(c);a[f.array]=`${g} ${h}`}(o,g,h,i,!1)}let iQ=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),iR=()=>({...iQ(),attrs:{}}),iS=a=>"string"==typeof a&&"svg"===a.toLowerCase();function iT(a,{style:b,vars:c},d,e){for(let f in Object.assign(a.style,b,e&&e.getProjectionStyles(d)),c)a.style.setProperty(f,c[f])}let iU=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iV(a,b,c,d){for(let c in iT(a,b,void 0,d),b.attrs)a.setAttribute(iU.has(c)?c:ey(c),b.attrs[c])}function iW(a,{layout:b,layoutId:c}){return eg.has(a)||a.startsWith("origin")||(b||void 0!==c)&&(!!hp[a]||"opacity"===a)}function iX(a,b,c){var d;let{style:e}=a,f={};for(let g in e)(ew(e[g])||b.style&&ew(b.style[g])||iW(g,a)||(null==(d=null==c?void 0:c.getValue(g))?void 0:d.liveStyle)!==void 0)&&(f[g]=e[g]);return f}function iY(a,b,c){let d=iX(a,b,c);for(let c in a)(ew(a[c])||ew(b[c]))&&(d[-1!==ef.indexOf(c)?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c]=a[c]);return d}let iZ=["x","y","width","height","cx","cy","r"],i$={useVisualState:iH({scrapeMotionValuesFromProps:iY,createRenderState:iR,onUpdate:({props:a,prevProps:b,current:c,renderState:d,latestValues:e})=>{if(!c)return;let f=!!a.drag;if(!f){for(let a in e)if(eg.has(a)){f=!0;break}}if(!f)return;let g=!b;if(b)for(let c=0;c<iZ.length;c++){let d=iZ[c];a[d]!==b[d]&&(g=!0)}g&&el.read(()=>{try{d.dimensions="function"==typeof c.getBBox?c.getBBox():c.getBoundingClientRect()}catch(a){d.dimensions={x:0,y:0,width:0,height:0}}el.render(()=>{iP(d,e,iS(c.tagName),a.transformTemplate),iV(c,d)})})}})},i_={useVisualState:iH({scrapeMotionValuesFromProps:iX,createRenderState:iQ})};function i0(a,b,c){for(let d in b)ew(b[d])||iW(d,c)||(a[d]=b[d])}let i1=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function i2(a){return a.startsWith("while")||a.startsWith("drag")&&"draggable"!==a||a.startsWith("layout")||a.startsWith("onTap")||a.startsWith("onPan")||a.startsWith("onLayout")||i1.has(a)}let i3=a=>!i2(a);try{(t=(()=>{let a=Error("Cannot find module '@emotion/is-prop-valid'");throw a.code="MODULE_NOT_FOUND",a})().default)&&(i3=a=>a.startsWith("on")?!i2(a):t(a))}catch(a){}let i4=null,i5={current:!1},i6=[...fG,e3,fc],i7=new WeakMap,i8=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class i9{scrapeMotionValuesFromProps(a,b,c){return{}}constructor({parent:a,props:b,presenceContext:c,reducedMotionConfig:d,blockInitialAnimation:e,visualState:f},g={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=fy,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let a=eq.now();this.renderScheduledAt<a&&(this.renderScheduledAt=a,el.render(this.render,!1,!0))};const{latestValues:h,renderState:i,onUpdate:j}=f;this.onUpdate=j,this.latestValues=h,this.baseTarget={...h},this.initialValues=b.initial?{...h}:{},this.renderState=i,this.parent=a,this.props=b,this.presenceContext=c,this.depth=a?a.depth+1:0,this.reducedMotionConfig=d,this.options=g,this.blockInitialAnimation=!!e,this.isControllingVariants=iz(b),this.isVariantNode=iA(b),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(a&&a.current);const{willChange:k,...l}=this.scrapeMotionValuesFromProps(b,{},this);for(const a in l){const b=l[a];void 0!==h[a]&&ew(b)&&b.set(h[a],!1)}}mount(a){this.current=a,i7.set(a,this),this.projection&&!this.projection.instance&&this.projection.mount(a),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,b)=>this.bindToMotionValue(b,a)),i5.current||(i5.current=!0),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||i4),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let a in i7.delete(this.current),this.projection&&this.projection.unmount(),em(this.notifyUpdate),em(this.render),this.valueSubscriptions.forEach(a=>a()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[a].clear();for(let a in this.features){let b=this.features[a];b&&(b.unmount(),b.isMounted=!1)}this.current=null}bindToMotionValue(a,b){let c;this.valueSubscriptions.has(a)&&this.valueSubscriptions.get(a)();let d=eg.has(a),e=b.on("change",b=>{this.latestValues[a]=b,this.props.onUpdate&&el.preRender(this.notifyUpdate),d&&this.projection&&(this.projection.isTransformDirty=!0)}),f=b.on("renderRequest",this.scheduleRender);window.MotionCheckAppearSync&&(c=window.MotionCheckAppearSync(this,a,b)),this.valueSubscriptions.set(a,()=>{e(),f(),c&&c(),b.owner&&b.stop()})}sortNodePosition(a){return this.current&&this.sortInstanceNodePosition&&this.type===a.type?this.sortInstanceNodePosition(this.current,a.current):0}updateFeatures(){let a="animation";for(a in iD){let b=iD[a];if(!b)continue;let{isEnabled:c,Feature:d}=b;if(!this.features[a]&&d&&c(this.props)&&(this.features[a]=new d(this)),this.features[a]){let b=this.features[a];b.isMounted?b.update():(b.mount(),b.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):g_()}getStaticValue(a){return this.latestValues[a]}setStaticValue(a,b){this.latestValues[a]=b}update(a,b){(a.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=a,this.prevPresenceContext=this.presenceContext,this.presenceContext=b;for(let b=0;b<i8.length;b++){let c=i8[b];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);let d=a["on"+c];d&&(this.propEventSubscriptions[c]=this.on(c,d))}this.prevMotionValues=function(a,b,c){for(let d in b){let e=b[d],f=c[d];if(ew(e))a.addValue(d,e);else if(ew(f))a.addValue(d,ev(e,{owner:a}));else if(f!==e)if(a.hasValue(d)){let b=a.getValue(d);!0===b.liveStyle?b.jump(e):b.hasAnimated||b.set(e)}else{let b=a.getStaticValue(d);a.addValue(d,ev(void 0!==b?b:e,{owner:a}))}}for(let d in c)void 0===b[d]&&a.removeValue(d);return b}(this,this.scrapeMotionValuesFromProps(a,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(a){return this.props.variants?this.props.variants[a]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(a){let b=this.getClosestVariantNode();if(b)return b.variantChildren&&b.variantChildren.add(a),()=>b.variantChildren.delete(a)}addValue(a,b){let c=this.values.get(a);b!==c&&(c&&this.removeValue(a),this.bindToMotionValue(a,b),this.values.set(a,b),this.latestValues[a]=b.get())}removeValue(a){this.values.delete(a);let b=this.valueSubscriptions.get(a);b&&(b(),this.valueSubscriptions.delete(a)),delete this.latestValues[a],this.removeValueFromRenderState(a,this.renderState)}hasValue(a){return this.values.has(a)}getValue(a,b){if(this.props.values&&this.props.values[a])return this.props.values[a];let c=this.values.get(a);return void 0===c&&void 0!==b&&(c=ev(null===b?void 0:b,{owner:this}),this.addValue(a,c)),c}readValue(a,b){var c;let d=void 0===this.latestValues[a]&&this.current?null!=(c=this.getBaseTargetFromProps(this.props,a))?c:this.readValueFromInstance(this.current,a,this.options):this.latestValues[a];if(null!=d){let c,e;if("string"==typeof d&&(c=d,/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(c)||(e=d,/^0[^.\s]+$/u.test(e))))d=parseFloat(d);else{let c;c=d,!i6.find(fF(c))&&fc.test(b)&&(d=fl(a,b))}this.setBaseTarget(a,ew(d)?d.get():d)}return ew(d)?d.get():d}setBaseTarget(a,b){this.baseTarget[a]=b}getBaseTarget(a){var b;let c,{initial:d}=this.props;if("string"==typeof d||"object"==typeof d){let e=dM(this.props,d,null==(b=this.presenceContext)?void 0:b.custom);e&&(c=e[a])}if(d&&void 0!==c)return c;let e=this.getBaseTargetFromProps(this.props,a);return void 0===e||ew(e)?void 0!==this.initialValues[a]&&void 0===c?void 0:this.baseTarget[a]:e}on(a,b){return this.events[a]||(this.events[a]=new et),this.events[a].add(b)}notify(a,...b){this.events[a]&&this.events[a].notify(...b)}}class ja extends i9{constructor(){super(...arguments),this.KeyframeResolver=fI}sortInstanceNodePosition(a,b){return 2&a.compareDocumentPosition(b)?1:-1}getBaseTargetFromProps(a,b){return a.style?a.style[b]:void 0}removeValueFromRenderState(a,{vars:b,style:c}){delete b[a],delete c[a]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:a}=this.props;ew(a)&&(this.childSubscription=a.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}class jb extends ja{constructor(){super(...arguments),this.type="html",this.renderInstance=iT}readValueFromInstance(a,b){if(eg.has(b)){let a=fk(b);return a&&a.default||0}{let c=window.getComputedStyle(a),d=(fA(b)?c.getPropertyValue(b):c[b])||0;return"string"==typeof d?d.trim():d}}measureInstanceViewportBox(a,{transformPagePoint:b}){return hc(a,b)}build(a,b,c){iL(a,b,c.transformTemplate)}scrapeMotionValuesFromProps(a,b,c){return iX(a,b,c)}}class jc extends ja{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=g_}getBaseTargetFromProps(a,b){return a[b]}readValueFromInstance(a,b){if(eg.has(b)){let a=fk(b);return a&&a.default||0}return b=iU.has(b)?b:ey(b),a.getAttribute(b)}scrapeMotionValuesFromProps(a,b,c){return iY(a,b,c)}build(a,b,c){iP(a,b,this.isSVGTag,c.transformTemplate)}renderInstance(a,b,c,d){iV(a,b,c,d)}mount(a){this.isSVGTag=iS(a.tagName),super.mount(a)}}let jd=function(a){if("undefined"==typeof Proxy)return a;let b=new Map;return new Proxy((...b)=>a(...b),{get:(c,d)=>"create"===d?a:(b.has(d)||b.set(d,a(d)),b.get(d))})}((u={animation:{Feature:class extends gC{constructor(a){super(a),a.animationState||(a.animationState=function(a){let b=b=>Promise.all(b.map(({animation:b,options:c})=>(function(a,b,c={}){let d;if(a.notify("AnimationStart",b),Array.isArray(b))d=Promise.all(b.map(b=>gv(a,b,c)));else if("string"==typeof b)d=gv(a,b,c);else{let e="function"==typeof b?dN(a,b,c.custom):b;d=Promise.all(gu(a,e,c))}return d.then(()=>{a.notify("AnimationComplete",b)})})(a,b,c))),c=gB(),d=!0,e=b=>(c,d)=>{var e;let f=dN(a,d,"exit"===b?null==(e=a.presenceContext)?void 0:e.custom:void 0);if(f){let{transition:a,transitionEnd:b,...d}=f;c={...c,...d,...b}}return c};function f(f){let{props:g}=a,h=function a(b){if(!b)return;if(!b.isControllingVariants){let c=b.parent&&a(b.parent)||{};return void 0!==b.props.initial&&(c.initial=b.props.initial),c}let c={};for(let a=0;a<gx;a++){let d=dP[a],e=b.props[d];(dK(e)||!1===e)&&(c[d]=e)}return c}(a.parent)||{},i=[],j=new Set,k={},l=1/0;for(let b=0;b<gz;b++){var m,n;let o=gy[b],p=c[o],q=void 0!==g[o]?g[o]:h[o],r=dK(q),s=o===f?p.isActive:null;!1===s&&(l=b);let t=q===h[o]&&q!==g[o]&&r;if(t&&d&&a.manuallyAnimateOnMount&&(t=!1),p.protectedKeys={...k},!p.isActive&&null===s||!q&&!p.prevProp||dH(q)||"boolean"==typeof q)continue;let u=(m=p.prevProp,"string"==typeof(n=q)?n!==m:!!Array.isArray(n)&&!dJ(n,m)),v=u||o===f&&p.isActive&&!t&&r||b>l&&r,w=!1,x=Array.isArray(q)?q:[q],y=x.reduce(e(o),{});!1===s&&(y={});let{prevResolvedValues:z={}}=p,A={...z,...y},B=b=>{v=!0,j.has(b)&&(w=!0,j.delete(b)),p.needsAnimating[b]=!0;let c=a.getValue(b);c&&(c.liveStyle=!1)};for(let a in A){let b=y[a],c=z[a];if(!k.hasOwnProperty(a))(dI(b)&&dI(c)?dJ(b,c):b===c)?void 0!==b&&j.has(a)?B(a):p.protectedKeys[a]=!0:null!=b?B(a):j.add(a)}p.prevProp=q,p.prevResolvedValues=y,p.isActive&&(k={...k,...y}),d&&a.blockInitialAnimation&&(v=!1);let C=!(t&&u)||w;v&&C&&i.push(...x.map(a=>({animation:a,options:{type:o}})))}if(j.size){let b={};j.forEach(c=>{let d=a.getBaseTarget(c),e=a.getValue(c);e&&(e.liveStyle=!0),b[c]=null!=d?d:null}),i.push({animation:b})}let o=!!i.length;return d&&(!1===g.initial||g.initial===g.animate)&&!a.manuallyAnimateOnMount&&(o=!1),d=!1,o?b(i):Promise.resolve()}return{animateChanges:f,setActive:function(b,d){var e;if(c[b].isActive===d)return Promise.resolve();null==(e=a.variantChildren)||e.forEach(a=>{var c;return null==(c=a.animationState)?void 0:c.setActive(b,d)}),c[b].isActive=d;let g=f(b);for(let a in c)c[a].protectedKeys={};return g},setAnimateFunction:function(c){b=c(a)},getState:()=>c,reset:()=>{c=gB(),d=!0}}}(a))}updateAnimationControlsSubscription(){let{animate:a}=this.node.getProps();dH(a)&&(this.unmountControls=a.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:a}=this.node.getProps(),{animate:b}=this.node.prevProps||{};a!==b&&this.updateAnimationControlsSubscription()}unmount(){var a;this.node.animationState.reset(),null==(a=this.unmountControls)||a.call(this)}}},exit:{Feature:class extends gC{constructor(){super(...arguments),this.id=gD++}update(){if(!this.node.presenceContext)return;let{isPresent:a,onExitComplete:b}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||a===c)return;let d=this.node.animationState.setActive("exit",!a);b&&!a&&d.then(()=>b(this.id))}mount(){let{register:a}=this.node.presenceContext||{};a&&(this.unmount=a(this.id))}unmount(){}}},inView:{Feature:class extends gC{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){var a;let b;this.unmount();let{viewport:c={}}=this.node.getProps(),{root:d,margin:e,amount:f="some",once:g}=c,h={root:d?d.current:void 0,rootMargin:e,threshold:"number"==typeof f?f:iw[f]},i=a=>{let{isIntersecting:b}=a;if(this.isInView===b||(this.isInView=b,g&&!b&&this.hasEnteredView))return;b&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",b);let{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),e=b?c:d;e&&e(a)};return a=this.node.current,b=function({root:a,...b}){let c=a||document;it.has(c)||it.set(c,{});let d=it.get(c),e=JSON.stringify(b);return d[e]||(d[e]=new IntersectionObserver(iv,{root:a,...b})),d[e]}(h),is.set(a,i),b.observe(a),()=>{is.delete(a),b.unobserve(a)}}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:a,prevProps:b}=this.node;["amount","margin","root"].some(function({viewport:a={}},{viewport:b={}}={}){return c=>a[c]!==b[c]}(a,b))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends gC{mount(){let{current:a}=this.node;a&&(this.unmount=function(a,b,c={}){let[d,e,f]=d6(a,c),g=a=>{let d=a.currentTarget;if(!ee(a)||eb.has(d))return;eb.add(d);let f=b(a),g=(a,b)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",i),ee(a)&&eb.has(d)&&(eb.delete(d),"function"==typeof f&&f(a,{success:b}))},h=a=>{g(a,c.useGlobalTarget||d8(d,a.target))},i=a=>{g(a,!1)};window.addEventListener("pointerup",h,e),window.addEventListener("pointercancel",i,e)};return d.forEach(a=>{ea.has(a.tagName)||-1!==a.tabIndex||null!==a.getAttribute("tabindex")||(a.tabIndex=0),(c.useGlobalTarget?window:a).addEventListener("pointerdown",g,e),a.addEventListener("focus",a=>((a,b)=>{let c=a.currentTarget;if(!c)return;let d=ec(()=>{if(eb.has(c))return;ed(c,"down");let a=ec(()=>{ed(c,"up")});c.addEventListener("keyup",a,b),c.addEventListener("blur",()=>ed(c,"cancel"),b)});c.addEventListener("keydown",d,b),c.addEventListener("blur",()=>c.removeEventListener("keydown",d),b)})(a,e),e)}),f}(a,a=>(ir(this.node,a,"Start"),(a,{success:b})=>ir(this.node,a,b?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends gC{constructor(){super(...arguments),this.isActive=!1}onFocus(){let a=!1;try{a=this.node.current.matches(":focus-visible")}catch(b){a=!0}a&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fV(gE(this.node.current,"focus",()=>this.onFocus()),gE(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends gC{mount(){let{current:a}=this.node;a&&(this.unmount=function(a,b,c={}){let[d,e,f]=d6(a,c),g=d7(a=>{let{target:c}=a,d=b(a);if("function"!=typeof d||!c)return;let f=d7(a=>{d(a),c.removeEventListener("pointerleave",f)});c.addEventListener("pointerleave",f,e)});return d.forEach(a=>{a.addEventListener("pointerenter",g,e)}),f}(a,a=>(iq(this.node,a,"Start"),a=>iq(this.node,a,"End"))))}unmount(){}}},pan:{Feature:class extends gC{constructor(){super(...arguments),this.removePointerDownListener=dQ}onPointerDown(a){this.session=new gI(a,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:hd(this.node)})}createPanHandlers(){let{onPanSessionStart:a,onPanStart:b,onPan:c,onPanEnd:d}=this.node.getProps();return{onSessionStart:hh(a),onStart:hh(b),onMove:c,onEnd:(a,b)=>{delete this.session,d&&el.postRender(()=>d(a,b))}}}mount(){this.removePointerDownListener=gG(this.node.current,"pointerdown",a=>this.onPointerDown(a))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends gC{constructor(a){super(a),this.removeGroupControls=dQ,this.removeListeners=dQ,this.controls=new hf(a)}mount(){let{dragControls:a}=this.node.getProps();a&&(this.removeGroupControls=a.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||dQ}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:ip,MeasureLayout:ht},layout:{ProjectionNode:ip,MeasureLayout:ht}},v=(a,b)=>iG(a)?new jc(b):new jb(b,{allowProjection:a!==bD.Fragment}),function(a,{forwardMotionProps:b}={forwardMotionProps:!1}){return function({preloadedFeatures:a,createVisualElement:b,useRender:c,useVisualState:d,Component:e}){var f,g;function h(a,b){var f;let g,h={...(0,bD.useContext)(ix),...a,layoutId:function({layoutId:a}){let b=(0,bD.useContext)(hk).id;return b&&void 0!==a?b+"-"+a:a}(a)},{isStatic:i}=h,j=function(a){let{initial:b,animate:c}=function(a,b){if(iz(a)){let{initial:b,animate:c}=a;return{initial:!1===b||dK(b)?b:void 0,animate:dK(c)?c:void 0}}return!1!==a.inherit?b:{}}(a,(0,bD.useContext)(iy));return(0,bD.useMemo)(()=>({initial:b,animate:c}),[iB(b),iB(c)])}(a),k=d(a,i);return(0,bC.jsxs)(iy.Provider,{value:j,children:[g&&j.visualElement?(0,bC.jsx)(g,{visualElement:j.visualElement,...h}):null,c(e,a,(f=j.visualElement,(0,bD.useCallback)(a=>{a&&k.onMount&&k.onMount(a),f&&(a?f.mount(a):f.unmount()),b&&("function"==typeof b?b(a):gN(b)&&(b.current=a))},[f])),k,i,j.visualElement)]})}a&&function(a){for(let b in a)iD[b]={...iD[b],...a[b]}}(a),h.displayName=`motion.${"string"==typeof e?e:`create(${null!=(g=null!=(f=e.displayName)?f:e.name)?g:""})`}`;let i=(0,bD.forwardRef)(h);return i[iE]=e,i}({...iG(a)?i$:i_,preloadedFeatures:u,useRender:function(a=!1){return(b,c,d,{latestValues:e},f)=>{let g=(iG(b)?function(a,b,c,d){let e=(0,bD.useMemo)(()=>{let c=iR();return iP(c,b,iS(d),a.transformTemplate),{...c.attrs,style:{...c.style}}},[b]);if(a.style){let b={};i0(b,a.style,a),e.style={...b,...e.style}}return e}:function(a,b){let c,d,e={},f=(c=a.style||{},i0(d={},c,a),Object.assign(d,function({transformTemplate:a},b){return(0,bD.useMemo)(()=>{let c=iQ();return iL(c,b,a),Object.assign({},c.vars,c.style)},[b])}(a,b)),d);return a.drag&&!1!==a.dragListener&&(e.draggable=!1,f.userSelect=f.WebkitUserSelect=f.WebkitTouchCallout="none",f.touchAction=!0===a.drag?"none":`pan-${"x"===a.drag?"y":"x"}`),void 0===a.tabIndex&&(a.onTap||a.onTapStart||a.whileTap)&&(e.tabIndex=0),e.style=f,e})(c,e,f,b),h=function(a,b,c){let d={};for(let e in a)("values"!==e||"object"!=typeof a.values)&&(i3(e)||!0===c&&i2(e)||!b&&!i2(e)||a.draggable&&e.startsWith("onDrag"))&&(d[e]=a[e]);return d}(c,"string"==typeof b,a),i=b!==bD.Fragment?{...h,...g,ref:d}:{},{children:j}=c,k=(0,bD.useMemo)(()=>ew(j)?j.get():j,[j]);return(0,bD.createElement)(b,{...i,children:k})}}(b),createVisualElement:v,Component:a})})),je=({children:a,className:b="",title:c,icon:d,glowColor:e="rgba(115, 42, 223, 0.5)",colSpan:f="col-span-1",rowSpan:g="row-span-1",...h})=>(0,bC.jsxs)(jd.div,{className:`
        relative group overflow-hidden rounded-3xl 
        bg-nexus-glass border border-nexus-glassBorder 
        backdrop-blur-xl transition-all duration-300 ease-out
        hover:scale-[1.01] hover:shadow-2xl hover:border-nexus-purple/30
        flex flex-col
        ${f} ${g} ${b}
      `,style:{boxShadow:"0 0 0 1px inset rgba(255,255,255,0.05)"},...h,children:[(0,bC.jsx)("div",{className:"absolute -top-20 -right-20 w-64 h-64 rounded-full blur-[80px] opacity-20 group-hover:opacity-40 transition-opacity duration-500 pointer-events-none",style:{background:e}}),(c||d)&&(0,bC.jsxs)("div",{className:"flex items-center gap-3 p-5 pb-2 z-10",children:[d&&(0,bC.jsx)("div",{className:"text-nexus-teal",children:d}),c&&(0,bC.jsx)("h3",{className:"text-lg font-semibold tracking-wide text-white/90 font-sans",children:c})]}),(0,bC.jsx)("div",{className:"flex-1 p-5 z-10 overflow-hidden relative",children:a}),(0,bC.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none bg-gradient-to-tr from-transparent via-white/5 to-transparent"})]}),jf=bI("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),jg=bI("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),jh=bI("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ji=bI("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),jj=({searchQuery:a=""})=>{let[b,c]=(0,bD.useState)(new Date),[d,e]=(0,bD.useState)(new Date),[f,g]=(0,bD.useState)([{id:"1",title:"Web Dev Lecture",startTime:new Date,endTime:new Date(new Date().setHours(new Date().getHours()+2)),type:"lecture"},{id:"2",title:"Team Meeting",startTime:new Date(new Date().setDate(new Date().getDate()+1)),endTime:new Date(new Date().setDate(new Date().getDate()+1)),type:"meeting"},{id:"3",title:"Project Deadline",startTime:new Date(new Date().getFullYear(),11,25),endTime:new Date(new Date().getFullYear(),11,25),type:"personal"}]),[h,i]=(0,bD.useState)(!1),[j,k]=(0,bD.useState)(""),[l,m]=(0,bD.useState)("personal"),n=a=>{c(new Date(b.getFullYear(),b.getMonth()+a,1))},o=a=>{c(new Date(b.getFullYear()+a,b.getMonth(),1))},p=(a,b)=>a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate(),q=()=>{if(!j.trim())return;let a=new Date(d);a.setHours(9,0,0);let b=new Date(d);b.setHours(10,0,0),g([...f,{id:Date.now().toString(),title:j,startTime:a,endTime:b,type:l}]),k(""),i(!1)},r=f.filter(b=>p(new Date(b.startTime),d)&&(!a||b.title.toLowerCase().includes(a.toLowerCase()))),s=new Date(b.getFullYear(),b.getMonth()+1,0).getDate(),t=[...Array(new Date(b.getFullYear(),b.getMonth(),1).getDay()).fill(null),...Array.from({length:s},(a,b)=>b+1)];return(0,bC.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,bC.jsxs)("div",{className:"flex flex-col gap-2 mb-4 shrink-0",children:[(0,bC.jsxs)("div",{className:"flex items-center justify-between bg-white/5 rounded-xl p-2 border border-white/5",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-1",children:[(0,bC.jsx)("button",{onClick:()=>n(-1),className:"p-1 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:(0,bC.jsx)(jf,{size:16})}),(0,bC.jsx)("span",{className:"text-sm font-bold w-24 text-center text-white select-none",children:["January","February","March","April","May","June","July","August","September","October","November","December"][b.getMonth()]}),(0,bC.jsx)("button",{onClick:()=>n(1),className:"p-1 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:(0,bC.jsx)(jg,{size:16})})]}),(0,bC.jsx)("div",{className:"h-4 w-px bg-white/10"}),(0,bC.jsxs)("div",{className:"flex items-center gap-1",children:[(0,bC.jsx)("button",{onClick:()=>o(-1),className:"p-1 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:(0,bC.jsx)(jf,{size:16})}),(0,bC.jsx)("span",{className:"text-sm font-mono font-bold text-nexus-teal w-12 text-center select-none",children:b.getFullYear()}),(0,bC.jsx)("button",{onClick:()=>o(1),className:"p-1 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:(0,bC.jsx)(jg,{size:16})})]})]}),(0,bC.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center mt-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(a=>(0,bC.jsx)("div",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-wider",children:a},a))})]}),(0,bC.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-6 shrink-0",children:t.map((a,c)=>{if(!a)return(0,bC.jsx)("div",{className:"h-8"},`blank-${c}`);let g=new Date(b.getFullYear(),b.getMonth(),a),h=p(g,new Date),j=p(g,d),k=f.some(a=>p(new Date(a.startTime),g));return(0,bC.jsxs)("div",{onClick:()=>{e(new Date(b.getFullYear(),b.getMonth(),a)),i(!1)},className:`
                        h-8 flex flex-col items-center justify-center rounded-lg cursor-pointer transition-all relative group
                        ${j?"bg-nexus-purple text-white shadow-[0_0_10px_rgba(115,42,223,0.4)] scale-105 z-10 font-bold":h?"bg-nexus-teal/20 text-nexus-teal border border-nexus-teal/50":"text-gray-400 hover:bg-white/10 hover:text-white"}
                    `,children:[(0,bC.jsx)("span",{className:"text-xs",children:a}),k&&!j&&(0,bC.jsx)("div",{className:"absolute bottom-1 w-1 h-1 rounded-full bg-nexus-teal"})]},a)})}),(0,bC.jsx)("div",{className:"h-px w-full bg-white/10 mb-4 shrink-0"}),(0,bC.jsxs)("div",{className:"flex items-center justify-between mb-3 shrink-0",children:[(0,bC.jsxs)("h4",{className:"text-xs uppercase tracking-widest text-gray-500 font-bold flex items-center gap-2",children:[(0,bC.jsx)(bJ,{size:12}),d.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]}),!h&&(0,bC.jsxs)("button",{onClick:()=>i(!0),className:"text-[10px] bg-nexus-teal/10 text-nexus-teal hover:bg-nexus-teal hover:text-black px-2 py-1 rounded-md transition-all font-bold flex items-center gap-1",children:[(0,bC.jsx)(bU,{size:10})," Add"]})]}),(0,bC.jsxs)("div",{className:"flex-1 overflow-y-auto pr-1 custom-scrollbar",children:[h&&(0,bC.jsxs)("div",{className:"bg-white/5 rounded-xl p-3 mb-3 border border-nexus-teal/30 animate-fade-in",children:[(0,bC.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,bC.jsx)("span",{className:"text-[10px] text-nexus-teal font-bold uppercase",children:"New Entry"}),(0,bC.jsx)("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-white",children:(0,bC.jsx)(bQ,{size:12})})]}),(0,bC.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),placeholder:"Event title...",className:"w-full bg-black/20 border border-white/10 rounded-lg px-2 py-1.5 text-sm text-white focus:border-nexus-teal outline-none mb-2",autoFocus:!0,onKeyDown:a=>"Enter"===a.key&&q()}),(0,bC.jsx)("div",{className:"flex gap-2 mb-2",children:["lecture","meeting","personal"].map(a=>(0,bC.jsx)("button",{onClick:()=>m(a),className:`px-2 py-1 rounded text-[9px] uppercase font-bold border ${l===a?"bg-nexus-purple text-white border-nexus-purple":"bg-transparent text-gray-500 border-white/10"}`,children:a},a))}),(0,bC.jsx)("button",{onClick:q,className:"w-full bg-nexus-teal text-nexus-deep text-xs font-bold py-1.5 rounded-lg hover:bg-white transition-colors",children:"Confirm Schedule"})]}),r.length>0?(0,bC.jsx)("div",{className:"space-y-2",children:r.map(a=>(0,bC.jsxs)("div",{className:"relative pl-4 border-l-2 border-nexus-teal/30 hover:border-nexus-teal transition-all group bg-white/5 hover:bg-white/10 rounded-r-lg p-2",children:[(0,bC.jsx)("div",{className:"absolute -left-[5px] top-2 w-2 h-2 rounded-full bg-nexus-teal shadow-[0_0_8px_#65BBBD] group-hover:scale-125 transition-transform"}),(0,bC.jsxs)("div",{className:"flex justify-between items-start",children:[(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h5",{className:"text-sm font-semibold text-gray-200 group-hover:text-white transition-colors",children:a.title}),(0,bC.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,bC.jsxs)("span",{className:"text-[10px] text-nexus-purple font-mono flex items-center gap-1",children:[(0,bC.jsx)(jh,{size:10}),a.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,bC.jsx)("span",{className:"text-[9px] uppercase font-bold tracking-wider text-gray-500 border border-white/10 px-1.5 rounded",children:a.type})]})]}),(0,bC.jsx)("button",{onClick:b=>{var c;return c=a.id,void(b.stopPropagation(),g(f.filter(a=>a.id!==c)))},className:"opacity-0 group-hover:opacity-100 p-1.5 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded transition-all",children:(0,bC.jsx)(ji,{size:12})})]})]},a.id))}):!h&&(0,bC.jsxs)("div",{className:"h-32 flex flex-col items-center justify-center text-gray-600 border border-dashed border-white/10 rounded-xl",children:[(0,bC.jsx)(bJ,{size:24,className:"mb-2 opacity-50"}),(0,bC.jsx)("span",{className:"text-xs italic",children:"No timeline entries."}),(0,bC.jsx)("button",{onClick:()=>i(!0),className:"mt-2 text-[10px] text-nexus-teal hover:underline",children:"Create Event"})]})]})]})},jk=bI("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),jl=bI("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),jm=bI("bell-ring",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]]),jn=bI("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),jo=bI("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]),jp=bI("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),jq=bI("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),jr=bI("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),js=bI("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),jt=bI("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),ju=bI("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),jv=bI("arrow-up-narrow-wide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),jw=bI("arrow-down-narrow-wide",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]]),jx=bI("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),jy=bI("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),jz=bI("alarm-clock",[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M12 9v4l2 2",key:"1c63tq"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}]]),jA=bI("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),jB=({searchQuery:a="",widgetSize:b})=>{let[c,d]=(0,bD.useState)([{id:"1",title:"Complete Project Report",description:"Finalize the executive summary, check formatted tables, and export to PDF for submission.",deadline:new Date(Date.now()+864e5),completed:!1,priority:"high",tags:["uni"]},{id:"2",title:"Review Calculus III",description:"Focus on partial derivatives and multiple integrals. Chapter 4 & 5 practice problems.",deadline:new Date(Date.now()-864e5),completed:!1,priority:"medium",tags:["study"]},{id:"3",title:"Buy Groceries",description:"Milk, Eggs, Bread, Coffee beans.",deadline:new Date(Date.now()+1728e5),completed:!0,priority:"low",tags:["personal"]},{id:"4",title:"System Backup",description:"Run full incremental backup to NAS.",deadline:new Date(Date.now()+432e6),completed:!1,priority:"low",tags:["tech"]}]),[e,f]=(0,bD.useState)(""),[g,h]=(0,bD.useState)(""),[i,j]=(0,bD.useState)("medium"),[k,l]=(0,bD.useState)(""),[m,n]=(0,bD.useState)(""),[o,p]=(0,bD.useState)(!1),[q,r]=(0,bD.useState)("active"),[s,t]=(0,bD.useState)("all"),[u,v]=(0,bD.useState)("none"),[w,x]=(0,bD.useState)("asc"),[y,z]=(0,bD.useState)(!1),[A,B]=(0,bD.useState)(null),C=b&&1===b.rows,D=b&&1===b.cols;(0,bD.useEffect)(()=>{},[]),(0,bD.useEffect)(()=>{let a=setInterval(()=>{let a=new Date;d(b=>{let c=!1,d=b.map(b=>b.reminderTime&&!b.reminderSent&&new Date(b.reminderTime)<=a?(console.log("Reminder triggered:",b.title),c=!0,{...b,reminderSent:!0}):b);return c?d:b})},5e3);return()=>clearInterval(a)},[]),(0,bD.useEffect)(()=>{A&&!c.find(a=>a.id===A)&&B(null)},[c,A]);let E=a=>{d(c.map(b=>b.id===a?{...b,completed:!b.completed}:b))},F=()=>{let a;if(!e.trim())return;if(g){let[b,c,d]=g.split("-").map(Number);a=new Date(b,c-1,d,23,59,59)}else(a=new Date).setDate(a.getDate()+1),a.setHours(23,59,59);let b=e,o=[],q=e.match(/#(\w+)/g);q&&(q.forEach(a=>o.push(a.substring(1))),b=e.replace(/#(\w+)/g,"").trim()),k.trim()&&o.push(k.trim()),d([{id:Date.now().toString(),title:b,description:"",deadline:a,completed:!1,priority:i,tags:o,reminderTime:m?new Date(m):void 0,reminderSent:!1},...c]),f(""),h(""),j("medium"),l(""),n(""),p(!1)},G=(0,bD.useMemo)(()=>c.find(a=>a.id===A),[c,A]),H=(0,bD.useMemo)(()=>{let a=new Set;return c.forEach(b=>b.tags.forEach(b=>a.add(b))),Array.from(a)},[c]),I=(0,bD.useMemo)(()=>{let b=[...c];if(a){let c=a.toLowerCase();b=b.filter(a=>a.title.toLowerCase().includes(c)||a.description&&a.description.toLowerCase().includes(c)||a.tags.some(a=>a.toLowerCase().includes(c)))}return"active"===q?b=b.filter(a=>!a.completed):"completed"===q&&(b=b.filter(a=>a.completed)),"all"!==s&&(b=b.filter(a=>a.tags.includes(s))),"none"!==u&&b.sort((a,b)=>{let c=0;if("deadline"===u)c=a.deadline.getTime()-b.deadline.getTime();else if("priority"===u){let d={high:3,medium:2,low:1};c=d[a.priority]-d[b.priority]}return"asc"===w?c:-c}),b},[c,a,q,s,u,w]),J=a=>{u===a?"asc"===w?x("desc"):v("none"):(v(a),x("asc"))},K=a=>{switch(a){case"high":return(0,bC.jsx)(jq,{size:10});case"medium":default:return(0,bC.jsx)(jt,{size:10});case"low":return(0,bC.jsx)(js,{size:10})}},L=a=>{switch(a){case"high":return"text-amber-400 bg-amber-400/10 border-amber-400/20";case"medium":return"text-nexus-teal bg-nexus-teal/10 border-nexus-teal/20";case"low":return"text-green-400 bg-green-400/10 border-green-400/20";default:return"text-gray-400"}},M=a=>{let b=!a.completed&&new Date>a.deadline,c="high"===a.priority,d=!!a.reminderTime,e="hover:bg-white/5 border-l-2 border-transparent hover:border-nexus-purple/50 transition-all duration-300 ease-out",f="text-white transition-all duration-300",g=(0,bC.jsx)(jl,{size:18,className:"text-gray-500 group-hover:text-nexus-purple transition-colors duration-300"}),h="scale-100 transition-transform duration-300";return a.completed?(f="text-green-400 decoration-slate-500 line-through opacity-60",g=(0,bC.jsx)(jk,{size:18,className:"text-nexus-teal"}),e="bg-green-500/5 border-l-2 border-green-500/30 opacity-70 hover:opacity-100 transition-all duration-300",h="scale-110"):b?(e="bg-gradient-to-r from-red-900/20 to-transparent border-l-2 border-red-500 transition-all duration-300",f="text-red-200",g=(0,bC.jsx)(jp,{size:18,className:"text-red-500 animate-pulse"})):c&&(e="bg-gradient-to-r from-amber-500/10 to-transparent border-l-2 border-amber-500 transition-all duration-300",f="text-amber-100",g=(0,bC.jsx)(jr,{size:18,className:"text-amber-400 fill-amber-400/20"})),(0,bC.jsxs)("div",{className:`group flex items-center gap-3 rounded-r-lg cursor-pointer ${e} ${C?"p-1.5":"p-3"}`,onClick:()=>B(a.id),children:[(0,bC.jsx)("div",{className:`${h} hover:opacity-80`,onClick:b=>{b.stopPropagation(),E(a.id)},children:g}),(0,bC.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,bC.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[(0,bC.jsx)("p",{className:`text-sm font-medium truncate ${f}`,children:a.title}),(0,bC.jsxs)("div",{className:"flex gap-1 shrink-0 items-center",children:[!D&&a.tags.map(a=>(0,bC.jsxs)("span",{className:"hidden sm:inline-block px-1 py-0.5 rounded bg-white/5 text-[8px] text-gray-400 border border-white/5",children:["#",a]},a)),b&&(0,bC.jsxs)(bC.Fragment,{children:[(0,bC.jsx)("button",{onClick:b=>{b.stopPropagation(),alert(`Manual Reminder: "${a.title}" is currently due!`)},className:"p-1 hover:bg-red-500/20 text-red-400 rounded-full transition-colors hidden group-hover:block",title:"Trigger Notification",children:(0,bC.jsx)(jm,{size:12,className:"animate-pulse"})}),(0,bC.jsxs)("span",{className:"flex items-center gap-1 text-[9px] text-red-200 bg-red-900/60 px-2 py-0.5 rounded-full border border-red-500/30 uppercase tracking-wider font-bold shadow-[0_0_10px_rgba(220,38,38,0.2)]",children:[(0,bC.jsx)(jn,{size:10})," Late"]})]}),d&&!a.completed&&(0,bC.jsxs)("span",{className:`flex items-center gap-1 text-[9px] px-1.5 py-0.5 rounded border border-nexus-teal/30 uppercase tracking-wider font-bold ${a.reminderSent?"text-gray-500 bg-gray-800/50":"text-nexus-teal bg-nexus-teal/10"}`,title:`Reminder set for: ${a.reminderTime?.toLocaleString()}`,children:[(0,bC.jsx)(jz,{size:10}),!D&&(a.reminderSent?"Sent":"Set")]})]})]}),(0,bC.jsxs)("p",{className:"text-[10px] text-gray-500 font-mono flex items-center gap-2 mt-0.5",children:[(0,bC.jsxs)("span",{className:`flex items-center gap-1 ${b?"text-red-300":""}`,children:[(0,bC.jsx)(jo,{size:10}),a.deadline.toLocaleDateString()]}),(0,bC.jsx)("span",{className:"text-gray-600",children:"â¢"}),(0,bC.jsxs)("span",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded border text-[9px] font-bold uppercase tracking-wider ${L(a.priority)}`,children:[K(a.priority)," ",a.priority]})]})]})]},a.id)};return(0,bC.jsxs)("div",{className:"flex flex-col h-full relative",children:[G&&(0,bC.jsxs)("div",{className:"absolute inset-0 bg-[#0C0C11]/95 backdrop-blur-xl z-20 flex flex-col p-4 animate-fade-in rounded-3xl border border-white/10 shadow-2xl",children:[(0,bC.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,bC.jsx)("h3",{className:"text-lg font-bold text-white leading-tight pr-4",children:G.title}),(0,bC.jsx)("button",{onClick:()=>B(null),className:"p-1 hover:bg-white/10 rounded-full text-gray-400 hover:text-white transition-colors",children:(0,bC.jsx)(bQ,{size:20})})]}),(0,bC.jsxs)("div",{className:"space-y-4 flex-1 overflow-y-auto pr-1 custom-scrollbar",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-3",children:[(0,bC.jsxs)("span",{className:`flex items-center gap-1 px-2 py-1 rounded border text-xs font-bold uppercase tracking-wider ${L(G.priority)}`,children:[K(G.priority)," ",G.priority," Priority"]}),G.completed?(0,bC.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 rounded border text-xs font-bold uppercase tracking-wider text-green-400 bg-green-400/10 border-green-400/20",children:[(0,bC.jsx)(jk,{size:12})," Completed"]}):(0,bC.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 rounded border text-xs font-bold uppercase tracking-wider text-gray-400 bg-gray-400/10 border-gray-400/20",children:[(0,bC.jsx)(jl,{size:12})," Pending"]})]}),(0,bC.jsxs)("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5",children:[(0,bC.jsxs)("h4",{className:"text-[10px] uppercase text-gray-500 font-bold mb-2 flex items-center gap-2",children:[(0,bC.jsx)(jA,{size:12})," Description"]}),(0,bC.jsx)("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap",children:G.description||"No additional details provided for this mission."})]}),(0,bC.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,bC.jsxs)("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5",children:[(0,bC.jsxs)("h4",{className:"text-[10px] uppercase text-gray-500 font-bold mb-1 flex items-center gap-2",children:[(0,bC.jsx)(jo,{size:12})," Deadline"]}),(0,bC.jsx)("p",{className:"text-sm text-white font-mono",children:G.deadline.toLocaleString()})]}),(0,bC.jsxs)("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5",children:[(0,bC.jsxs)("h4",{className:"text-[10px] uppercase text-gray-500 font-bold mb-1 flex items-center gap-2",children:[(0,bC.jsx)(jx,{size:12})," Tags"]}),(0,bC.jsx)("div",{className:"flex flex-wrap gap-1",children:G.tags.length>0?G.tags.map(a=>(0,bC.jsxs)("span",{className:"text-xs bg-nexus-purple/20 text-nexus-purple px-1.5 py-0.5 rounded border border-nexus-purple/30",children:["#",a]},a)):(0,bC.jsx)("span",{className:"text-xs text-gray-500 italic",children:"None"})})]})]}),G.reminderTime&&(0,bC.jsxs)("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 flex items-center gap-3",children:[(0,bC.jsx)(jm,{size:16,className:G.reminderSent?"text-gray-500":"text-nexus-teal"}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h4",{className:"text-[10px] uppercase text-gray-500 font-bold",children:"Reminder"}),(0,bC.jsxs)("p",{className:"text-xs text-white font-mono",children:[G.reminderTime.toLocaleString(),(0,bC.jsxs)("span",{className:"ml-2 opacity-50",children:["(",G.reminderSent?"Sent":"Pending",")"]})]})]})]})]}),(0,bC.jsxs)("div",{className:"pt-4 mt-2 border-t border-white/5 flex gap-2",children:[(0,bC.jsxs)("button",{onClick:()=>E(G.id),className:`flex-1 py-2 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all ${G.completed?"bg-white/5 text-gray-400 hover:bg-white/10":"bg-green-500/20 text-green-400 hover:bg-green-500/30"}`,children:[G.completed?(0,bC.jsx)(bQ,{size:14}):(0,bC.jsx)(jk,{size:14}),G.completed?"Mark Incomplete":"Complete Mission"]}),(0,bC.jsx)("button",{onClick:()=>{d(a=>a.filter(a=>a.id!==G.id)),B(null)},className:"p-2 bg-red-500/10 text-red-400 rounded-xl hover:bg-red-500/20 transition-colors",title:"Delete Task",children:(0,bC.jsx)(ji,{size:16})})]})]}),(0,bC.jsxs)("div",{className:`flex flex-col gap-2 mb-2 bg-black/20 rounded-xl border border-white/5 ${C?"p-2":"p-3"}`,children:[(0,bC.jsxs)("div",{className:"flex gap-2",children:[(0,bC.jsx)("input",{type:"text",value:e,onChange:a=>f(a.target.value),onKeyDown:a=>"Enter"===a.key&&F(),placeholder:C?"Add Task...":"New Mission... (use #tag)",className:"flex-1 bg-transparent text-sm text-white focus:outline-none font-mono placeholder:text-gray-600"}),C?(0,bC.jsx)("button",{onClick:F,className:"p-1 rounded-lg text-nexus-teal hover:bg-nexus-teal hover:text-black transition-colors",children:(0,bC.jsx)(bU,{size:16})}):(0,bC.jsxs)("button",{onClick:()=>{j({low:"medium",medium:"high",high:"low"}[i])},className:`
                        px-2 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider border transition-all flex items-center gap-1
                        ${L(i)}
                    `,title:"Click to cycle priority",children:[K(i),i]})]}),!C&&(0,bC.jsxs)("div",{className:"flex items-center justify-between border-t border-white/5 pt-2 mt-1",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bC.jsx)("input",{type:"date",value:g,onChange:a=>h(a.target.value),className:"bg-transparent text-xs text-gray-400 focus:outline-none focus:text-nexus-teal transition-colors font-mono max-w-[100px]",style:{colorScheme:"dark"},title:"Deadline"}),(0,bC.jsx)("button",{onClick:()=>p(!o),className:`p-1.5 rounded-md transition-all ${o||m?"bg-nexus-purple text-white shadow-sm":"text-gray-500 hover:text-nexus-purple hover:bg-white/5"}`,title:"Set Reminder Notification",children:m?(0,bC.jsx)(jm,{size:14}):(0,bC.jsx)(jy,{size:14})}),o&&(0,bC.jsx)("input",{type:"datetime-local",value:m,onChange:a=>n(a.target.value),className:"bg-white/5 border border-white/10 rounded px-2 py-0.5 text-[10px] text-nexus-teal focus:outline-none focus:border-nexus-teal font-mono animate-fade-in",style:{colorScheme:"dark"}})]}),(0,bC.jsxs)("div",{className:"flex items-center gap-2",children:[(0,bC.jsx)("button",{onClick:()=>z(!y),className:`p-1.5 rounded-md transition-colors ${y||"none"!==u||"all"!==q?"text-nexus-teal bg-nexus-teal/10":"text-gray-500 hover:text-white"}`,title:"Filters & Sort",children:(0,bC.jsx)(ju,{size:14})}),(0,bC.jsxs)("button",{onClick:F,className:"flex items-center gap-1 text-[10px] font-bold bg-nexus-teal text-nexus-deep px-3 py-1 rounded-md hover:bg-white transition-colors",children:[(0,bC.jsx)(bU,{size:14})," ADD"]})]})]})]}),y&&!C&&(0,bC.jsxs)("div",{className:"mb-4 animate-fade-in space-y-2 bg-white/5 p-2 rounded-lg border border-white/5",children:[(0,bC.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bC.jsx)("div",{className:"flex bg-black/30 rounded-lg p-0.5 border border-white/5",children:["all","active","completed"].map(a=>(0,bC.jsx)("button",{onClick:()=>r(a),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold tracking-wider transition-all ${q===a?"bg-nexus-purple text-white shadow-sm":"text-gray-500 hover:text-gray-300"}`,children:a},a))}),(0,bC.jsxs)("div",{className:"flex gap-1",children:[(0,bC.jsxs)("button",{onClick:()=>J("deadline"),className:`flex items-center gap-1 px-2 py-1 rounded border text-[10px] uppercase font-bold tracking-wider transition-all ${"deadline"===u?"bg-nexus-teal text-nexus-deep border-nexus-teal":"bg-transparent text-gray-400 border-white/10 hover:border-white/30"}`,children:[(0,bC.jsx)(jh,{size:12})," Date","deadline"===u&&("asc"===w?(0,bC.jsx)(jv,{size:12}):(0,bC.jsx)(jw,{size:12}))]}),(0,bC.jsxs)("button",{onClick:()=>J("priority"),className:`flex items-center gap-1 px-2 py-1 rounded border text-[10px] uppercase font-bold tracking-wider transition-all ${"priority"===u?"bg-nexus-teal text-nexus-deep border-nexus-teal":"bg-transparent text-gray-400 border-white/10 hover:border-white/30"}`,children:[(0,bC.jsx)(jq,{size:12})," Prio","priority"===u&&("asc"===w?(0,bC.jsx)(jv,{size:12}):(0,bC.jsx)(jw,{size:12}))]})]})]}),(0,bC.jsxs)("div",{className:"flex gap-1 overflow-x-auto pb-1 custom-scrollbar",children:[(0,bC.jsxs)("button",{onClick:()=>t("all"),className:`flex items-center gap-1 px-2 py-1 rounded-full text-[10px] whitespace-nowrap border transition-all ${"all"===s?"bg-white/20 text-white border-white/30":"bg-transparent text-gray-500 border-dashed border-white/10"}`,children:[(0,bC.jsx)(jx,{size:10})," All"]}),H.map(a=>(0,bC.jsxs)("button",{onClick:()=>t(a===s?"all":a),className:`px-2 py-1 rounded-full text-[10px] whitespace-nowrap border transition-all ${s===a?"bg-nexus-purple/20 text-nexus-purple border-nexus-purple":"bg-transparent text-gray-500 border-white/10 hover:border-nexus-purple/30"}`,children:["#",a]},a))]})]}),(0,bC.jsx)("div",{className:"flex-1 overflow-y-auto pr-1",children:"none"===u?(0,bC.jsxs)(bC.Fragment,{children:[I.some(a=>!a.completed&&"high"===a.priority)&&(0,bC.jsxs)("div",{className:"mb-6",children:[(0,bC.jsxs)("h4",{className:"text-[10px] font-bold text-amber-500 uppercase tracking-widest mb-2 flex items-center gap-2 pl-1 opacity-80",children:[(0,bC.jsx)(jq,{size:12,className:"fill-current"})," Critical Focus"]}),(0,bC.jsx)("div",{className:"space-y-2",children:I.filter(a=>!a.completed&&"high"===a.priority).map(M)}),(0,bC.jsx)("div",{className:"h-px w-full bg-white/5 mt-4"})]}),(0,bC.jsxs)("div",{className:"space-y-2",children:[I.some(a=>!a.completed&&"high"===a.priority)&&(0,bC.jsx)("h4",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 pl-1",children:"Backlog"}),I.filter(a=>a.completed||"high"!==a.priority).map(M),0===I.length&&(0,bC.jsx)("div",{className:"text-center py-8 text-gray-600 text-xs italic",children:a||"all"!==q?"No missions match criteria.":"No active missions."})]})]}):(0,bC.jsxs)("div",{className:"space-y-2",children:[I.map(M),0===I.length&&(0,bC.jsx)("div",{className:"text-center py-8 text-gray-600 text-xs italic",children:"No missions match your filters."})]})}),!C&&(0,bC.jsxs)("button",{onClick:()=>{alert("Sending WhatsApp notification to registered number: \n\n"+c.filter(a=>!a.completed).map(a=>`- ${a.title} [${a.priority.toUpperCase()}]`).join("\n"))},className:"mt-4 flex items-center justify-center gap-2 w-full py-2 bg-green-600/20 hover:bg-green-600/40 text-green-400 text-xs rounded-lg border border-green-500/30 transition-all",children:[(0,bC.jsx)(jm,{size:14}),"Sync to WhatsApp"]})]})},jC=bI("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),jD=bI("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),jE=bI("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),jF=bI("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var jG=a.i(28684),jH=a.i(22734),jI=a.i(24868),jJ=a.i(81111),jK=a.i(88646);a.i(29e3),a.i(75091),a.i(10697);var jL=a.i(89877);a.i(95837),jL.default;var jM=a.i(14747);class jN{}function jO(a,b){return a.replace(/\{([^}]+)\}/g,(a,c)=>{if(Object.prototype.hasOwnProperty.call(b,c)){let a=b[c];return null!=a?String(a):""}throw Error(`Key '${c}' not found in valueMap.`)})}function jP(a,b,c){for(let d=0;d<b.length-1;d++){let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))if(Array.isArray(c))a[f]=Array.from({length:c.length},()=>({}));else throw Error(`Value must be a list given an array path ${e}`);if(Array.isArray(a[f])){let e=a[f];if(Array.isArray(c))for(let a=0;a<e.length;a++)jP(e[a],b.slice(d+1),c[a]);else for(let a of e)jP(a,b.slice(d+1),c)}return}if(e.endsWith("[0]")){let f=e.slice(0,-3);f in a||(a[f]=[{}]),jP(a[f][0],b.slice(d+1),c);return}a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}let d=b[b.length-1],e=a[d];if(void 0!==e){if(!c||"object"==typeof c&&0===Object.keys(c).length||c===e)return;if("object"==typeof e&&"object"==typeof c&&null!==e&&null!==c)Object.assign(e,c);else throw Error(`Cannot set value for an existing key. Key: ${d}`)}else"_self"!==d||"object"!=typeof c||null===c||Array.isArray(c)?a[d]=c:Object.assign(a,c)}function jQ(a,b,c){try{if(1===b.length&&"_self"===b[0])return a;for(let d=0;d<b.length;d++){if("object"!=typeof a||null===a)return c;let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))return c;{let e=a[f];if(!Array.isArray(e))return c;return e.map(a=>jQ(a,b.slice(d+1),c))}}a=a[e]}return a}catch(a){if(a instanceof TypeError)return c;throw a}}function jR(a){if("string"!=typeof a)throw Error("fromImageBytes must be a string");return a}function jS(a){var b;let c,d,e,f,g={},h=jQ(a,["name"]);null!=h&&jP(g,["name"],h);let i=jQ(a,["metadata"]);null!=i&&jP(g,["metadata"],i);let j=jQ(a,["done"]);null!=j&&jP(g,["done"],j);let k=jQ(a,["error"]);null!=k&&jP(g,["error"],k);let l=jQ(a,["response"]);return null!=l&&jP(g,["response"],(c={},null!=(d=jQ(b=l,["sdkHttpResponse"]))&&jP(c,["sdkHttpResponse"],d),null!=(e=jQ(b,["parent"]))&&jP(c,["parent"],e),null!=(f=jQ(b,["documentName"]))&&jP(c,["documentName"],f),c)),g}(w=aJ||(aJ={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",w.OUTCOME_OK="OUTCOME_OK",w.OUTCOME_FAILED="OUTCOME_FAILED",w.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(x=aK||(aK={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",x.PYTHON="PYTHON",(y=aL||(aL={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",y.SILENT="SILENT",y.WHEN_IDLE="WHEN_IDLE",y.INTERRUPT="INTERRUPT",(z=aM||(aM={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",z.STRING="STRING",z.NUMBER="NUMBER",z.INTEGER="INTEGER",z.BOOLEAN="BOOLEAN",z.ARRAY="ARRAY",z.OBJECT="OBJECT",z.NULL="NULL",(A=aN||(aN={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",A.MODE_DYNAMIC="MODE_DYNAMIC",(B=aO||(aO={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",B.SIMPLE_SEARCH="SIMPLE_SEARCH",B.ELASTIC_SEARCH="ELASTIC_SEARCH",(C=aP||(aP={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",C.NO_AUTH="NO_AUTH",C.API_KEY_AUTH="API_KEY_AUTH",C.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",C.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",C.OAUTH="OAUTH",C.OIDC_AUTH="OIDC_AUTH",(D=aQ||(aQ={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",D.HTTP_IN_QUERY="HTTP_IN_QUERY",D.HTTP_IN_HEADER="HTTP_IN_HEADER",D.HTTP_IN_PATH="HTTP_IN_PATH",D.HTTP_IN_BODY="HTTP_IN_BODY",D.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(E=aR||(aR={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",E.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",E.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",E.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",E.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",E.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",E.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(F=aS||(aS={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",F.LOW="LOW",F.MEDIUM="MEDIUM",F.HIGH="HIGH",F.MINIMAL="MINIMAL",(G=aT||(aT={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",G.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",G.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",G.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",G.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",G.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",G.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",G.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",G.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",G.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",G.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(H=aU||(aU={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",H.SEVERITY="SEVERITY",H.PROBABILITY="PROBABILITY",(I=aV||(aV={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",I.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",I.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",I.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",I.BLOCK_NONE="BLOCK_NONE",I.OFF="OFF",(J=aW||(aW={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",J.STOP="STOP",J.MAX_TOKENS="MAX_TOKENS",J.SAFETY="SAFETY",J.RECITATION="RECITATION",J.LANGUAGE="LANGUAGE",J.OTHER="OTHER",J.BLOCKLIST="BLOCKLIST",J.PROHIBITED_CONTENT="PROHIBITED_CONTENT",J.SPII="SPII",J.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",J.IMAGE_SAFETY="IMAGE_SAFETY",J.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",J.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",J.NO_IMAGE="NO_IMAGE",J.IMAGE_RECITATION="IMAGE_RECITATION",J.IMAGE_OTHER="IMAGE_OTHER",(K=aX||(aX={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",K.NEGLIGIBLE="NEGLIGIBLE",K.LOW="LOW",K.MEDIUM="MEDIUM",K.HIGH="HIGH",(L=aY||(aY={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",L.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",L.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",L.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",L.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(M=aZ||(aZ={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",M.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",M.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",M.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",M.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(N=a$||(a$={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",N.SAFETY="SAFETY",N.OTHER="OTHER",N.BLOCKLIST="BLOCKLIST",N.PROHIBITED_CONTENT="PROHIBITED_CONTENT",N.IMAGE_SAFETY="IMAGE_SAFETY",N.MODEL_ARMOR="MODEL_ARMOR",N.JAILBREAK="JAILBREAK",(O=a_||(a_={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",O.ON_DEMAND="ON_DEMAND",O.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(P=a0||(a0={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",P.TEXT="TEXT",P.IMAGE="IMAGE",P.AUDIO="AUDIO",(Q=a1||(a1={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Q.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Q.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Q.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(R=a2||(a2={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",R.TUNING_MODE_FULL="TUNING_MODE_FULL",R.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(S=a3||(a3={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",S.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",S.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",S.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",S.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",S.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",S.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(T=a4||(a4={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",T.JOB_STATE_QUEUED="JOB_STATE_QUEUED",T.JOB_STATE_PENDING="JOB_STATE_PENDING",T.JOB_STATE_RUNNING="JOB_STATE_RUNNING",T.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",T.JOB_STATE_FAILED="JOB_STATE_FAILED",T.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",T.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",T.JOB_STATE_PAUSED="JOB_STATE_PAUSED",T.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",T.JOB_STATE_UPDATING="JOB_STATE_UPDATING",T.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(U=a5||(a5={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",U.TUNING_TASK_I2V="TUNING_TASK_I2V",U.TUNING_TASK_T2V="TUNING_TASK_T2V",U.TUNING_TASK_R2V="TUNING_TASK_R2V",(V=a6||(a6={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",V.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",V.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",V.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",V.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(W=a7||(a7={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",W.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",W.BALANCED="BALANCED",W.PRIORITIZE_COST="PRIORITIZE_COST",(X=a8||(a8={})).UNSPECIFIED="UNSPECIFIED",X.BLOCKING="BLOCKING",X.NON_BLOCKING="NON_BLOCKING",(Y=a9||(a9={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Y.MODE_DYNAMIC="MODE_DYNAMIC",(Z=ba||(ba={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",Z.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",($=bb||(bb={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",$.AUTO="AUTO",$.ANY="ANY",$.NONE="NONE",$.VALIDATED="VALIDATED",(_=bc||(bc={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",_.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",_.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",_.BLOCK_NONE="BLOCK_NONE",(aa=bd||(bd={})).DONT_ALLOW="DONT_ALLOW",aa.ALLOW_ADULT="ALLOW_ADULT",aa.ALLOW_ALL="ALLOW_ALL",(ab=be||(be={})).auto="auto",ab.en="en",ab.ja="ja",ab.ko="ko",ab.hi="hi",ab.zh="zh",ab.pt="pt",ab.es="es",(ac=bf||(bf={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",ac.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",ac.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",ac.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",ac.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(ad=bg||(bg={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",ad.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",ad.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",ad.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(ae=bh||(bh={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",ae.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",ae.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",ae.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(af=bi||(bi={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",af.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",af.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",af.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",af.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",af.EDIT_MODE_STYLE="EDIT_MODE_STYLE",af.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",af.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(ag=bj||(bj={})).FOREGROUND="FOREGROUND",ag.BACKGROUND="BACKGROUND",ag.PROMPT="PROMPT",ag.SEMANTIC="SEMANTIC",ag.INTERACTIVE="INTERACTIVE",(ah=bk||(bk={})).ASSET="ASSET",ah.STYLE="STYLE",(ai=bl||(bl={})).INSERT="INSERT",ai.REMOVE="REMOVE",ai.REMOVE_STATIC="REMOVE_STATIC",ai.OUTPAINT="OUTPAINT",(aj=bm||(bm={})).OPTIMIZED="OPTIMIZED",aj.LOSSLESS="LOSSLESS",(ak=bn||(bn={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",ak.PREFERENCE_TUNING="PREFERENCE_TUNING",(al=bo||(bo={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",al.STATE_PENDING="STATE_PENDING",al.STATE_ACTIVE="STATE_ACTIVE",al.STATE_FAILED="STATE_FAILED",(am=bp||(bp={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",am.PROCESSING="PROCESSING",am.ACTIVE="ACTIVE",am.FAILED="FAILED",(an=bq||(bq={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",an.UPLOADED="UPLOADED",an.GENERATED="GENERATED",(ao=br||(br={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",ao.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",ao.RESPONSE_REJECTED="RESPONSE_REJECTED",ao.NEED_MORE_INPUT="NEED_MORE_INPUT",(ap=bs||(bs={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",ap.TEXT="TEXT",ap.IMAGE="IMAGE",ap.VIDEO="VIDEO",ap.AUDIO="AUDIO",ap.DOCUMENT="DOCUMENT",(aq=bt||(bt={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",aq.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",aq.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",(ar=bu||(bu={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",ar.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",ar.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(as=bv||(bv={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",as.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",as.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(at=bw||(bw={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",at.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",at.NO_INTERRUPTION="NO_INTERRUPTION",(au=bx||(bx={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",au.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",au.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(av=by||(by={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",av.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",av.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",av.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",av.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",av.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",av.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",av.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",av.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",av.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",av.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",av.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",av.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(aw=bz||(bz={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",aw.QUALITY="QUALITY",aw.DIVERSITY="DIVERSITY",aw.VOCALIZATION="VOCALIZATION",(ax=bA||(bA={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",ax.PLAY="PLAY",ax.PAUSE="PAUSE",ax.STOP="STOP",ax.RESET_CONTEXT="RESET_CONTEXT";class jT{constructor(a){const b={};for(const c of a.headers.entries())b[c[0]]=c[1];this.headers=b,this.responseInternal=a}json(){return this.responseInternal.json()}}class jU{get text(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let i="",j=!1,k=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"text"!==b&&"thought"!==b&&"thoughtSignature"!==b&&(null!==c||void 0!==c)&&k.push(b);if("string"==typeof a.text){if("boolean"==typeof a.thought&&a.thought)continue;j=!0,i+=a.text}}return k.length>0&&console.warn(`there are non-text parts ${k} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),j?i:void 0}get data(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let i="",j=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"inlineData"!==b&&(null!==c||void 0!==c)&&j.push(b);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return j.length>0&&console.warn(`there are non-data parts ${j} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}get functionCalls(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let i=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.functionCall).map(a=>a.functionCall).filter(a=>void 0!==a);if((null==i?void 0:i.length)!==0)return i}get executableCode(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.executableCode).map(a=>a.executableCode).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.code}get codeExecutionResult(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.codeExecutionResult).map(a=>a.codeExecutionResult).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.output}}class jV{}class jW{}class jX{}class jY{}class jZ{}class j${}class j_{}class j0{}class j1{}class j2{}class j3{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){let c,d=new j3;if(b){let b,d,e,f,g,h;b={},null!=(d=jQ(a,["name"]))&&jP(b,["name"],d),null!=(e=jQ(a,["metadata"]))&&jP(b,["metadata"],e),null!=(f=jQ(a,["done"]))&&jP(b,["done"],f),null!=(g=jQ(a,["error"]))&&jP(b,["error"],g),null!=(h=jQ(a,["response"]))&&jP(b,["response"],function(a){let b={},c=jQ(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=jQ(a,["_self"]))&&jP(c,["video"],(e={},null!=(f=jQ(b=d,["gcsUri"]))&&jP(e,["uri"],f),null!=(g=jQ(b,["bytesBase64Encoded"]))&&jP(e,["videoBytes"],jR(g)),null!=(h=jQ(b,["mimeType"]))&&jP(e,["mimeType"],h),e)),c})),jP(b,["generatedVideos"],a)}let d=jQ(a,["raiMediaFilteredCount"]);null!=d&&jP(b,["raiMediaFilteredCount"],d);let e=jQ(a,["raiMediaFilteredReasons"]);return null!=e&&jP(b,["raiMediaFilteredReasons"],e),b}(h)),c=b}else{let b,d,e,f,g,h;b={},null!=(d=jQ(a,["name"]))&&jP(b,["name"],d),null!=(e=jQ(a,["metadata"]))&&jP(b,["metadata"],e),null!=(f=jQ(a,["done"]))&&jP(b,["done"],f),null!=(g=jQ(a,["error"]))&&jP(b,["error"],g),null!=(h=jQ(a,["response","generateVideoResponse"]))&&jP(b,["response"],function(a){let b={},c=jQ(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=jQ(a,["video"]))&&jP(c,["video"],(e={},null!=(f=jQ(b=d,["uri"]))&&jP(e,["uri"],f),null!=(g=jQ(b,["encodedVideo"]))&&jP(e,["videoBytes"],jR(g)),null!=(h=jQ(b,["encoding"]))&&jP(e,["mimeType"],h),e)),c})),jP(b,["generatedVideos"],a)}let d=jQ(a,["raiMediaFilteredCount"]);null!=d&&jP(b,["raiMediaFilteredCount"],d);let e=jQ(a,["raiMediaFilteredReasons"]);return null!=e&&jP(b,["raiMediaFilteredReasons"],e),b}(h)),c=b}return Object.assign(d,c),d}}class j4{}class j5{}class j6{}class j7{}class j8{}class j9{}class ka{}class kb{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){var c;let d,e,f,g,h,i,j,k,l,m,n=new kb;return Object.assign(n,(h={},null!=(i=jQ(a,["name"]))&&jP(h,["name"],i),null!=(j=jQ(a,["metadata"]))&&jP(h,["metadata"],j),null!=(k=jQ(a,["done"]))&&jP(h,["done"],k),null!=(l=jQ(a,["error"]))&&jP(h,["error"],l),null!=(m=jQ(a,["response"]))&&jP(h,["response"],(d={},null!=(e=jQ(c=m,["sdkHttpResponse"]))&&jP(d,["sdkHttpResponse"],e),null!=(f=jQ(c,["parent"]))&&jP(d,["parent"],f),null!=(g=jQ(c,["documentName"]))&&jP(d,["documentName"],g),d)),h)),n}}class kc{}class kd{}class ke{}class kf{}class kg{get text(){var a,b,c;let d="",e=!1,f=[];for(let g of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(g))"text"!==a&&"thought"!==a&&null!==b&&f.push(a);if("string"==typeof g.text){if("boolean"==typeof g.thought&&g.thought)continue;e=!0,d+=g.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),e?d:void 0}get data(){var a,b,c;let d="",e=[];for(let f of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(f))"inlineData"!==a&&null!==b&&e.push(a);f.inlineData&&"string"==typeof f.inlineData.data&&(d+=atob(f.inlineData.data))}return e.length>0&&console.warn(`there are non-data parts ${e} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}}class kh{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ki{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){let c=new ki;return Object.assign(c,jS(a)),c}}function kj(a,b){if(!b||"string"!=typeof b)throw Error("model is required and must be a string");if(b.includes("..")||b.includes("?")||b.includes("&"))throw Error("invalid model parameter");if(a.isVertexAI())if(b.startsWith("publishers/")||b.startsWith("projects/")||b.startsWith("models/"))return b;else{if(!(b.indexOf("/")>=0))return`publishers/google/models/${b}`;let a=b.split("/",2);return`publishers/${a[0]}/models/${a[1]}`}return b.startsWith("models/")||b.startsWith("tunedModels/")?b:`models/${b}`}function kk(a,b){let c=kj(a,b);return c?c.startsWith("publishers/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/${c}`:c.startsWith("models/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/publishers/google/${c}`:c:""}function kl(a){return Array.isArray(a)?a.map(a=>km(a)):[km(a)]}function km(a){if("object"==typeof a&&null!==a)return a;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof a}`)}function kn(a){let b=km(a);if(b.mimeType&&b.mimeType.startsWith("image/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function ko(a){let b=km(a);if(b.mimeType&&b.mimeType.startsWith("audio/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function kp(a){if(null==a)throw Error("PartUnion is required");if("object"==typeof a)return a;if("string"==typeof a)return{text:a};throw Error(`Unsupported part type: ${typeof a}`)}function kq(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("PartListUnion is required");return Array.isArray(a)?a.map(a=>kp(a)):[kp(a)]}function kr(a){return null!=a&&"object"==typeof a&&"parts"in a&&Array.isArray(a.parts)}function ks(a){return null!=a&&"object"==typeof a&&"functionCall"in a}function kt(a){return null!=a&&"object"==typeof a&&"functionResponse"in a}function ku(a){if(null==a)throw Error("ContentUnion is required");return kr(a)?a:{role:"user",parts:kq(a)}}function kv(a,b){if(!b)return[];if(a.isVertexAI()&&Array.isArray(b))return b.flatMap(a=>{let b=ku(a);return b.parts&&b.parts.length>0&&void 0!==b.parts[0].text?[b.parts[0].text]:[]});if(a.isVertexAI()){let a=ku(b);return a.parts&&a.parts.length>0&&void 0!==a.parts[0].text?[a.parts[0].text]:[]}return Array.isArray(b)?b.map(a=>ku(a)):[ku(b)]}function kw(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("contents are required");if(!Array.isArray(a)){if(ks(a)||kt(a))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ku(a)]}let b=[],c=[],d=kr(a[0]);for(let e of a){let a=kr(e);if(a!=d)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)b.push(e);else if(ks(e)||kt(e))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else c.push(e)}return d||b.push({role:"user",parts:kq(c)}),b}function kx(a){let b={},c=["items"],d=["anyOf"],e=["properties"];if(a.type&&a.anyOf)throw Error("type and anyOf cannot be both populated.");let f=a.anyOf;for(let[g,h]of(null!=f&&2==f.length&&("null"===f[0].type?(b.nullable=!0,a=f[1]):"null"===f[1].type&&(b.nullable=!0,a=f[0])),a.type instanceof Array&&function(a,b){a.includes("null")&&(b.nullable=!0);let c=a.filter(a=>"null"!==a);if(1===c.length)b.type=Object.values(aM).includes(c[0].toUpperCase())?c[0].toUpperCase():aM.TYPE_UNSPECIFIED;else for(let a of(b.anyOf=[],c))b.anyOf.push({type:Object.values(aM).includes(a.toUpperCase())?a.toUpperCase():aM.TYPE_UNSPECIFIED})}(a.type,b),Object.entries(a)))if(null!=h)if("type"==g){if("null"===h)throw Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;b.type=Object.values(aM).includes(h.toUpperCase())?h.toUpperCase():aM.TYPE_UNSPECIFIED}else if(c.includes(g))b[g]=kx(h);else if(d.includes(g)){let a=[];for(let c of h){if("null"==c.type){b.nullable=!0;continue}a.push(kx(c))}b[g]=a}else if(e.includes(g)){let a={};for(let[b,c]of Object.entries(h))a[b]=kx(c);b[g]=a}else{if("additionalProperties"===g)continue;b[g]=h}return b}function ky(a){if("object"==typeof a)return a;if("string"==typeof a)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:a}}};throw Error(`Unsupported speechConfig type: ${typeof a}`)}function kz(a){if("multiSpeakerVoiceConfig"in a)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return a}function kA(a){if(a.functionDeclarations)for(let b of a.functionDeclarations)b.parameters&&(Object.keys(b.parameters).includes("$schema")?b.parametersJsonSchema||(b.parametersJsonSchema=b.parameters,delete b.parameters):b.parameters=kx(b.parameters)),b.response&&(Object.keys(b.response).includes("$schema")?b.responseJsonSchema||(b.responseJsonSchema=b.response,delete b.response):b.response=kx(b.response));return a}function kB(a){if(null==a)throw Error("tools is required");if(!Array.isArray(a))throw Error("tools is required and must be an array of Tools");let b=[];for(let c of a)b.push(c);return b}function kC(a,b){if("string"!=typeof b)throw Error("name must be a string");return function(a,b,c,d=1){let e=!b.startsWith(`${c}/`)&&b.split("/").length===d;if(a.isVertexAI())if(b.startsWith("projects/"))return b;else if(b.startsWith("locations/"))return`projects/${a.getProject()}/${b}`;else if(b.startsWith(`${c}/`))return`projects/${a.getProject()}/locations/${a.getLocation()}/${b}`;else if(e)return`projects/${a.getProject()}/locations/${a.getLocation()}/${c}/${b}`;else return b;return e?`${c}/${b}`:b}(a,b,"cachedContents")}function kD(a){switch(a){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return a}}function kE(a){return null!=a&&"object"==typeof a&&"video"in a}function kF(a){return null!=a&&"object"==typeof a&&"uri"in a}function kG(a){var b;let c;if(null!=a&&"object"==typeof a&&"name"in a&&(c=a.name),!kF(a)||void 0!==(c=a.uri)){if(!kE(a)||void 0!==(c=null==(b=a.video)?void 0:b.uri)){if("string"==typeof a&&(c=a),void 0===c)throw Error("Could not extract file name from the provided input.");if(c.startsWith("https://")){let a=c.split("files/")[1].match(/[a-z0-9]+/);if(null===a)throw Error(`Could not extract file name from URI ${c}`);c=a[0]}else c.startsWith("files/")&&(c=c.split("files/")[1]);return c}}}function kH(a,b){return a.isVertexAI()?b?"publishers/google/models":"models":b?"models":"tunedModels"}function kI(a){for(let d of["models","tunedModels","publisherModels"]){var b,c;if(b=a,c=d,null!==b&&"object"==typeof b&&c in b)return a[d]}return[]}function kJ(a,b){let c;if("string"==typeof b)if(a.isVertexAI())if(b.startsWith("gs://"))c={format:"jsonl",gcsUri:[b]};else if(b.startsWith("bq://"))c={format:"bigquery",bigqueryUri:b};else throw Error(`Unsupported string source for Vertex AI: ${b}`);else if(b.startsWith("files/"))c={fileName:b};else throw Error(`Unsupported string source for Gemini API: ${b}`);else if(Array.isArray(b)){if(a.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");c={inlinedRequests:b}}else c=b;let d=[c.gcsUri,c.bigqueryUri].filter(Boolean).length,e=[c.inlinedRequests,c.fileName].filter(Boolean).length;if(a.isVertexAI()){if(e>0||1!==d)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(d>0||1!==e)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return c}function kK(a){if("object"!=typeof a||null===a)return{};let b=a.inlinedResponses;if("object"!=typeof b||null===b)return a;let c=b.inlinedResponses;if(!Array.isArray(c)||0===c.length)return a;let d=!1;for(let a of c){if("object"!=typeof a||null===a)continue;let b=a.response;if("object"==typeof b&&null!==b&&void 0!==b.embedding){d=!0;break}}return d&&(a.inlinedEmbedContentResponses=a.inlinedResponses,delete a.inlinedResponses),a}function kL(a,b){if(!a.isVertexAI()){if(/batches\/[^/]+$/.test(b))return b.split("/").pop();throw Error(`Invalid batch job name: ${b}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(b))return b.split("/").pop();if(/^\d+$/.test(b))return b;throw Error(`Invalid batch job name: ${b}.`)}function kM(a){if("BATCH_STATE_UNSPECIFIED"===a)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===a)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===a)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===a)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===a)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===a)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===a)return"JOB_STATE_EXPIRED";else return a}function kN(a){let b={},c=jQ(a,["name"]);null!=c&&jP(b,["name"],c);let d=jQ(a,["metadata","displayName"]);null!=d&&jP(b,["displayName"],d);let e=jQ(a,["metadata","state"]);null!=e&&jP(b,["state"],kM(e));let f=jQ(a,["metadata","createTime"]);null!=f&&jP(b,["createTime"],f);let g=jQ(a,["metadata","endTime"]);null!=g&&jP(b,["endTime"],g);let h=jQ(a,["metadata","updateTime"]);null!=h&&jP(b,["updateTime"],h);let i=jQ(a,["metadata","model"]);null!=i&&jP(b,["model"],i);let j=jQ(a,["metadata","output"]);return null!=j&&jP(b,["dest"],function(a){let b={},c=jQ(a,["responsesFile"]);null!=c&&jP(b,["fileName"],c);let d=jQ(a,["inlinedResponses","inlinedResponses"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=jQ(b=a,["response"]))&&jP(c,["response"],function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["content"]);null!=c&&jP(b,["content"],c);let d=jQ(a,["citationMetadata"]);null!=d&&jP(b,["citationMetadata"],function(a){let b={},c=jQ(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["citations"],a)}return b}(d));let e=jQ(a,["tokenCount"]);null!=e&&jP(b,["tokenCount"],e);let f=jQ(a,["finishReason"]);null!=f&&jP(b,["finishReason"],f);let g=jQ(a,["avgLogprobs"]);null!=g&&jP(b,["avgLogprobs"],g);let h=jQ(a,["groundingMetadata"]);null!=h&&jP(b,["groundingMetadata"],h);let i=jQ(a,["index"]);null!=i&&jP(b,["index"],i);let j=jQ(a,["logprobsResult"]);null!=j&&jP(b,["logprobsResult"],j);let k=jQ(a,["safetyRatings"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["safetyRatings"],a)}let l=jQ(a,["urlContextMetadata"]);return null!=l&&jP(b,["urlContextMetadata"],l),b})(a))),jP(b,["candidates"],a)}let e=jQ(a,["modelVersion"]);null!=e&&jP(b,["modelVersion"],e);let f=jQ(a,["promptFeedback"]);null!=f&&jP(b,["promptFeedback"],f);let g=jQ(a,["responseId"]);null!=g&&jP(b,["responseId"],g);let h=jQ(a,["usageMetadata"]);return null!=h&&jP(b,["usageMetadata"],h),b}(d)),null!=(e=jQ(b,["error"]))&&jP(c,["error"],e),c})),jP(b,["inlinedResponses"],a)}let e=jQ(a,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["inlinedEmbedContentResponses"],a)}return b}(kK(j))),b}function kO(a){var b,c;let d,e,f,g,h,i,j,k,l={},m=jQ(a,["name"]);null!=m&&jP(l,["name"],m);let n=jQ(a,["displayName"]);null!=n&&jP(l,["displayName"],n);let o=jQ(a,["state"]);null!=o&&jP(l,["state"],kM(o));let p=jQ(a,["error"]);null!=p&&jP(l,["error"],p);let q=jQ(a,["createTime"]);null!=q&&jP(l,["createTime"],q);let r=jQ(a,["startTime"]);null!=r&&jP(l,["startTime"],r);let s=jQ(a,["endTime"]);null!=s&&jP(l,["endTime"],s);let t=jQ(a,["updateTime"]);null!=t&&jP(l,["updateTime"],t);let u=jQ(a,["model"]);null!=u&&jP(l,["model"],u);let v=jQ(a,["inputConfig"]);null!=v&&jP(l,["src"],(d={},null!=(e=jQ(c=v,["instancesFormat"]))&&jP(d,["format"],e),null!=(f=jQ(c,["gcsSource","uris"]))&&jP(d,["gcsUri"],f),null!=(g=jQ(c,["bigquerySource","inputUri"]))&&jP(d,["bigqueryUri"],g),d));let w=jQ(a,["outputConfig"]);null!=w&&jP(l,["dest"],(b=kK(w),h={},null!=(i=jQ(b,["predictionsFormat"]))&&jP(h,["format"],i),null!=(j=jQ(b,["gcsDestination","outputUriPrefix"]))&&jP(h,["gcsUri"],j),null!=(k=jQ(b,["bigqueryDestination","outputUri"]))&&jP(h,["bigqueryUri"],k),h));let x=jQ(a,["completionStats"]);return null!=x&&jP(l,["completionStats"],x),l}function kP(a){let b={},c=jQ(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m,n;return c={},null!=(d=jQ(b=a,["mediaResolution"]))&&jP(c,["mediaResolution"],d),null!=(e=jQ(b,["codeExecutionResult"]))&&jP(c,["codeExecutionResult"],e),null!=(f=jQ(b,["executableCode"]))&&jP(c,["executableCode"],f),null!=(g=jQ(b,["fileData"]))&&jP(c,["fileData"],function(a){let b={};if(void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=jQ(a,["fileUri"]);null!=c&&jP(b,["fileUri"],c);let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(g)),null!=(h=jQ(b,["functionCall"]))&&jP(c,["functionCall"],function(a){let b={},c=jQ(a,["id"]);null!=c&&jP(b,["id"],c);let d=jQ(a,["args"]);null!=d&&jP(b,["args"],d);let e=jQ(a,["name"]);if(null!=e&&jP(b,["name"],e),void 0!==jQ(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==jQ(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(h)),null!=(i=jQ(b,["functionResponse"]))&&jP(c,["functionResponse"],i),null!=(j=jQ(b,["inlineData"]))&&jP(c,["inlineData"],function(a){let b={},c=jQ(a,["data"]);if(null!=c&&jP(b,["data"],c),void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(j)),null!=(k=jQ(b,["text"]))&&jP(c,["text"],k),null!=(l=jQ(b,["thought"]))&&jP(c,["thought"],l),null!=(m=jQ(b,["thoughtSignature"]))&&jP(c,["thoughtSignature"],m),null!=(n=jQ(b,["videoMetadata"]))&&jP(c,["videoMetadata"],n),c})),jP(b,["parts"],a)}let d=jQ(a,["role"]);return null!=d&&jP(b,["role"],d),b}function kQ(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["src"]);null!=e&&jP(c,["batch","inputConfig"],function(a,b){let c={};if(void 0!==jQ(b,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==jQ(b,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==jQ(b,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let d=jQ(b,["fileName"]);null!=d&&jP(c,["fileName"],d);let e=jQ(b,["inlinedRequests"]);if(null!=e){let b=e;Array.isArray(b)&&(b=b.map(b=>(function(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["request","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>kP(a))),jP(c,["request","contents"],a)}let f=jQ(b,["metadata"]);null!=f&&jP(c,["metadata"],f);let g=jQ(b,["config"]);return null!=g&&jP(c,["request","generationConfig"],function(a,b,c){var d;let e,f,g,h={},i=jQ(b,["systemInstruction"]);void 0!==c&&null!=i&&jP(c,["systemInstruction"],kP(ku(i)));let j=jQ(b,["temperature"]);null!=j&&jP(h,["temperature"],j);let k=jQ(b,["topP"]);null!=k&&jP(h,["topP"],k);let l=jQ(b,["topK"]);null!=l&&jP(h,["topK"],l);let m=jQ(b,["candidateCount"]);null!=m&&jP(h,["candidateCount"],m);let n=jQ(b,["maxOutputTokens"]);null!=n&&jP(h,["maxOutputTokens"],n);let o=jQ(b,["stopSequences"]);null!=o&&jP(h,["stopSequences"],o);let p=jQ(b,["responseLogprobs"]);null!=p&&jP(h,["responseLogprobs"],p);let q=jQ(b,["logprobs"]);null!=q&&jP(h,["logprobs"],q);let r=jQ(b,["presencePenalty"]);null!=r&&jP(h,["presencePenalty"],r);let s=jQ(b,["frequencyPenalty"]);null!=s&&jP(h,["frequencyPenalty"],s);let t=jQ(b,["seed"]);null!=t&&jP(h,["seed"],t);let u=jQ(b,["responseMimeType"]);null!=u&&jP(h,["responseMimeType"],u);let v=jQ(b,["responseSchema"]);null!=v&&jP(h,["responseSchema"],kx(v));let w=jQ(b,["responseJsonSchema"]);if(null!=w&&jP(h,["responseJsonSchema"],w),void 0!==jQ(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==jQ(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let x=jQ(b,["safetySettings"]);if(void 0!==c&&null!=x){let a=x;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["category"]);if(null!=c&&jP(b,["category"],c),void 0!==jQ(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let d=jQ(a,["threshold"]);return null!=d&&jP(b,["threshold"],d),b})(a))),jP(c,["safetySettings"],a)}let y=jQ(b,["tools"]);if(void 0!==c&&null!=y){let a=kB(y);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["functionDeclarations"],a)}if(void 0!==jQ(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=jQ(a,["googleSearchRetrieval"]);null!=d&&jP(b,["googleSearchRetrieval"],d);let e=jQ(a,["computerUse"]);null!=e&&jP(b,["computerUse"],e);let f=jQ(a,["fileSearch"]);null!=f&&jP(b,["fileSearch"],f);let g=jQ(a,["codeExecution"]);if(null!=g&&jP(b,["codeExecution"],g),void 0!==jQ(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=jQ(a,["googleMaps"]);null!=h&&jP(b,["googleMaps"],function(a){let b={};if(void 0!==jQ(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=jQ(a,["enableWidget"]);return null!=c&&jP(b,["enableWidget"],c),b}(h));let i=jQ(a,["googleSearch"]);null!=i&&jP(b,["googleSearch"],function(a){let b={};if(void 0!==jQ(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==jQ(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=jQ(a,["timeRangeFilter"]);return null!=c&&jP(b,["timeRangeFilter"],c),b}(i));let j=jQ(a,["urlContext"]);return null!=j&&jP(b,["urlContext"],j),b})(kA(a)))),jP(c,["tools"],a)}let z=jQ(b,["toolConfig"]);if(void 0!==c&&null!=z&&jP(c,["toolConfig"],(e={},null!=(f=jQ(d=z,["functionCallingConfig"]))&&jP(e,["functionCallingConfig"],function(a){let b={},c=jQ(a,["mode"]);null!=c&&jP(b,["mode"],c);let d=jQ(a,["allowedFunctionNames"]);if(null!=d&&jP(b,["allowedFunctionNames"],d),void 0!==jQ(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(f)),null!=(g=jQ(d,["retrievalConfig"]))&&jP(e,["retrievalConfig"],g),e)),void 0!==jQ(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let A=jQ(b,["cachedContent"]);void 0!==c&&null!=A&&jP(c,["cachedContent"],kC(a,A));let B=jQ(b,["responseModalities"]);null!=B&&jP(h,["responseModalities"],B);let C=jQ(b,["mediaResolution"]);null!=C&&jP(h,["mediaResolution"],C);let D=jQ(b,["speechConfig"]);if(null!=D&&jP(h,["speechConfig"],ky(D)),void 0!==jQ(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let E=jQ(b,["thinkingConfig"]);null!=E&&jP(h,["thinkingConfig"],E);let F=jQ(b,["imageConfig"]);null!=F&&jP(h,["imageConfig"],function(a){let b={},c=jQ(a,["aspectRatio"]);null!=c&&jP(b,["aspectRatio"],c);let d=jQ(a,["imageSize"]);if(null!=d&&jP(b,["imageSize"],d),void 0!==jQ(a,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==jQ(a,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return b}(F));let G=jQ(b,["enableEnhancedCivicAnswers"]);return null!=G&&jP(h,["enableEnhancedCivicAnswers"],G),h}(a,g,jQ(c,["request"],{}))),c})(a,b))),jP(c,["requests","requests"],b)}return c}(a,kJ(a,e)));let f=jQ(b,["config"]);return null!=f&&function(a,b){let c=jQ(a,["displayName"]);if(void 0!==b&&null!=c&&jP(b,["batch","displayName"],c),void 0!==jQ(a,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(f,c),c}(ay=bB||(bB={})).PAGED_ITEM_BATCH_JOBS="batchJobs",ay.PAGED_ITEM_MODELS="models",ay.PAGED_ITEM_TUNING_JOBS="tuningJobs",ay.PAGED_ITEM_FILES="files",ay.PAGED_ITEM_CACHED_CONTENTS="cachedContents",ay.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",ay.PAGED_ITEM_DOCUMENTS="documents";class kR{constructor(a,b,c,d){this.pageInternal=[],this.paramsInternal={},this.requestInternal=b,this.init(a,c,d)}init(a,b,c){var d,e;this.nameInternal=a,this.pageInternal=b[this.nameInternal]||[],this.sdkHttpResponseInternal=null==b?void 0:b.sdkHttpResponse,this.idxInternal=0;let f={config:{}};(f=c&&0!==Object.keys(c).length?"object"==typeof c?Object.assign({},c):c:{config:{}}).config&&(f.config.pageToken=b.nextPageToken),this.paramsInternal=f,this.pageInternalSize=null!=(e=null==(d=f.config)?void 0:d.pageSize)?e:this.pageInternal.length}initNextPage(a){this.init(this.nameInternal,a,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(a){return this.pageInternal[a]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let a=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:a,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let a=await this.requestInternal(this.params);return this.initNextPage(a),this.page}hasNextPage(){var a;return(null==(a=this.params.config)?void 0:a.pageToken)!==void 0}}class kS extends jN{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new kR(bB.PAGED_ITEM_BATCH_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.create=async a=>(this.apiClient.isVertexAI()&&(a.config=this.formatDestination(a.src,a.config)),this.createInternal(a)),this.createEmbeddings=async a=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(a)}}createInlinedGenerateContentRequest(a){let b=kQ(this.apiClient,a),c=jO("{model}:batchGenerateContent",b._url),d=b.batch.inputConfig.requests,e=d.requests,f=[];for(let a of e){let b=Object.assign({},a);if(b.systemInstruction){let a=b.systemInstruction;delete b.systemInstruction;let c=b.request;c.systemInstruction=a,b.request=c}f.push(b)}return d.requests=f,delete b.config,delete b._url,delete b._query,{path:c,body:b}}getGcsUri(a){return"string"==typeof a?a.startsWith("gs://")?a:void 0:!Array.isArray(a)&&a.gcsUri&&a.gcsUri.length>0?a.gcsUri[0]:void 0}getBigqueryUri(a){return"string"==typeof a?a.startsWith("bq://")?a:void 0:Array.isArray(a)?void 0:a.bigqueryUri}formatDestination(a,b){let c=b?Object.assign({},b):{},d=Date.now().toString();if(c.displayName||(c.displayName=`genaiBatchJob_${d}`),void 0===c.dest){let b=this.getGcsUri(a),e=this.getBigqueryUri(a);if(b)b.endsWith(".jsonl")?c.dest=`${b.slice(0,-6)}/dest`:c.dest=`${b}_dest_${d}`;else if(e)c.dest=`${e}_dest_${d}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return c}async createInternal(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI()){let d,e,i,j,k,l,m=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["model"],kj(f,e)),null!=(i=jQ(a,["src"]))&&jP(d,["inputConfig"],function(a){let b={},c=jQ(a,["format"]);null!=c&&jP(b,["instancesFormat"],c);let d=jQ(a,["gcsUri"]);null!=d&&jP(b,["gcsSource","uris"],d);let e=jQ(a,["bigqueryUri"]);if(null!=e&&jP(b,["bigquerySource","inputUri"],e),void 0!==jQ(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==jQ(a,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return b}(kJ(f,i))),null!=(j=jQ(a,["config"]))&&(k=jQ(j,["displayName"]),void 0!==d&&null!=k&&jP(d,["displayName"],k),l=jQ(j,["dest"]),void 0!==d&&null!=l&&jP(d,["outputConfig"],function(a){let b={},c=jQ(a,["format"]);null!=c&&jP(b,["predictionsFormat"],c);let d=jQ(a,["gcsUri"]);null!=d&&jP(b,["gcsDestination","outputUriPrefix"],d);let e=jQ(a,["bigqueryUri"]);if(null!=e&&jP(b,["bigqueryDestination","outputUri"],e),void 0!==jQ(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==jQ(a,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==jQ(a,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return b}(function(a){if("string"!=typeof a)return a;if(a.startsWith("gs://"))return{format:"jsonl",gcsUri:a};if(a.startsWith("bq://"))return{format:"bigquery",bigqueryUri:a};throw Error(`Unsupported destination: ${a}`)}(l)))),d);return g=jO("batchPredictionJobs",m._url),h=m._query,delete m._url,delete m._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>kO(a))}{let b=kQ(this.apiClient,a);return g=jO("{model}:batchGenerateContent",b._url),h=b._query,delete b._url,delete b._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>kN(a))}}async createEmbeddingsInternal(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let i,j,k,l,m,n,o,p,q=(d=this.apiClient,l={},null!=(m=jQ(a,["model"]))&&jP(l,["_url","model"],kj(d,m)),null!=(n=jQ(a,["src"]))&&jP(l,["batch","inputConfig"],(e=d,i={},null!=(j=jQ(f=n,["fileName"]))&&jP(i,["file_name"],j),null!=(k=jQ(f,["inlinedRequests"]))&&jP(i,["requests"],function(a,b){let c={},d=jQ(b,["contents"]);if(null!=d){let b=kv(a,d);Array.isArray(b)&&(b=b.map(a=>a)),jP(c,["requests[]","request","content"],b)}let e=jQ(b,["config"]);return null!=e&&(jP(c,["_self"],function(a,b){let c=jQ(a,["taskType"]);void 0!==b&&null!=c&&jP(b,["requests[]","taskType"],c);let d=jQ(a,["title"]);void 0!==b&&null!=d&&jP(b,["requests[]","title"],d);let e=jQ(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&jP(b,["requests[]","outputDimensionality"],e),void 0!==jQ(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==jQ(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(e,c)),!function(a,b){for(let[c,d]of Object.entries(b)){let b=c.split("."),e=d.split("."),f=new Set,g=-1;for(let a=0;a<b.length;a++)if("*"===b[a]){g=a;break}if(-1!==g&&e.length>g)for(let a=g;a<e.length;a++){let b=e[a];"*"===b||b.endsWith("[]")||b.endsWith("[0]")||f.add(b)}!function a(b,c,d,e,f){if(e>=c.length||"object"!=typeof b||null===b)return;let g=c[e];if(g.endsWith("[]")){let h=g.slice(0,-2);if(h in b&&Array.isArray(b[h]))for(let g of b[h])a(g,c,d,e+1,f)}else if("*"===g){if("object"==typeof b&&null!==b&&!Array.isArray(b)){let a=Object.keys(b).filter(a=>!a.startsWith("_")&&!f.has(a)),c={};for(let d of a)c[d]=b[d];for(let[a,f]of Object.entries(c)){let c=[];for(let b of d.slice(e))"*"===b?c.push(a):c.push(b);jP(b,c,f)}for(let c of a)delete b[c]}}else g in b&&a(b[g],c,d,e+1,f)}(a,b,e,0,f)}}(c,{"requests[].*":"requests[].request.*"})),c}(e,k)),i)),null!=(o=jQ(a,["config"]))&&(p=jQ(o,["displayName"]),void 0!==l&&null!=p&&jP(l,["batch","displayName"],p)),l);return g=jO("{model}:asyncBatchEmbedContent",q._url),h=q._query,delete q._url,delete q._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(q),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>kN(a))}}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kL(f,e)),d);return h=jO("batchPredictionJobs/{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>kO(a))}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kL(g,c)),b);return h=jO("batches/{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>kN(a))}}async cancel(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kL(f,e)),d);h=jO("batchPredictionJobs/{name}:cancel",g._url),i=g._query,delete g._url,delete g._query,await this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kL(g,c)),b);h=jO("batches/{name}:cancel",f._url),i=f._query,delete f._url,delete f._query,await this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j,k=(d={},null!=(e=jQ(a,["config"]))&&(h=jQ(e,["pageSize"]),void 0!==d&&null!=h&&jP(d,["_query","pageSize"],h),i=jQ(e,["pageToken"]),void 0!==d&&null!=i&&jP(d,["_query","pageToken"],i),j=jQ(e,["filter"]),void 0!==d&&null!=j&&jP(d,["_query","filter"],j)),d);return f=jO("batchPredictionJobs",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["batchPredictionJobs"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>kO(a))),jP(b,["batchJobs"],a)}return b}(a),c=new kf;return Object.assign(c,b),c})}{let b,c,h=(b={},null!=(c=jQ(a,["config"]))&&function(a,b){let c=jQ(a,["pageSize"]);void 0!==b&&null!=c&&jP(b,["_query","pageSize"],c);let d=jQ(a,["pageToken"]);if(void 0!==b&&null!=d&&jP(b,["_query","pageToken"],d),void 0!==jQ(a,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(c,b),b);return f=jO("batches",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["operations"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>kN(a))),jP(b,["batchJobs"],a)}return b}(a),c=new kf;return Object.assign(c,b),c})}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kL(f,e)),d);return h=jO("batchPredictionJobs/{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f;return b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),null!=(d=jQ(a,["name"]))&&jP(b,["name"],d),null!=(e=jQ(a,["done"]))&&jP(b,["done"],e),null!=(f=jQ(a,["error"]))&&jP(b,["error"],f),b})}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kL(g,c)),b);return h=jO("batches/{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f;return b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),null!=(d=jQ(a,["name"]))&&jP(b,["name"],d),null!=(e=jQ(a,["done"]))&&jP(b,["done"],e),null!=(f=jQ(a,["error"]))&&jP(b,["error"],f),b})}}}function kT(a){let b={},c=jQ(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m,n;return c={},null!=(d=jQ(b=a,["mediaResolution"]))&&jP(c,["mediaResolution"],d),null!=(e=jQ(b,["codeExecutionResult"]))&&jP(c,["codeExecutionResult"],e),null!=(f=jQ(b,["executableCode"]))&&jP(c,["executableCode"],f),null!=(g=jQ(b,["fileData"]))&&jP(c,["fileData"],function(a){let b={};if(void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=jQ(a,["fileUri"]);null!=c&&jP(b,["fileUri"],c);let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(g)),null!=(h=jQ(b,["functionCall"]))&&jP(c,["functionCall"],function(a){let b={},c=jQ(a,["id"]);null!=c&&jP(b,["id"],c);let d=jQ(a,["args"]);null!=d&&jP(b,["args"],d);let e=jQ(a,["name"]);if(null!=e&&jP(b,["name"],e),void 0!==jQ(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==jQ(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(h)),null!=(i=jQ(b,["functionResponse"]))&&jP(c,["functionResponse"],i),null!=(j=jQ(b,["inlineData"]))&&jP(c,["inlineData"],function(a){let b={},c=jQ(a,["data"]);if(null!=c&&jP(b,["data"],c),void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(j)),null!=(k=jQ(b,["text"]))&&jP(c,["text"],k),null!=(l=jQ(b,["thought"]))&&jP(c,["thought"],l),null!=(m=jQ(b,["thoughtSignature"]))&&jP(c,["thoughtSignature"],m),null!=(n=jQ(b,["videoMetadata"]))&&jP(c,["videoMetadata"],n),c})),jP(b,["parts"],a)}let d=jQ(a,["role"]);return null!=d&&jP(b,["role"],d),b}class kU extends jN{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new kR(bB.PAGED_ITEM_CACHED_CONTENTS,a=>this.listInternal(a),await this.listInternal(a),a)}async create(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["model"],kk(f,e)),null!=(g=jQ(a,["config"]))&&function(a,b){let c=jQ(a,["ttl"]);void 0!==b&&null!=c&&jP(b,["ttl"],c);let d=jQ(a,["expireTime"]);void 0!==b&&null!=d&&jP(b,["expireTime"],d);let e=jQ(a,["displayName"]);void 0!==b&&null!=e&&jP(b,["displayName"],e);let f=jQ(a,["contents"]);if(void 0!==b&&null!=f){let a=kw(f);Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["contents"],a)}let g=jQ(a,["systemInstruction"]);void 0!==b&&null!=g&&jP(b,["systemInstruction"],ku(g));let h=jQ(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==jQ(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=jQ(a,["description"]);null!=c&&jP(b,["description"],c);let d=jQ(a,["name"]);null!=d&&jP(b,["name"],d);let e=jQ(a,["parameters"]);null!=e&&jP(b,["parameters"],e);let f=jQ(a,["parametersJsonSchema"]);null!=f&&jP(b,["parametersJsonSchema"],f);let g=jQ(a,["response"]);null!=g&&jP(b,["response"],g);let h=jQ(a,["responseJsonSchema"]);return null!=h&&jP(b,["responseJsonSchema"],h),b})(a))),jP(b,["functionDeclarations"],a)}let d=jQ(a,["retrieval"]);null!=d&&jP(b,["retrieval"],d);let e=jQ(a,["googleSearchRetrieval"]);null!=e&&jP(b,["googleSearchRetrieval"],e);let f=jQ(a,["computerUse"]);if(null!=f&&jP(b,["computerUse"],f),void 0!==jQ(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=jQ(a,["codeExecution"]);null!=g&&jP(b,["codeExecution"],g);let h=jQ(a,["enterpriseWebSearch"]);null!=h&&jP(b,["enterpriseWebSearch"],h);let i=jQ(a,["googleMaps"]);null!=i&&jP(b,["googleMaps"],i);let j=jQ(a,["googleSearch"]);null!=j&&jP(b,["googleSearch"],j);let k=jQ(a,["urlContext"]);return null!=k&&jP(b,["urlContext"],k),b})(a))),jP(b,["tools"],a)}let i=jQ(a,["toolConfig"]);void 0!==b&&null!=i&&jP(b,["toolConfig"],i);let j=jQ(a,["kmsKeyName"]);void 0!==b&&null!=j&&jP(b,["encryption_spec","kmsKeyName"],j)}(g,d),d);return h=jO("cachedContents",j._url),i=j._query,delete j._url,delete j._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(j),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f,j=(g=this.apiClient,b={},null!=(c=jQ(a,["model"]))&&jP(b,["model"],kk(g,c)),null!=(f=jQ(a,["config"]))&&function(a,b){var c;let d,e,f,g=jQ(a,["ttl"]);void 0!==b&&null!=g&&jP(b,["ttl"],g);let h=jQ(a,["expireTime"]);void 0!==b&&null!=h&&jP(b,["expireTime"],h);let i=jQ(a,["displayName"]);void 0!==b&&null!=i&&jP(b,["displayName"],i);let j=jQ(a,["contents"]);if(void 0!==b&&null!=j){let a=kw(j);Array.isArray(a)&&(a=a.map(a=>kT(a))),jP(b,["contents"],a)}let k=jQ(a,["systemInstruction"]);void 0!==b&&null!=k&&jP(b,["systemInstruction"],kT(ku(k)));let l=jQ(a,["tools"]);if(void 0!==b&&null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["functionDeclarations"],a)}if(void 0!==jQ(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=jQ(a,["googleSearchRetrieval"]);null!=d&&jP(b,["googleSearchRetrieval"],d);let e=jQ(a,["computerUse"]);null!=e&&jP(b,["computerUse"],e);let f=jQ(a,["fileSearch"]);null!=f&&jP(b,["fileSearch"],f);let g=jQ(a,["codeExecution"]);if(null!=g&&jP(b,["codeExecution"],g),void 0!==jQ(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=jQ(a,["googleMaps"]);null!=h&&jP(b,["googleMaps"],function(a){let b={};if(void 0!==jQ(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=jQ(a,["enableWidget"]);return null!=c&&jP(b,["enableWidget"],c),b}(h));let i=jQ(a,["googleSearch"]);null!=i&&jP(b,["googleSearch"],function(a){let b={};if(void 0!==jQ(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==jQ(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=jQ(a,["timeRangeFilter"]);return null!=c&&jP(b,["timeRangeFilter"],c),b}(i));let j=jQ(a,["urlContext"]);return null!=j&&jP(b,["urlContext"],j),b})(a))),jP(b,["tools"],a)}let m=jQ(a,["toolConfig"]);if(void 0!==b&&null!=m&&jP(b,["toolConfig"],(d={},null!=(e=jQ(c=m,["functionCallingConfig"]))&&jP(d,["functionCallingConfig"],function(a){let b={},c=jQ(a,["mode"]);null!=c&&jP(b,["mode"],c);let d=jQ(a,["allowedFunctionNames"]);if(null!=d&&jP(b,["allowedFunctionNames"],d),void 0!==jQ(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(e)),null!=(f=jQ(c,["retrievalConfig"]))&&jP(d,["retrievalConfig"],f),d)),void 0!==jQ(a,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(f,b),b);return h=jO("cachedContents",j._url),i=j._query,delete j._url,delete j._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(j),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kC(f,e)),d);return h=jO("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kC(g,c)),b);return h=jO("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kC(f,e)),d);return h=jO("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j6;return Object.assign(e,d),e})}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kC(g,c)),b);return h=jO("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j6;return Object.assign(e,d),e})}}async update(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,l=(f=this.apiClient,d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],kC(f,e)),null!=(g=jQ(a,["config"]))&&(j=jQ(g,["ttl"]),void 0!==d&&null!=j&&jP(d,["ttl"],j),k=jQ(g,["expireTime"]),void 0!==d&&null!=k&&jP(d,["expireTime"],k)),d);return h=jO("{name}",l._url),i=l._query,delete l._url,delete l._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b,c,f,j,k,l=(g=this.apiClient,b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],kC(g,c)),null!=(f=jQ(a,["config"]))&&(j=jQ(f,["ttl"]),void 0!==b&&null!=j&&jP(b,["ttl"],j),k=jQ(f,["expireTime"]),void 0!==b&&null!=k&&jP(b,["expireTime"],k)),b);return h=jO("{name}",l._url),i=l._query,delete l._url,delete l._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j=(d={},null!=(e=jQ(a,["config"]))&&(h=jQ(e,["pageSize"]),void 0!==d&&null!=h&&jP(d,["_query","pageSize"],h),i=jQ(e,["pageToken"]),void 0!==d&&null!=i&&jP(d,["_query","pageToken"],i)),d);return f=jO("cachedContents",j._url),g=j._query,delete j._url,delete j._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["cachedContents"],a)}return b}(a),c=new j7;return Object.assign(c,b),c})}{let b,c,h,i,j=(b={},null!=(c=jQ(a,["config"]))&&(h=jQ(c,["pageSize"]),void 0!==b&&null!=h&&jP(b,["_query","pageSize"],h),i=jQ(c,["pageToken"]),void 0!==b&&null!=i&&jP(b,["_query","pageToken"],i)),b);return f=jO("cachedContents",j._url),g=j._query,delete j._url,delete j._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["cachedContents"],a)}return b}(a),c=new j7;return Object.assign(c,b),c})}}}function kV(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function kW(a){return this instanceof kW?(this.v=a,this):new kW(a)}function kX(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof kW?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function kY(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}function kZ(a){if(void 0===a.parts||0===a.parts.length)return!1;for(let b of a.parts)if(void 0===b||0===Object.keys(b).length)return!1;return!0}function k$(a){if(void 0===a||0===a.length)return[];let b=[],c=a.length,d=0;for(;d<c;)if("user"===a[d].role)b.push(a[d]),d++;else{let e=[],f=!0;for(;d<c&&"model"===a[d].role;)e.push(a[d]),f&&!kZ(a[d])&&(f=!1),d++;f?b.push(...e):b.pop()}return b}"function"==typeof SuppressedError&&SuppressedError;class k_{constructor(a,b){this.modelsModule=a,this.apiClient=b}create(a){return new k0(this.apiClient,this.modelsModule,a.model,a.config,structuredClone(a.history))}}class k0{constructor(a,b,c,d={},e=[]){this.apiClient=a,this.modelsModule=b,this.model=c,this.config=d,this.history=e,this.sendPromise=Promise.resolve(),function(a){if(0!==a.length){for(let b of a)if("user"!==b.role&&"model"!==b.role)throw Error(`Role must be user or model, but got ${b.role}.`)}}(e)}async sendMessage(a){var b;await this.sendPromise;let c=ku(a.message),d=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});return this.sendPromise=(async()=>{var a,b,e;let f=await d,g=null==(b=null==(a=f.candidates)?void 0:a[0])?void 0:b.content,h=f.automaticFunctionCallingHistory,i=this.getHistory(!0).length,j=[];null!=h&&(j=null!=(e=h.slice(i))?e:[]),this.recordHistory(c,g?[g]:[],j)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),d}async sendMessageStream(a){var b;await this.sendPromise;let c=ku(a.message),d=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});this.sendPromise=d.then(()=>void 0).catch(()=>void 0);let e=await d;return this.processStreamResponse(e,c)}getHistory(a=!1){return structuredClone(a?k$(this.history):this.history)}processStreamResponse(a,b){return kX(this,arguments,function*(){let c=[];try{for(var d,e,f,g,h,i,j,k=!0,l=kY(a);!(d=(j=yield kW(l.next())).done);k=!0){if(g=j.value,k=!1,function(a){var b;if(void 0==a.candidates||0===a.candidates.length)return!1;let c=null==(b=a.candidates[0])?void 0:b.content;return void 0!==c&&kZ(c)}(g)){let a=null==(i=null==(h=g.candidates)?void 0:h[0])?void 0:i.content;void 0!==a&&c.push(a)}yield yield kW(g)}}catch(a){e={error:a}}finally{try{!k&&!d&&(f=l.return)&&(yield kW(f.call(l)))}finally{if(e)throw e.error}}this.recordHistory(b,c)})}recordHistory(a,b,c){let d=[];b.length>0&&b.every(a=>void 0!==a.role)?d=b:d.push({role:"model",parts:[]}),c&&c.length>0?this.history.push(...k$(c)):this.history.push(a),this.history.push(...d)}}class k1 extends Error{constructor(a){super(a.message),this.name="ApiError",this.status=a.status,Object.setPrototypeOf(this,k1.prototype)}}class k2 extends jN{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new kR(bB.PAGED_ITEM_FILES,a=>this.listInternal(a),await this.listInternal(a),a)}async upload(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(a.file,a.config).then(a=>a)}async download(a){await this.apiClient.downloadFile(a)}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=jQ(a,["config"]))&&(h=jQ(g,["pageSize"]),void 0!==f&&null!=h&&jP(f,["_query","pageSize"],h),i=jQ(g,["pageToken"]),void 0!==f&&null!=i&&jP(f,["_query","pageToken"],i)),f);return d=jO("files",j._url),e=j._query,delete j._url,delete j._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["files"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["files"],a)}return b}(a),c=new kc;return Object.assign(c,b),c})}}async createInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=jQ(a,["file"]))&&jP(f,["file"],g),f);return d=jO("upload/v1beta/files",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new kd;return Object.assign(e,d),e})}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","file"],kG(g)),f);return d=jO("files/{file}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","file"],kG(g)),f);return d=jO("files/{file}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new ke;return Object.assign(e,d),e})}}}function k3(a){let b={},c=jQ(a,["data"]);if(null!=c&&jP(b,["data"],c),void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}function k4(a){let b={},c=jQ(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m,n;return c={},null!=(d=jQ(b=a,["mediaResolution"]))&&jP(c,["mediaResolution"],d),null!=(e=jQ(b,["codeExecutionResult"]))&&jP(c,["codeExecutionResult"],e),null!=(f=jQ(b,["executableCode"]))&&jP(c,["executableCode"],f),null!=(g=jQ(b,["fileData"]))&&jP(c,["fileData"],function(a){let b={};if(void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=jQ(a,["fileUri"]);null!=c&&jP(b,["fileUri"],c);let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(g)),null!=(h=jQ(b,["functionCall"]))&&jP(c,["functionCall"],function(a){let b={},c=jQ(a,["id"]);null!=c&&jP(b,["id"],c);let d=jQ(a,["args"]);null!=d&&jP(b,["args"],d);let e=jQ(a,["name"]);if(null!=e&&jP(b,["name"],e),void 0!==jQ(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==jQ(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(h)),null!=(i=jQ(b,["functionResponse"]))&&jP(c,["functionResponse"],i),null!=(j=jQ(b,["inlineData"]))&&jP(c,["inlineData"],function(a){let b={},c=jQ(a,["data"]);if(null!=c&&jP(b,["data"],c),void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(j)),null!=(k=jQ(b,["text"]))&&jP(c,["text"],k),null!=(l=jQ(b,["thought"]))&&jP(c,["thought"],l),null!=(m=jQ(b,["thoughtSignature"]))&&jP(c,["thoughtSignature"],m),null!=(n=jQ(b,["videoMetadata"]))&&jP(c,["videoMetadata"],n),c})),jP(b,["parts"],a)}let d=jQ(a,["role"]);return null!=d&&jP(b,["role"],d),b}function k5(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>k4(a))),jP(c,["contents"],a)}let f=jQ(b,["config"]);return null!=f&&jP(c,["generationConfig"],function(a,b,c){var d;let e,f,g,h={},i=jQ(b,["systemInstruction"]);void 0!==c&&null!=i&&jP(c,["systemInstruction"],k4(ku(i)));let j=jQ(b,["temperature"]);null!=j&&jP(h,["temperature"],j);let k=jQ(b,["topP"]);null!=k&&jP(h,["topP"],k);let l=jQ(b,["topK"]);null!=l&&jP(h,["topK"],l);let m=jQ(b,["candidateCount"]);null!=m&&jP(h,["candidateCount"],m);let n=jQ(b,["maxOutputTokens"]);null!=n&&jP(h,["maxOutputTokens"],n);let o=jQ(b,["stopSequences"]);null!=o&&jP(h,["stopSequences"],o);let p=jQ(b,["responseLogprobs"]);null!=p&&jP(h,["responseLogprobs"],p);let q=jQ(b,["logprobs"]);null!=q&&jP(h,["logprobs"],q);let r=jQ(b,["presencePenalty"]);null!=r&&jP(h,["presencePenalty"],r);let s=jQ(b,["frequencyPenalty"]);null!=s&&jP(h,["frequencyPenalty"],s);let t=jQ(b,["seed"]);null!=t&&jP(h,["seed"],t);let u=jQ(b,["responseMimeType"]);null!=u&&jP(h,["responseMimeType"],u);let v=jQ(b,["responseSchema"]);null!=v&&jP(h,["responseSchema"],kx(v));let w=jQ(b,["responseJsonSchema"]);if(null!=w&&jP(h,["responseJsonSchema"],w),void 0!==jQ(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==jQ(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let x=jQ(b,["safetySettings"]);if(void 0!==c&&null!=x){let a=x;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["category"]);if(null!=c&&jP(b,["category"],c),void 0!==jQ(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let d=jQ(a,["threshold"]);return null!=d&&jP(b,["threshold"],d),b})(a))),jP(c,["safetySettings"],a)}let y=jQ(b,["tools"]);if(void 0!==c&&null!=y){let a=kB(y);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["functionDeclarations"],a)}if(void 0!==jQ(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=jQ(a,["googleSearchRetrieval"]);null!=d&&jP(b,["googleSearchRetrieval"],d);let e=jQ(a,["computerUse"]);null!=e&&jP(b,["computerUse"],e);let f=jQ(a,["fileSearch"]);null!=f&&jP(b,["fileSearch"],f);let g=jQ(a,["codeExecution"]);if(null!=g&&jP(b,["codeExecution"],g),void 0!==jQ(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=jQ(a,["googleMaps"]);null!=h&&jP(b,["googleMaps"],function(a){let b={};if(void 0!==jQ(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=jQ(a,["enableWidget"]);return null!=c&&jP(b,["enableWidget"],c),b}(h));let i=jQ(a,["googleSearch"]);null!=i&&jP(b,["googleSearch"],function(a){let b={};if(void 0!==jQ(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==jQ(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=jQ(a,["timeRangeFilter"]);return null!=c&&jP(b,["timeRangeFilter"],c),b}(i));let j=jQ(a,["urlContext"]);return null!=j&&jP(b,["urlContext"],j),b})(kA(a)))),jP(c,["tools"],a)}let z=jQ(b,["toolConfig"]);if(void 0!==c&&null!=z&&jP(c,["toolConfig"],(e={},null!=(f=jQ(d=z,["functionCallingConfig"]))&&jP(e,["functionCallingConfig"],function(a){let b={},c=jQ(a,["mode"]);null!=c&&jP(b,["mode"],c);let d=jQ(a,["allowedFunctionNames"]);if(null!=d&&jP(b,["allowedFunctionNames"],d),void 0!==jQ(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(f)),null!=(g=jQ(d,["retrievalConfig"]))&&jP(e,["retrievalConfig"],g),e)),void 0!==jQ(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let A=jQ(b,["cachedContent"]);void 0!==c&&null!=A&&jP(c,["cachedContent"],kC(a,A));let B=jQ(b,["responseModalities"]);null!=B&&jP(h,["responseModalities"],B);let C=jQ(b,["mediaResolution"]);null!=C&&jP(h,["mediaResolution"],C);let D=jQ(b,["speechConfig"]);if(null!=D&&jP(h,["speechConfig"],ky(D)),void 0!==jQ(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let E=jQ(b,["thinkingConfig"]);null!=E&&jP(h,["thinkingConfig"],E);let F=jQ(b,["imageConfig"]);null!=F&&jP(h,["imageConfig"],function(a){let b={},c=jQ(a,["aspectRatio"]);null!=c&&jP(b,["aspectRatio"],c);let d=jQ(a,["imageSize"]);if(null!=d&&jP(b,["imageSize"],d),void 0!==jQ(a,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==jQ(a,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return b}(F));let G=jQ(b,["enableEnhancedCivicAnswers"]);return null!=G&&jP(h,["enableEnhancedCivicAnswers"],G),h}(a,f,c)),c}function k6(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>a)),jP(c,["contents"],a)}let f=jQ(b,["config"]);return null!=f&&jP(c,["generationConfig"],function(a,b,c){var d;let e,f,g,h,i,j={},k=jQ(b,["systemInstruction"]);void 0!==c&&null!=k&&jP(c,["systemInstruction"],ku(k));let l=jQ(b,["temperature"]);null!=l&&jP(j,["temperature"],l);let m=jQ(b,["topP"]);null!=m&&jP(j,["topP"],m);let n=jQ(b,["topK"]);null!=n&&jP(j,["topK"],n);let o=jQ(b,["candidateCount"]);null!=o&&jP(j,["candidateCount"],o);let p=jQ(b,["maxOutputTokens"]);null!=p&&jP(j,["maxOutputTokens"],p);let q=jQ(b,["stopSequences"]);null!=q&&jP(j,["stopSequences"],q);let r=jQ(b,["responseLogprobs"]);null!=r&&jP(j,["responseLogprobs"],r);let s=jQ(b,["logprobs"]);null!=s&&jP(j,["logprobs"],s);let t=jQ(b,["presencePenalty"]);null!=t&&jP(j,["presencePenalty"],t);let u=jQ(b,["frequencyPenalty"]);null!=u&&jP(j,["frequencyPenalty"],u);let v=jQ(b,["seed"]);null!=v&&jP(j,["seed"],v);let w=jQ(b,["responseMimeType"]);null!=w&&jP(j,["responseMimeType"],w);let x=jQ(b,["responseSchema"]);null!=x&&jP(j,["responseSchema"],kx(x));let y=jQ(b,["responseJsonSchema"]);null!=y&&jP(j,["responseJsonSchema"],y);let z=jQ(b,["routingConfig"]);null!=z&&jP(j,["routingConfig"],z);let A=jQ(b,["modelSelectionConfig"]);null!=A&&jP(j,["modelConfig"],A);let B=jQ(b,["safetySettings"]);if(void 0!==c&&null!=B){let a=B;Array.isArray(a)&&(a=a.map(a=>a)),jP(c,["safetySettings"],a)}let C=jQ(b,["tools"]);if(void 0!==c&&null!=C){let a=kB(C);Array.isArray(a)&&(a=a.map(a=>lh(kA(a)))),jP(c,["tools"],a)}let D=jQ(b,["toolConfig"]);void 0!==c&&null!=D&&jP(c,["toolConfig"],D);let E=jQ(b,["labels"]);void 0!==c&&null!=E&&jP(c,["labels"],E);let F=jQ(b,["cachedContent"]);void 0!==c&&null!=F&&jP(c,["cachedContent"],kC(a,F));let G=jQ(b,["responseModalities"]);null!=G&&jP(j,["responseModalities"],G);let H=jQ(b,["mediaResolution"]);null!=H&&jP(j,["mediaResolution"],H);let I=jQ(b,["speechConfig"]);null!=I&&jP(j,["speechConfig"],ky(I));let J=jQ(b,["audioTimestamp"]);null!=J&&jP(j,["audioTimestamp"],J);let K=jQ(b,["thinkingConfig"]);null!=K&&jP(j,["thinkingConfig"],K);let L=jQ(b,["imageConfig"]);if(null!=L&&jP(j,["imageConfig"],(e={},null!=(f=jQ(d=L,["aspectRatio"]))&&jP(e,["aspectRatio"],f),null!=(g=jQ(d,["imageSize"]))&&jP(e,["imageSize"],g),null!=(h=jQ(d,["outputMimeType"]))&&jP(e,["imageOutputOptions","mimeType"],h),null!=(i=jQ(d,["outputCompressionQuality"]))&&jP(e,["imageOutputOptions","compressionQuality"],i),e)),void 0!==jQ(b,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return j}(a,f,c)),c}function k7(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["content"]);null!=c&&jP(b,["content"],c);let d=jQ(a,["citationMetadata"]);null!=d&&jP(b,["citationMetadata"],function(a){let b={},c=jQ(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["citations"],a)}return b}(d));let e=jQ(a,["tokenCount"]);null!=e&&jP(b,["tokenCount"],e);let f=jQ(a,["finishReason"]);null!=f&&jP(b,["finishReason"],f);let g=jQ(a,["avgLogprobs"]);null!=g&&jP(b,["avgLogprobs"],g);let h=jQ(a,["groundingMetadata"]);null!=h&&jP(b,["groundingMetadata"],h);let i=jQ(a,["index"]);null!=i&&jP(b,["index"],i);let j=jQ(a,["logprobsResult"]);null!=j&&jP(b,["logprobsResult"],j);let k=jQ(a,["safetyRatings"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["safetyRatings"],a)}let l=jQ(a,["urlContextMetadata"]);return null!=l&&jP(b,["urlContextMetadata"],l),b})(a))),jP(b,["candidates"],a)}let e=jQ(a,["modelVersion"]);null!=e&&jP(b,["modelVersion"],e);let f=jQ(a,["promptFeedback"]);null!=f&&jP(b,["promptFeedback"],f);let g=jQ(a,["responseId"]);null!=g&&jP(b,["responseId"],g);let h=jQ(a,["usageMetadata"]);return null!=h&&jP(b,["usageMetadata"],h),b}function k8(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["candidates"],a)}let e=jQ(a,["createTime"]);null!=e&&jP(b,["createTime"],e);let f=jQ(a,["modelVersion"]);null!=f&&jP(b,["modelVersion"],f);let g=jQ(a,["promptFeedback"]);null!=g&&jP(b,["promptFeedback"],g);let h=jQ(a,["responseId"]);null!=h&&jP(b,["responseId"],h);let i=jQ(a,["usageMetadata"]);return null!=i&&jP(b,["usageMetadata"],i),b}function k9(a){let b={},c=jQ(a,["_self"]);null!=c&&jP(b,["image"],la(c));let d=jQ(a,["raiFilteredReason"]);null!=d&&jP(b,["raiFilteredReason"],d);let e=jQ(a,["_self"]);null!=e&&jP(b,["safetyAttributes"],lg(e));let f=jQ(a,["prompt"]);return null!=f&&jP(b,["enhancedPrompt"],f),b}function la(a){let b={},c=jQ(a,["gcsUri"]);null!=c&&jP(b,["gcsUri"],c);let d=jQ(a,["bytesBase64Encoded"]);null!=d&&jP(b,["imageBytes"],jR(d));let e=jQ(a,["mimeType"]);return null!=e&&jP(b,["mimeType"],e),b}function lb(a){let b={};if(void 0!==jQ(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let c=jQ(a,["imageBytes"]);null!=c&&jP(b,["bytesBase64Encoded"],jR(c));let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}function lc(a){let b={},c=jQ(a,["gcsUri"]);null!=c&&jP(b,["gcsUri"],c);let d=jQ(a,["imageBytes"]);null!=d&&jP(b,["bytesBase64Encoded"],jR(d));let e=jQ(a,["mimeType"]);return null!=e&&jP(b,["mimeType"],e),b}function ld(a){var b;let c,d,e,f,g={},h=jQ(a,["name"]);null!=h&&jP(g,["name"],h);let i=jQ(a,["displayName"]);null!=i&&jP(g,["displayName"],i);let j=jQ(a,["description"]);null!=j&&jP(g,["description"],j);let k=jQ(a,["version"]);null!=k&&jP(g,["version"],k);let l=jQ(a,["_self"]);null!=l&&jP(g,["tunedModelInfo"],(c={},null!=(d=jQ(b=l,["baseModel"]))&&jP(c,["baseModel"],d),null!=(e=jQ(b,["createTime"]))&&jP(c,["createTime"],e),null!=(f=jQ(b,["updateTime"]))&&jP(c,["updateTime"],f),c));let m=jQ(a,["inputTokenLimit"]);null!=m&&jP(g,["inputTokenLimit"],m);let n=jQ(a,["outputTokenLimit"]);null!=n&&jP(g,["outputTokenLimit"],n);let o=jQ(a,["supportedGenerationMethods"]);null!=o&&jP(g,["supportedActions"],o);let p=jQ(a,["temperature"]);null!=p&&jP(g,["temperature"],p);let q=jQ(a,["maxTemperature"]);null!=q&&jP(g,["maxTemperature"],q);let r=jQ(a,["topP"]);null!=r&&jP(g,["topP"],r);let s=jQ(a,["topK"]);null!=s&&jP(g,["topK"],s);let t=jQ(a,["thinking"]);return null!=t&&jP(g,["thinking"],t),g}function le(a){var b;let c,d,e,f,g={},h=jQ(a,["name"]);null!=h&&jP(g,["name"],h);let i=jQ(a,["displayName"]);null!=i&&jP(g,["displayName"],i);let j=jQ(a,["description"]);null!=j&&jP(g,["description"],j);let k=jQ(a,["versionId"]);null!=k&&jP(g,["version"],k);let l=jQ(a,["deployedModels"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>{let b,c,d;return b={},null!=(c=jQ(a,["endpoint"]))&&jP(b,["name"],c),null!=(d=jQ(a,["deployedModelId"]))&&jP(b,["deployedModelId"],d),b})),jP(g,["endpoints"],a)}let m=jQ(a,["labels"]);null!=m&&jP(g,["labels"],m);let n=jQ(a,["_self"]);null!=n&&jP(g,["tunedModelInfo"],(c={},null!=(d=jQ(b=n,["labels","google-vertex-llm-tuning-base-model-id"]))&&jP(c,["baseModel"],d),null!=(e=jQ(b,["createTime"]))&&jP(c,["createTime"],e),null!=(f=jQ(b,["updateTime"]))&&jP(c,["updateTime"],f),c));let o=jQ(a,["defaultCheckpointId"]);null!=o&&jP(g,["defaultCheckpointId"],o);let p=jQ(a,["checkpoints"]);if(null!=p){let a=p;Array.isArray(a)&&(a=a.map(a=>a)),jP(g,["checkpoints"],a)}return g}function lf(a){let b={},c=jQ(a,["safetyAttributes","categories"]);null!=c&&jP(b,["categories"],c);let d=jQ(a,["safetyAttributes","scores"]);null!=d&&jP(b,["scores"],d);let e=jQ(a,["contentType"]);return null!=e&&jP(b,["contentType"],e),b}function lg(a){let b={},c=jQ(a,["safetyAttributes","categories"]);null!=c&&jP(b,["categories"],c);let d=jQ(a,["safetyAttributes","scores"]);null!=d&&jP(b,["scores"],d);let e=jQ(a,["contentType"]);return null!=e&&jP(b,["contentType"],e),b}function lh(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==jQ(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=jQ(a,["description"]);null!=c&&jP(b,["description"],c);let d=jQ(a,["name"]);null!=d&&jP(b,["name"],d);let e=jQ(a,["parameters"]);null!=e&&jP(b,["parameters"],e);let f=jQ(a,["parametersJsonSchema"]);null!=f&&jP(b,["parametersJsonSchema"],f);let g=jQ(a,["response"]);null!=g&&jP(b,["response"],g);let h=jQ(a,["responseJsonSchema"]);return null!=h&&jP(b,["responseJsonSchema"],h),b})(a))),jP(b,["functionDeclarations"],a)}let d=jQ(a,["retrieval"]);null!=d&&jP(b,["retrieval"],d);let e=jQ(a,["googleSearchRetrieval"]);null!=e&&jP(b,["googleSearchRetrieval"],e);let f=jQ(a,["computerUse"]);if(null!=f&&jP(b,["computerUse"],f),void 0!==jQ(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=jQ(a,["codeExecution"]);null!=g&&jP(b,["codeExecution"],g);let h=jQ(a,["enterpriseWebSearch"]);null!=h&&jP(b,["enterpriseWebSearch"],h);let i=jQ(a,["googleMaps"]);null!=i&&jP(b,["googleMaps"],i);let j=jQ(a,["googleSearch"]);null!=j&&jP(b,["googleSearch"],j);let k=jQ(a,["urlContext"]);return null!=k&&jP(b,["urlContext"],k),b}function li(a){let b={},c=jQ(a,["uri"]);null!=c&&jP(b,["uri"],c);let d=jQ(a,["videoBytes"]);null!=d&&jP(b,["encodedVideo"],jR(d));let e=jQ(a,["mimeType"]);return null!=e&&jP(b,["encoding"],e),b}function lj(a){let b={},c=jQ(a,["uri"]);null!=c&&jP(b,["gcsUri"],c);let d=jQ(a,["videoBytes"]);null!=d&&jP(b,["bytesBase64Encoded"],jR(d));let e=jQ(a,["mimeType"]);return null!=e&&jP(b,["mimeType"],e),b}function lk(a,b){let c=jQ(a,["mimeType"]);void 0!==b&&null!=c&&jP(b,["mimeType"],c);let d=jQ(a,["displayName"]);void 0!==b&&null!=d&&jP(b,["displayName"],d);let e=jQ(a,["customMetadata"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["customMetadata"],a)}let f=jQ(a,["chunkingConfig"]);return void 0!==b&&null!=f&&jP(b,["chunkingConfig"],f),{}}let ll="x-goog-api-client";class lm{constructor(a){var b,c;this.clientOptions=Object.assign(Object.assign({},a),{project:a.project,location:a.location,apiKey:a.apiKey,vertexai:a.vertexai});const d={};this.clientOptions.vertexai?(d.apiVersion=null!=(b=this.clientOptions.apiVersion)?b:"v1beta1",d.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(d.apiVersion=null!=(c=this.clientOptions.apiVersion)?c:"v1beta",d.baseUrl="https://generativelanguage.googleapis.com/"),d.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=d,a.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(d,a.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var a;return null!=(a=this.clientOptions.vertexai)&&a}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){let a=new Headers;return await this.clientOptions.auth.addAuthHeaders(a),a}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(a){if(!a||void 0===a.baseUrl||void 0===a.apiVersion)throw Error("HTTP options are not correctly set.");let b=[a.baseUrl.endsWith("/")?a.baseUrl.slice(0,-1):a.baseUrl];return a.apiVersion&&""!==a.apiVersion&&b.push(a.apiVersion),b.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let a=new URL(this.getBaseUrl());return a.protocol="http:"==a.protocol?"ws":"wss",a.toString()}setBaseUrl(a){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=a;else throw Error("HTTP options are not correctly set.")}constructUrl(a,b,c){let d=[this.getRequestUrlInternal(b)];return c&&d.push(this.getBaseResourcePath()),""!==a&&d.push(a),new URL(`${d.join("/")}`)}shouldPrependVertexProjectPath(a){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||a.path.startsWith("projects/")||"GET"===a.httpMethod&&a.path.startsWith("publishers/google/models"))}async request(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);if(a.queryParams)for(let[b,c]of Object.entries(a.queryParams))d.searchParams.append(b,String(c));let e={};if("GET"===a.httpMethod){if(a.body&&"{}"!==a.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else e.body=a.body;return e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.unaryApiCall(d,e,a.httpMethod)}patchHttpOptions(a,b){let c=JSON.parse(JSON.stringify(a));for(let[a,d]of Object.entries(b))"object"==typeof d?c[a]=Object.assign(Object.assign({},c[a]),d):void 0!==d&&(c[a]=d);return c}async requestStream(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);d.searchParams.has("alt")&&"sse"===d.searchParams.get("alt")||d.searchParams.set("alt","sse");let e={};return e.body=a.body,e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.streamApiCall(d,e,a.httpMethod)}async includeExtraHttpOptionsToRequestInit(a,b,c,d){if(b&&b.timeout||d){let c=new AbortController,e=c.signal;if(b.timeout&&(null==b?void 0:b.timeout)>0){let a=setTimeout(()=>c.abort(),b.timeout);a&&"function"==typeof a.unref&&a.unref()}d&&d.addEventListener("abort",()=>{c.abort()}),a.signal=e}return b&&null!==b.extraBody&&function(a,b){if(!b||0===Object.keys(b).length)return;if(a.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let c={};if("string"==typeof a.body&&a.body.length>0)try{let b=JSON.parse(a.body);if("object"!=typeof b||null===b||Array.isArray(b))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");c=b}catch(a){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}a.body=JSON.stringify(function a(b,c){let d=Object.assign({},b);for(let b in c)if(Object.prototype.hasOwnProperty.call(c,b)){let e=c[b],f=d[b];e&&"object"==typeof e&&!Array.isArray(e)&&f&&"object"==typeof f&&!Array.isArray(f)?d[b]=a(f,e):(f&&e&&typeof f!=typeof e&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${b}". Original type: ${typeof f}, New type: ${typeof e}. Overwriting.`),d[b]=e)}return d}(c,b))}(a,b.extraBody),a.headers=await this.getHeadersInternal(b,c),a}async unaryApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await ln(a),new jT(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}async streamApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await ln(a),this.processStreamResponse(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}processStreamResponse(a){return kX(this,arguments,function*(){var b;let c=null==(b=null==a?void 0:a.body)?void 0:b.getReader(),d=new TextDecoder("utf-8");if(!c)throw Error("Response body is empty");try{let b="",e="data:",f=["\n\n","\r\r","\r\n\r\n"];for(;;){let{done:g,value:h}=yield kW(c.read());if(g){if(b.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let i=d.decode(h,{stream:!0});try{let a=JSON.parse(i);if("error"in a){let b=JSON.parse(JSON.stringify(a.error)),c=b.status,d=b.code,e=`got status: ${c}. ${JSON.stringify(a)}`;if(d>=400&&d<600)throw new k1({message:e,status:d})}}catch(a){if("ApiError"===a.name)throw a}b+=i;let j=-1,k=0;for(;;){for(let a of(j=-1,k=0,f)){let c=b.indexOf(a);-1!==c&&(-1===j||c<j)&&(j=c,k=a.length)}if(-1===j)break;let c=b.substring(0,j);b=b.substring(j+k);let d=c.trim();if(d.startsWith(e)){let b=d.substring(e.length).trim();try{let c=new Response(b,{headers:null==a?void 0:a.headers,status:null==a?void 0:a.status,statusText:null==a?void 0:a.statusText});yield yield kW(new jT(c))}catch(a){throw Error(`exception parsing stream chunk ${b}. ${a}`)}}}}}finally{c.releaseLock()}})}async apiCall(a,b){return fetch(a,b).catch(a=>{throw Error(`exception ${a} sending request`)})}getDefaultHeaders(){let a={},b="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return a["User-Agent"]=b,a[ll]=b,a["Content-Type"]="application/json",a}async getHeadersInternal(a,b){let c=new Headers;if(a&&a.headers){for(let[b,d]of Object.entries(a.headers))c.append(b,d);a.timeout&&a.timeout>0&&c.append("X-Server-Timeout",String(Math.ceil(a.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(c,b),c}getFileName(a){var b;let c="";return"string"==typeof a&&(c=null!=(b=(c=a.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())?b:""),c}async uploadFile(a,b){var c;let d={};null!=b&&(d.mimeType=b.mimeType,d.name=b.name,d.displayName=b.displayName),d.name&&!d.name.startsWith("files/")&&(d.name=`files/${d.name}`);let e=this.clientOptions.uploader,f=await e.stat(a);d.sizeBytes=String(f.size);let g=null!=(c=null==b?void 0:b.mimeType)?c:f.type;if(void 0===g||""===g)throw Error("Can not determine mimeType. Please provide mimeType in the config.");d.mimeType=g;let h={file:d},i=this.getFileName(a),j=jO("upload/v1beta/files",h._url),k=await this.fetchUploadUrl(j,d.sizeBytes,d.mimeType,i,h,null==b?void 0:b.httpOptions);return e.upload(a,k,this)}async uploadFileToFileSearchStore(a,b,c){var d;let e=this.clientOptions.uploader,f=await e.stat(b),g=String(f.size),h=null!=(d=null==c?void 0:c.mimeType)?d:f.type;if(void 0===h||""===h)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let i=`upload/v1beta/${a}:uploadToFileSearchStore`,j=this.getFileName(b),k={};null!=c&&lk(c,k);let l=await this.fetchUploadUrl(i,g,h,j,k,null==c?void 0:c.httpOptions);return e.uploadToFileSearchStore(b,l,this)}async downloadFile(a){let b=this.clientOptions.downloader;await b.download(a,this)}async fetchUploadUrl(a,b,c,d,e,f){var g;let h={};h=f||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${b}`,"X-Goog-Upload-Header-Content-Type":`${c}`},d?{"X-Goog-Upload-File-Name":d}:{})};let i=await this.request({path:a,body:JSON.stringify(e),httpMethod:"POST",httpOptions:h});if(!i||!(null==i?void 0:i.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let j=null==(g=null==i?void 0:i.headers)?void 0:g["x-goog-upload-url"];if(void 0===j)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return j}}async function ln(a){var b;if(void 0===a)throw Error("response is undefined");if(!a.ok){let c=a.status,d=JSON.stringify((null==(b=a.headers.get("content-type"))?void 0:b.includes("application/json"))?await a.json():{error:{message:await a.text(),code:a.status,status:a.statusText}});if(c>=400&&c<600)throw new k1({message:d,status:c});throw Error(d)}}function lo(a){for(let c of a){var b;if(null!==(b=c)&&"object"==typeof b&&b instanceof lq||"object"==typeof c&&"inputSchema"in c)return!0}return!1}function lp(a){var b;let c=null!=(b=a[ll])?b:"";a[ll]=(c+" mcp_used/unknown").trimStart()}class lq{constructor(a=[],b){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=a,this.config=b}static create(a,b){return new lq(a,b)}async initialize(){var a,b,c,d;if(this.mcpTools.length>0)return;let e={},f=[];for(let j of this.mcpClients)try{for(var g,h=!0,i=(b=void 0,kY(function(a){return kX(this,arguments,function*(a,b=100){let c,d=0;for(;d<b;){let b=yield kW(a.listTools({cursor:c}));for(let a of b.tools)yield yield kW(a),d++;if(!b.nextCursor)break;c=b.nextCursor}})}(j)));!(a=(g=await i.next()).done);h=!0){d=g.value,h=!1,f.push(d);let a=d.name;if(e[a])throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);e[a]=j}}catch(a){b={error:a}}finally{try{!h&&!a&&(c=i.return)&&await c.call(i)}finally{if(b)throw b.error}}this.mcpTools=f,this.functionNameToMcpClient=e}async tool(){return await this.initialize(),function(a,b={}){let c=[],d=new Set;for(let e of a){let a=e.name;if(d.has(a))throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);d.add(a);let f=function(a,b={}){let c={name:a.name,description:a.description,parametersJsonSchema:a.inputSchema};return a.outputSchema&&(c.responseJsonSchema=a.outputSchema),b.behavior&&(c.behavior=b.behavior),{functionDeclarations:[c]}}(e,b);f.functionDeclarations&&c.push(...f.functionDeclarations)}return{functionDeclarations:c}}(this.mcpTools,this.config)}async callTool(a){await this.initialize();let b=[];for(let c of a)if(c.name in this.functionNameToMcpClient){let a,d=this.functionNameToMcpClient[c.name];this.config.timeout&&(a={timeout:this.config.timeout});let e=await d.callTool({name:c.name,arguments:c.args},void 0,a);b.push({functionResponse:{name:c.name,response:e.isError?{error:e}:e}})}return b}}async function lr(a,b,c){let d=new kh;Object.assign(d,c.data instanceof Blob?JSON.parse(await c.data.text()):JSON.parse(c.data)),b(d)}class ls{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c}async connect(a){var b,c;let d;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let e=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion(),g=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(this.apiClient.getDefaultHeaders()),h=this.apiClient.getApiKey(),i=`${e}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateMusic?key=${h}`,j=()=>{},k=new Promise(a=>{j=a}),l=a.callbacks,m=this.apiClient,n={onopen:function(){j({})},onmessage:a=>{lr(m,l.onmessage,a)},onerror:null!=(b=null==l?void 0:l.onerror)?b:function(a){},onclose:null!=(c=null==l?void 0:l.onclose)?c:function(a){}},o=this.webSocketFactory.create(i,(d={},g.forEach((a,b)=>{d[b]=a}),d),n);o.connect(),await k;let p=kj(this.apiClient,a.model);return o.send(JSON.stringify({setup:{model:p}})),new lt(o,this.apiClient)}}class lt{constructor(a,b){this.conn=a,this.apiClient=b}async setWeightedPrompts(a){if(!a.weightedPrompts||0===Object.keys(a.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let b=function(a){let b={},c=jQ(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["weightedPrompts"],a)}return b}(a);this.conn.send(JSON.stringify({clientContent:b}))}async setMusicGenerationConfig(a){let b,c;a.musicGenerationConfig||(a.musicGenerationConfig={});let d=(b={},null!=(c=jQ(a,["musicGenerationConfig"]))&&jP(b,["musicGenerationConfig"],c),b);this.conn.send(JSON.stringify(d))}sendPlaybackControl(a){this.conn.send(JSON.stringify({playbackControl:a}))}play(){this.sendPlaybackControl(bA.PLAY)}pause(){this.sendPlaybackControl(bA.PAUSE)}stop(){this.sendPlaybackControl(bA.STOP)}resetContext(){this.sendPlaybackControl(bA.RESET_CONTEXT)}close(){this.conn.close()}}async function lu(a,b,c){let d=new kg,e=JSON.parse(c.data instanceof Blob?await c.data.text():c.data instanceof ArrayBuffer?new TextDecoder().decode(c.data):c.data);if(a.isVertexAI()){let a,b,c,f,g,h,i,j,k;Object.assign(d,(a={},null!=(b=jQ(e,["setupComplete"]))&&jP(a,["setupComplete"],b),null!=(c=jQ(e,["serverContent"]))&&jP(a,["serverContent"],c),null!=(f=jQ(e,["toolCall"]))&&jP(a,["toolCall"],f),null!=(g=jQ(e,["toolCallCancellation"]))&&jP(a,["toolCallCancellation"],g),null!=(h=jQ(e,["usageMetadata"]))&&jP(a,["usageMetadata"],function(a){let b={},c=jQ(a,["promptTokenCount"]);null!=c&&jP(b,["promptTokenCount"],c);let d=jQ(a,["cachedContentTokenCount"]);null!=d&&jP(b,["cachedContentTokenCount"],d);let e=jQ(a,["candidatesTokenCount"]);null!=e&&jP(b,["responseTokenCount"],e);let f=jQ(a,["toolUsePromptTokenCount"]);null!=f&&jP(b,["toolUsePromptTokenCount"],f);let g=jQ(a,["thoughtsTokenCount"]);null!=g&&jP(b,["thoughtsTokenCount"],g);let h=jQ(a,["totalTokenCount"]);null!=h&&jP(b,["totalTokenCount"],h);let i=jQ(a,["promptTokensDetails"]);if(null!=i){let a=i;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["promptTokensDetails"],a)}let j=jQ(a,["cacheTokensDetails"]);if(null!=j){let a=j;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["cacheTokensDetails"],a)}let k=jQ(a,["candidatesTokensDetails"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["responseTokensDetails"],a)}let l=jQ(a,["toolUsePromptTokensDetails"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["toolUsePromptTokensDetails"],a)}let m=jQ(a,["trafficType"]);return null!=m&&jP(b,["trafficType"],m),b}(h)),null!=(i=jQ(e,["goAway"]))&&jP(a,["goAway"],i),null!=(j=jQ(e,["sessionResumptionUpdate"]))&&jP(a,["sessionResumptionUpdate"],j),null!=(k=jQ(e,["voiceActivityDetectionSignal"]))&&jP(a,["voiceActivityDetectionSignal"],k),a))}else Object.assign(d,e);b(d)}class lv{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c,this.music=new ls(this.apiClient,this.auth,this.webSocketFactory)}async connect(a){var b,c,d,e,f,g,h,i;let j,k;if(a.config&&a.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion(),n=this.apiClient.getHeaders();a.config&&a.config.tools&&lo(a.config.tools)&&lp(n);let o=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(n);if(this.apiClient.isVertexAI())j=`${l}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(o,j);else{let a=this.apiClient.getApiKey(),b="BidiGenerateContent",c="key";(null==a?void 0:a.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==m&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",c="access_token"),j=`${l}/ws/google.ai.generativelanguage.${m}.GenerativeService.${b}?${c}=${a}`}let p=()=>{},q=new Promise(a=>{p=a}),r=a.callbacks,s=this.apiClient,t={onopen:function(){var a;null==(a=null==r?void 0:r.onopen)||a.call(r),p({})},onmessage:a=>{lu(s,r.onmessage,a)},onerror:null!=(b=null==r?void 0:r.onerror)?b:function(a){},onclose:null!=(c=null==r?void 0:r.onclose)?c:function(a){}},u=this.webSocketFactory.create(j,(k={},o.forEach((a,b)=>{k[b]=a}),k),t);u.connect(),await q;let v=kj(this.apiClient,a.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let a=this.apiClient.getProject(),b=this.apiClient.getLocation();v=`projects/${a}/locations/${b}/`+v}let w={};this.apiClient.isVertexAI()&&(null==(d=a.config)?void 0:d.responseModalities)===void 0&&(void 0===a.config?a.config={responseModalities:[a0.AUDIO]}:a.config.responseModalities=[a0.AUDIO]),(null==(e=a.config)?void 0:e.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let x=null!=(g=null==(f=a.config)?void 0:f.tools)?g:[],y=[];for(let a of x)this.isCallableTool(a)?y.push(await a.tool()):y.push(a);y.length>0&&(a.config.tools=y);let z={model:v,config:a.config,callbacks:a.callbacks};if(this.apiClient.isVertexAI()){let a,b,c;h=this.apiClient,a={},null!=(b=jQ(z,["model"]))&&jP(a,["setup","model"],kj(h,b)),null!=(c=jQ(z,["config"]))&&jP(a,["config"],function(a,b){let c=jQ(a,["generationConfig"]);void 0!==b&&null!=c&&jP(b,["setup","generationConfig"],function(a){let b={},c=jQ(a,["modelSelectionConfig"]);null!=c&&jP(b,["modelConfig"],c);let d=jQ(a,["responseJsonSchema"]);null!=d&&jP(b,["responseJsonSchema"],d);let e=jQ(a,["audioTimestamp"]);null!=e&&jP(b,["audioTimestamp"],e);let f=jQ(a,["candidateCount"]);null!=f&&jP(b,["candidateCount"],f);let g=jQ(a,["enableAffectiveDialog"]);null!=g&&jP(b,["enableAffectiveDialog"],g);let h=jQ(a,["frequencyPenalty"]);null!=h&&jP(b,["frequencyPenalty"],h);let i=jQ(a,["logprobs"]);null!=i&&jP(b,["logprobs"],i);let j=jQ(a,["maxOutputTokens"]);null!=j&&jP(b,["maxOutputTokens"],j);let k=jQ(a,["mediaResolution"]);null!=k&&jP(b,["mediaResolution"],k);let l=jQ(a,["presencePenalty"]);null!=l&&jP(b,["presencePenalty"],l);let m=jQ(a,["responseLogprobs"]);null!=m&&jP(b,["responseLogprobs"],m);let n=jQ(a,["responseMimeType"]);null!=n&&jP(b,["responseMimeType"],n);let o=jQ(a,["responseModalities"]);null!=o&&jP(b,["responseModalities"],o);let p=jQ(a,["responseSchema"]);null!=p&&jP(b,["responseSchema"],p);let q=jQ(a,["routingConfig"]);null!=q&&jP(b,["routingConfig"],q);let r=jQ(a,["seed"]);null!=r&&jP(b,["seed"],r);let s=jQ(a,["speechConfig"]);null!=s&&jP(b,["speechConfig"],s);let t=jQ(a,["stopSequences"]);null!=t&&jP(b,["stopSequences"],t);let u=jQ(a,["temperature"]);null!=u&&jP(b,["temperature"],u);let v=jQ(a,["thinkingConfig"]);null!=v&&jP(b,["thinkingConfig"],v);let w=jQ(a,["topK"]);null!=w&&jP(b,["topK"],w);let x=jQ(a,["topP"]);if(null!=x&&jP(b,["topP"],x),void 0!==jQ(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(c));let d=jQ(a,["responseModalities"]);void 0!==b&&null!=d&&jP(b,["setup","generationConfig","responseModalities"],d);let e=jQ(a,["temperature"]);void 0!==b&&null!=e&&jP(b,["setup","generationConfig","temperature"],e);let f=jQ(a,["topP"]);void 0!==b&&null!=f&&jP(b,["setup","generationConfig","topP"],f);let g=jQ(a,["topK"]);void 0!==b&&null!=g&&jP(b,["setup","generationConfig","topK"],g);let h=jQ(a,["maxOutputTokens"]);void 0!==b&&null!=h&&jP(b,["setup","generationConfig","maxOutputTokens"],h);let i=jQ(a,["mediaResolution"]);void 0!==b&&null!=i&&jP(b,["setup","generationConfig","mediaResolution"],i);let j=jQ(a,["seed"]);void 0!==b&&null!=j&&jP(b,["setup","generationConfig","seed"],j);let k=jQ(a,["speechConfig"]);void 0!==b&&null!=k&&jP(b,["setup","generationConfig","speechConfig"],kz(k));let l=jQ(a,["thinkingConfig"]);void 0!==b&&null!=l&&jP(b,["setup","generationConfig","thinkingConfig"],l);let m=jQ(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&jP(b,["setup","generationConfig","enableAffectiveDialog"],m);let n=jQ(a,["systemInstruction"]);void 0!==b&&null!=n&&jP(b,["setup","systemInstruction"],ku(n));let o=jQ(a,["tools"]);if(void 0!==b&&null!=o){let a=kB(o);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==jQ(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=jQ(a,["description"]);null!=c&&jP(b,["description"],c);let d=jQ(a,["name"]);null!=d&&jP(b,["name"],d);let e=jQ(a,["parameters"]);null!=e&&jP(b,["parameters"],e);let f=jQ(a,["parametersJsonSchema"]);null!=f&&jP(b,["parametersJsonSchema"],f);let g=jQ(a,["response"]);null!=g&&jP(b,["response"],g);let h=jQ(a,["responseJsonSchema"]);return null!=h&&jP(b,["responseJsonSchema"],h),b})(a))),jP(b,["functionDeclarations"],a)}let d=jQ(a,["retrieval"]);null!=d&&jP(b,["retrieval"],d);let e=jQ(a,["googleSearchRetrieval"]);null!=e&&jP(b,["googleSearchRetrieval"],e);let f=jQ(a,["computerUse"]);if(null!=f&&jP(b,["computerUse"],f),void 0!==jQ(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=jQ(a,["codeExecution"]);null!=g&&jP(b,["codeExecution"],g);let h=jQ(a,["enterpriseWebSearch"]);null!=h&&jP(b,["enterpriseWebSearch"],h);let i=jQ(a,["googleMaps"]);null!=i&&jP(b,["googleMaps"],i);let j=jQ(a,["googleSearch"]);null!=j&&jP(b,["googleSearch"],j);let k=jQ(a,["urlContext"]);return null!=k&&jP(b,["urlContext"],k),b})(kA(a)))),jP(b,["setup","tools"],a)}let p=jQ(a,["sessionResumption"]);void 0!==b&&null!=p&&jP(b,["setup","sessionResumption"],p);let q=jQ(a,["inputAudioTranscription"]);void 0!==b&&null!=q&&jP(b,["setup","inputAudioTranscription"],q);let r=jQ(a,["outputAudioTranscription"]);void 0!==b&&null!=r&&jP(b,["setup","outputAudioTranscription"],r);let s=jQ(a,["realtimeInputConfig"]);void 0!==b&&null!=s&&jP(b,["setup","realtimeInputConfig"],s);let t=jQ(a,["contextWindowCompression"]);void 0!==b&&null!=t&&jP(b,["setup","contextWindowCompression"],t);let u=jQ(a,["proactivity"]);void 0!==b&&null!=u&&jP(b,["setup","proactivity"],u);let v=jQ(a,["explicitVadSignal"]);return void 0!==b&&null!=v&&jP(b,["setup","explicitVadSignal"],v),{}}(c,a)),w=a}else{let a,b,c;i=this.apiClient,a={},null!=(b=jQ(z,["model"]))&&jP(a,["setup","model"],kj(i,b)),null!=(c=jQ(z,["config"]))&&jP(a,["config"],function(a,b){let c=jQ(a,["generationConfig"]);void 0!==b&&null!=c&&jP(b,["setup","generationConfig"],c);let d=jQ(a,["responseModalities"]);void 0!==b&&null!=d&&jP(b,["setup","generationConfig","responseModalities"],d);let e=jQ(a,["temperature"]);void 0!==b&&null!=e&&jP(b,["setup","generationConfig","temperature"],e);let f=jQ(a,["topP"]);void 0!==b&&null!=f&&jP(b,["setup","generationConfig","topP"],f);let g=jQ(a,["topK"]);void 0!==b&&null!=g&&jP(b,["setup","generationConfig","topK"],g);let h=jQ(a,["maxOutputTokens"]);void 0!==b&&null!=h&&jP(b,["setup","generationConfig","maxOutputTokens"],h);let i=jQ(a,["mediaResolution"]);void 0!==b&&null!=i&&jP(b,["setup","generationConfig","mediaResolution"],i);let j=jQ(a,["seed"]);void 0!==b&&null!=j&&jP(b,["setup","generationConfig","seed"],j);let k=jQ(a,["speechConfig"]);void 0!==b&&null!=k&&jP(b,["setup","generationConfig","speechConfig"],kz(k));let l=jQ(a,["thinkingConfig"]);void 0!==b&&null!=l&&jP(b,["setup","generationConfig","thinkingConfig"],l);let m=jQ(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&jP(b,["setup","generationConfig","enableAffectiveDialog"],m);let n=jQ(a,["systemInstruction"]);void 0!==b&&null!=n&&jP(b,["setup","systemInstruction"],function(a){let b={},c=jQ(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m,n;return c={},null!=(d=jQ(b=a,["mediaResolution"]))&&jP(c,["mediaResolution"],d),null!=(e=jQ(b,["codeExecutionResult"]))&&jP(c,["codeExecutionResult"],e),null!=(f=jQ(b,["executableCode"]))&&jP(c,["executableCode"],f),null!=(g=jQ(b,["fileData"]))&&jP(c,["fileData"],function(a){let b={};if(void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=jQ(a,["fileUri"]);null!=c&&jP(b,["fileUri"],c);let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(g)),null!=(h=jQ(b,["functionCall"]))&&jP(c,["functionCall"],function(a){let b={},c=jQ(a,["id"]);null!=c&&jP(b,["id"],c);let d=jQ(a,["args"]);null!=d&&jP(b,["args"],d);let e=jQ(a,["name"]);if(null!=e&&jP(b,["name"],e),void 0!==jQ(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==jQ(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(h)),null!=(i=jQ(b,["functionResponse"]))&&jP(c,["functionResponse"],i),null!=(j=jQ(b,["inlineData"]))&&jP(c,["inlineData"],k3(j)),null!=(k=jQ(b,["text"]))&&jP(c,["text"],k),null!=(l=jQ(b,["thought"]))&&jP(c,["thought"],l),null!=(m=jQ(b,["thoughtSignature"]))&&jP(c,["thoughtSignature"],m),null!=(n=jQ(b,["videoMetadata"]))&&jP(c,["videoMetadata"],n),c})),jP(b,["parts"],a)}let d=jQ(a,["role"]);return null!=d&&jP(b,["role"],d),b}(ku(n)));let o=jQ(a,["tools"]);if(void 0!==b&&null!=o){let a=kB(o);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["functionDeclarations"],a)}if(void 0!==jQ(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=jQ(a,["googleSearchRetrieval"]);null!=d&&jP(b,["googleSearchRetrieval"],d);let e=jQ(a,["computerUse"]);null!=e&&jP(b,["computerUse"],e);let f=jQ(a,["fileSearch"]);null!=f&&jP(b,["fileSearch"],f);let g=jQ(a,["codeExecution"]);if(null!=g&&jP(b,["codeExecution"],g),void 0!==jQ(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=jQ(a,["googleMaps"]);null!=h&&jP(b,["googleMaps"],function(a){let b={};if(void 0!==jQ(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=jQ(a,["enableWidget"]);return null!=c&&jP(b,["enableWidget"],c),b}(h));let i=jQ(a,["googleSearch"]);null!=i&&jP(b,["googleSearch"],function(a){let b={};if(void 0!==jQ(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==jQ(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=jQ(a,["timeRangeFilter"]);return null!=c&&jP(b,["timeRangeFilter"],c),b}(i));let j=jQ(a,["urlContext"]);return null!=j&&jP(b,["urlContext"],j),b})(kA(a)))),jP(b,["setup","tools"],a)}let p=jQ(a,["sessionResumption"]);void 0!==b&&null!=p&&jP(b,["setup","sessionResumption"],function(a){let b={},c=jQ(a,["handle"]);if(null!=c&&jP(b,["handle"],c),void 0!==jQ(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(p));let q=jQ(a,["inputAudioTranscription"]);void 0!==b&&null!=q&&jP(b,["setup","inputAudioTranscription"],q);let r=jQ(a,["outputAudioTranscription"]);void 0!==b&&null!=r&&jP(b,["setup","outputAudioTranscription"],r);let s=jQ(a,["realtimeInputConfig"]);void 0!==b&&null!=s&&jP(b,["setup","realtimeInputConfig"],s);let t=jQ(a,["contextWindowCompression"]);void 0!==b&&null!=t&&jP(b,["setup","contextWindowCompression"],t);let u=jQ(a,["proactivity"]);if(void 0!==b&&null!=u&&jP(b,["setup","proactivity"],u),void 0!==jQ(a,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(c,a)),w=a}return delete w.config,u.send(JSON.stringify(w)),new lx(u,this.apiClient)}isCallableTool(a){return"callTool"in a&&"function"==typeof a.callTool}}let lw={turnComplete:!0};class lx{constructor(a,b){this.conn=a,this.apiClient=b}tLiveClientContent(a,b){if(null!==b.turns&&void 0!==b.turns){let c=[];try{c=kw(b.turns),a.isVertexAI()||(c=c.map(a=>k4(a)))}catch(a){throw Error(`Failed to parse client content "turns", type: '${typeof b.turns}'`)}return{clientContent:{turns:c,turnComplete:b.turnComplete}}}return{clientContent:{turnComplete:b.turnComplete}}}tLiveClienttToolResponse(a,b){let c=[];if(null==b.functionResponses||0===(c=Array.isArray(b.functionResponses)?b.functionResponses:[b.functionResponses]).length)throw Error("functionResponses is required.");for(let b of c){if("object"!=typeof b||null===b||!("name"in b)||!("response"in b))throw Error(`Could not parse function response, type '${typeof b}'.`);if(!a.isVertexAI()&&!("id"in b))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:c}}}sendClientContent(a){a=Object.assign(Object.assign({},lw),a);let b=this.tLiveClientContent(this.apiClient,a);this.conn.send(JSON.stringify(b))}sendRealtimeInput(a){let b={};b=this.apiClient.isVertexAI()?{realtimeInput:function(a){let b={},c=jQ(a,["media"]);if(null!=c){let a=kl(c);Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["mediaChunks"],a)}let d=jQ(a,["audio"]);null!=d&&jP(b,["audio"],ko(d));let e=jQ(a,["audioStreamEnd"]);null!=e&&jP(b,["audioStreamEnd"],e);let f=jQ(a,["video"]);null!=f&&jP(b,["video"],kn(f));let g=jQ(a,["text"]);null!=g&&jP(b,["text"],g);let h=jQ(a,["activityStart"]);null!=h&&jP(b,["activityStart"],h);let i=jQ(a,["activityEnd"]);return null!=i&&jP(b,["activityEnd"],i),b}(a)}:{realtimeInput:function(a){let b={},c=jQ(a,["media"]);if(null!=c){let a=kl(c);Array.isArray(a)&&(a=a.map(a=>k3(a))),jP(b,["mediaChunks"],a)}let d=jQ(a,["audio"]);null!=d&&jP(b,["audio"],k3(ko(d)));let e=jQ(a,["audioStreamEnd"]);null!=e&&jP(b,["audioStreamEnd"],e);let f=jQ(a,["video"]);null!=f&&jP(b,["video"],k3(kn(f)));let g=jQ(a,["text"]);null!=g&&jP(b,["text"],g);let h=jQ(a,["activityStart"]);null!=h&&jP(b,["activityStart"],h);let i=jQ(a,["activityEnd"]);return null!=i&&jP(b,["activityEnd"],i),b}(a)},this.conn.send(JSON.stringify(b))}sendToolResponse(a){if(null==a.functionResponses)throw Error("Tool response parameters are required.");let b=this.tLiveClienttToolResponse(this.apiClient,a);this.conn.send(JSON.stringify(b))}close(){this.conn.close()}}function ly(a){var b,c,d;if(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.disable)return!0;let e=!1;for(let b of null!=(c=null==a?void 0:a.tools)?c:[])if(lz(b)){e=!0;break}if(!e)return!0;let f=null==(d=null==a?void 0:a.automaticFunctionCalling)?void 0:d.maximumRemoteCalls;return(!(!f||!(f<0)&&Number.isInteger(f))||0==f)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",f),!0)}function lz(a){return"callTool"in a&&"function"==typeof a.callTool}function lA(a){var b;let c=[];return(null==(b=null==a?void 0:a.config)?void 0:b.tools)&&a.config.tools.forEach((a,b)=>{lz(a)||a.functionDeclarations&&a.functionDeclarations.length>0&&c.push(b)}),c}function lB(a){var b;return!(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.ignoreCallHistory)}class lC extends jN{constructor(a){super(),this.apiClient=a,this.generateContent=async a=>{var b,c,d,e,f,g,h,i;let j,k,l=await this.processParamsMaybeAddMcpUsage(a);if(this.maybeMoveToResponseJsonSchem(a),!(null!=(i=null==(h=null==(g=a.config)?void 0:g.tools)?void 0:h.some(a=>lz(a)))&&i)||ly(a.config))return await this.generateContentInternal(l);let m=lA(a);if(m.length>0){let a=m.map(a=>`tools[${a}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${a}.`)}let n=kw(l.contents),o=null!=(d=null==(c=null==(b=l.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,p=0;for(;p<o&&(j=await this.generateContentInternal(l)).functionCalls&&0!==j.functionCalls.length;){let b=j.candidates[0].content,c=[];for(let b of null!=(f=null==(e=a.config)?void 0:e.tools)?f:[])if(lz(b)){let a=await b.callTool(j.functionCalls);c.push(...a)}p++,k={role:"user",parts:c},l.contents=kw(l.contents),l.contents.push(b),l.contents.push(k),lB(l.config)&&(n.push(b),n.push(k))}return lB(l.config)&&(j.automaticFunctionCallingHistory=n),j},this.generateContentStream=async a=>{var b,c,d,e,f;if(this.maybeMoveToResponseJsonSchem(a),ly(a.config)){let b=await this.processParamsMaybeAddMcpUsage(a);return await this.generateContentStreamInternal(b)}let g=lA(a);if(g.length>0){let a=g.map(a=>`tools[${a}]`).join(", ");throw Error(`Incompatible tools found at ${a}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let h=null==(d=null==(c=null==(b=null==a?void 0:a.config)?void 0:b.toolConfig)?void 0:c.functionCallingConfig)?void 0:d.streamFunctionCallArguments,i=null==(f=null==(e=null==a?void 0:a.config)?void 0:e.automaticFunctionCalling)?void 0:f.disable;if(h&&!i)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(a)},this.generateImages=async a=>await this.generateImagesInternal(a).then(a=>{var b;let c,d=[];if(null==a?void 0:a.generatedImages)for(let e of a.generatedImages)e&&(null==e?void 0:e.safetyAttributes)&&(null==(b=null==e?void 0:e.safetyAttributes)?void 0:b.contentType)==="Positive Prompt"?c=null==e?void 0:e.safetyAttributes:d.push(e);return c?{generatedImages:d,positivePromptSafetyAttributes:c,sdkHttpResponse:a.sdkHttpResponse}:{generatedImages:d,sdkHttpResponse:a.sdkHttpResponse}}),this.list=async a=>{var b;let c={config:Object.assign(Object.assign({},{queryBase:!0}),null==a?void 0:a.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase)if(null==(b=c.config)?void 0:b.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else c.config.filter="labels.tune-type:*";return new kR(bB.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(c),c)},this.editImage=async a=>{let b={model:a.model,prompt:a.prompt,referenceImages:[],config:a.config};return a.referenceImages&&a.referenceImages&&(b.referenceImages=a.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(b)},this.upscaleImage=async a=>{let b={numberOfImages:1,mode:"upscale"};a.config&&(b=Object.assign(Object.assign({},b),a.config));let c={model:a.model,image:a.image,upscaleFactor:a.upscaleFactor,config:b};return await this.upscaleImageInternal(c)},this.generateVideos=async a=>{var b,c,d,e,f,g;if((a.prompt||a.image||a.video)&&a.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(b=a.video)?void 0:b.uri)&&(null==(c=a.video)?void 0:c.videoBytes)?a.video={uri:a.video.uri,mimeType:a.video.mimeType}:(null==(e=null==(d=a.source)?void 0:d.video)?void 0:e.uri)&&(null==(g=null==(f=a.source)?void 0:f.video)?void 0:g.videoBytes)&&(a.source.video={uri:a.source.video.uri,mimeType:a.source.video.mimeType})),await this.generateVideosInternal(a)}}maybeMoveToResponseJsonSchem(a){a.config&&a.config.responseSchema&&!a.config.responseJsonSchema&&Object.keys(a.config.responseSchema).includes("$schema")&&(a.config.responseJsonSchema=a.config.responseSchema,delete a.config.responseSchema)}async processParamsMaybeAddMcpUsage(a){var b,c,d;let e=null==(b=a.config)?void 0:b.tools;if(!e)return a;let f=await Promise.all(e.map(async a=>lz(a)?await a.tool():a)),g={model:a.model,contents:a.contents,config:Object.assign(Object.assign({},a.config),{tools:f})};if(g.config.tools=f,a.config&&a.config.tools&&lo(a.config.tools)){let b=Object.assign({},null!=(d=null==(c=a.config.httpOptions)?void 0:c.headers)?d:{});0===Object.keys(b).length&&(b=this.apiClient.getDefaultHeaders()),lp(b),g.config.httpOptions=Object.assign(Object.assign({},a.config.httpOptions),{headers:b})}return g}async initAfcToolsMap(a){var b,c,d;let e=new Map;for(let f of null!=(c=null==(b=a.config)?void 0:b.tools)?c:[])if(lz(f))for(let a of null!=(d=(await f.tool()).functionDeclarations)?d:[]){if(!a.name)throw Error("Function declaration name is required.");if(e.has(a.name))throw Error(`Duplicate tool declaration name: ${a.name}`);e.set(a.name,f)}return e}async processAfcStream(a){var b,c,d;let e=null!=(d=null==(c=null==(b=a.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,f=!1,g=0;return function(a,b,c){return kX(this,arguments,function*(){for(;g<e;){f&&(g++,f=!1);let p=yield kW(a.processParamsMaybeAddMcpUsage(c)),q=yield kW(a.generateContentStreamInternal(p)),r=[],s=[];try{for(var d,h,i,j,k,l,m,n=!0,o=(h=void 0,kY(q));!(d=(m=yield kW(o.next())).done);n=!0)if(j=m.value,n=!1,yield yield kW(j),j.candidates&&(null==(k=j.candidates[0])?void 0:k.content)){for(let a of(s.push(j.candidates[0].content),null!=(l=j.candidates[0].content.parts)?l:[]))if(g<e&&a.functionCall){if(!a.functionCall.name)throw Error("Function call name was not returned by the model.");if(b.has(a.functionCall.name)){let c=yield kW(b.get(a.functionCall.name).callTool([a.functionCall]));r.push(...c)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${b.keys()}, mising tool: ${a.functionCall.name}`)}}}catch(a){h={error:a}}finally{try{!n&&!d&&(i=o.return)&&(yield kW(i.call(o)))}finally{if(h)throw h.error}}if(r.length>0){f=!0;let a=new jU;a.candidates=[{content:{role:"user",parts:r}}],yield yield kW(a);let b=[];b.push(...s),b.push({role:"user",parts:r});let d=kw(c.contents).concat(b);c.contents=d}else break}})}(this,await this.initAfcToolsMap(a),a)}async generateContentInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=k6(this.apiClient,a);return f=jO("{model}:generateContent",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=k8(a),c=new jU;return Object.assign(c,b),c})}{let b=k5(this.apiClient,a);return f=jO("{model}:generateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=k7(a),c=new jU;return Object.assign(c,b),c})}}async generateContentStreamInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=k6(this.apiClient,a);return f=jO("{model}:streamGenerateContent?alt=sse",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(function(a){return kX(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=kY(a);!(b=(f=yield kW(h.next())).done);g=!0){e=f.value,g=!1;let a=k8((yield kW(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new jU;Object.assign(b,a),yield yield kW(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield kW(d.call(h)))}finally{if(c)throw c.error}}})})}{let b=k5(this.apiClient,a);return f=jO("{model}:streamGenerateContent?alt=sse",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(function(a){return kX(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=kY(a);!(b=(f=yield kW(h.next())).done);g=!0){e=f.value,g=!1;let a=k7((yield kW(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new jU;Object.assign(b,a),yield yield kW(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield kW(d.call(h)))}finally{if(c)throw c.error}}})})}}async embedContent(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c,d,e,f,g,h={},i=jQ(b,["model"]);null!=i&&jP(h,["_url","model"],kj(a,i));let j=jQ(b,["contents"]);if(null!=j){let b=kv(a,j);Array.isArray(b)&&(b=b.map(a=>a)),jP(h,["instances[]","content"],b)}let k=jQ(b,["config"]);return null!=k&&(c=jQ(k,["taskType"]),void 0!==h&&null!=c&&jP(h,["instances[]","task_type"],c),d=jQ(k,["title"]),void 0!==h&&null!=d&&jP(h,["instances[]","title"],d),e=jQ(k,["outputDimensionality"]),void 0!==h&&null!=e&&jP(h,["parameters","outputDimensionality"],e),f=jQ(k,["mimeType"]),void 0!==h&&null!=f&&jP(h,["instances[]","mimeType"],f),g=jQ(k,["autoTruncate"]),void 0!==h&&null!=g&&jP(h,["parameters","autoTruncate"],g)),h}(this.apiClient,a);return f=jO("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["predictions[]","embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=jQ(a,["values"]))&&jP(c,["values"],d),null!=(e=jQ(a,["statistics"]))&&jP(c,["statistics"],(f={},null!=(g=jQ(b=e,["truncated"]))&&jP(f,["truncated"],g),null!=(h=jQ(b,["token_count"]))&&jP(f,["tokenCount"],h),f)),c})),jP(b,["embeddings"],a)}let e=jQ(a,["metadata"]);return null!=e&&jP(b,["metadata"],e),b}(a),c=new jV;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let b=kv(a,e);Array.isArray(b)&&(b=b.map(a=>a)),jP(c,["requests[]","content"],b)}let f=jQ(b,["config"]);null!=f&&function(a,b){let c=jQ(a,["taskType"]);void 0!==b&&null!=c&&jP(b,["requests[]","taskType"],c);let d=jQ(a,["title"]);void 0!==b&&null!=d&&jP(b,["requests[]","title"],d);let e=jQ(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&jP(b,["requests[]","outputDimensionality"],e),void 0!==jQ(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==jQ(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(f,c);let g=jQ(b,["model"]);return void 0!==g&&jP(c,["requests[]","model"],kj(a,g)),c}(this.apiClient,a);return f=jO("{model}:batchEmbedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["embeddings"],a)}let e=jQ(a,["metadata"]);return null!=e&&jP(b,["metadata"],e),b}(a),c=new jV;return Object.assign(c,b),c})}}async generateImagesInternal(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["_url","model"],kj(f,e)),null!=(g=jQ(a,["prompt"]))&&jP(d,["instances[0]","prompt"],g),null!=(j=jQ(a,["config"]))&&(k=jQ(j,["outputGcsUri"]),void 0!==d&&null!=k&&jP(d,["parameters","storageUri"],k),l=jQ(j,["negativePrompt"]),void 0!==d&&null!=l&&jP(d,["parameters","negativePrompt"],l),m=jQ(j,["numberOfImages"]),void 0!==d&&null!=m&&jP(d,["parameters","sampleCount"],m),n=jQ(j,["aspectRatio"]),void 0!==d&&null!=n&&jP(d,["parameters","aspectRatio"],n),o=jQ(j,["guidanceScale"]),void 0!==d&&null!=o&&jP(d,["parameters","guidanceScale"],o),p=jQ(j,["seed"]),void 0!==d&&null!=p&&jP(d,["parameters","seed"],p),q=jQ(j,["safetyFilterLevel"]),void 0!==d&&null!=q&&jP(d,["parameters","safetySetting"],q),r=jQ(j,["personGeneration"]),void 0!==d&&null!=r&&jP(d,["parameters","personGeneration"],r),s=jQ(j,["includeSafetyAttributes"]),void 0!==d&&null!=s&&jP(d,["parameters","includeSafetyAttributes"],s),t=jQ(j,["includeRaiReason"]),void 0!==d&&null!=t&&jP(d,["parameters","includeRaiReason"],t),u=jQ(j,["language"]),void 0!==d&&null!=u&&jP(d,["parameters","language"],u),v=jQ(j,["outputMimeType"]),void 0!==d&&null!=v&&jP(d,["parameters","outputOptions","mimeType"],v),w=jQ(j,["outputCompressionQuality"]),void 0!==d&&null!=w&&jP(d,["parameters","outputOptions","compressionQuality"],w),x=jQ(j,["addWatermark"]),void 0!==d&&null!=x&&jP(d,["parameters","addWatermark"],x),y=jQ(j,["labels"]),void 0!==d&&null!=y&&jP(d,["labels"],y),z=jQ(j,["imageSize"]),void 0!==d&&null!=z&&jP(d,["parameters","sampleImageSize"],z),A=jQ(j,["enhancePrompt"]),void 0!==d&&null!=A&&jP(d,["parameters","enhancePrompt"],A)),d);return h=jO("{model}:predict",B._url),i=B._query,delete B._url,delete B._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(B),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>k9(a))),jP(b,["generatedImages"],a)}let e=jQ(a,["positivePromptSafetyAttributes"]);return null!=e&&jP(b,["positivePromptSafetyAttributes"],lg(e)),b}(a),c=new jW;return Object.assign(c,b),c})}{let b,c,f,j,k=(g=this.apiClient,b={},null!=(c=jQ(a,["model"]))&&jP(b,["_url","model"],kj(g,c)),null!=(f=jQ(a,["prompt"]))&&jP(b,["instances[0]","prompt"],f),null!=(j=jQ(a,["config"]))&&function(a,b){if(void 0!==jQ(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==jQ(a,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let c=jQ(a,["numberOfImages"]);void 0!==b&&null!=c&&jP(b,["parameters","sampleCount"],c);let d=jQ(a,["aspectRatio"]);void 0!==b&&null!=d&&jP(b,["parameters","aspectRatio"],d);let e=jQ(a,["guidanceScale"]);if(void 0!==b&&null!=e&&jP(b,["parameters","guidanceScale"],e),void 0!==jQ(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let f=jQ(a,["safetyFilterLevel"]);void 0!==b&&null!=f&&jP(b,["parameters","safetySetting"],f);let g=jQ(a,["personGeneration"]);void 0!==b&&null!=g&&jP(b,["parameters","personGeneration"],g);let h=jQ(a,["includeSafetyAttributes"]);void 0!==b&&null!=h&&jP(b,["parameters","includeSafetyAttributes"],h);let i=jQ(a,["includeRaiReason"]);void 0!==b&&null!=i&&jP(b,["parameters","includeRaiReason"],i);let j=jQ(a,["language"]);void 0!==b&&null!=j&&jP(b,["parameters","language"],j);let k=jQ(a,["outputMimeType"]);void 0!==b&&null!=k&&jP(b,["parameters","outputOptions","mimeType"],k);let l=jQ(a,["outputCompressionQuality"]);if(void 0!==b&&null!=l&&jP(b,["parameters","outputOptions","compressionQuality"],l),void 0!==jQ(a,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==jQ(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let m=jQ(a,["imageSize"]);if(void 0!==b&&null!=m&&jP(b,["parameters","sampleImageSize"],m),void 0!==jQ(a,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(j,b),b);return h=jO("{model}:predict",k._url),i=k._query,delete k._url,delete k._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>{var b,c;let d,e,f,g,h,i,j;return d={},null!=(e=jQ(b=a,["_self"]))&&jP(d,["image"],(f={},null!=(g=jQ(c=e,["bytesBase64Encoded"]))&&jP(f,["imageBytes"],jR(g)),null!=(h=jQ(c,["mimeType"]))&&jP(f,["mimeType"],h),f)),null!=(i=jQ(b,["raiFilteredReason"]))&&jP(d,["raiFilteredReason"],i),null!=(j=jQ(b,["_self"]))&&jP(d,["safetyAttributes"],lf(j)),d})),jP(b,["generatedImages"],a)}let e=jQ(a,["positivePromptSafetyAttributes"]);return null!=e&&jP(b,["positivePromptSafetyAttributes"],lf(e)),b}(a),c=new jW;return Object.assign(c,b),c})}}async editImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={},u=jQ(b,["model"]);null!=u&&jP(t,["_url","model"],kj(a,u));let v=jQ(b,["prompt"]);null!=v&&jP(t,["instances[0]","prompt"],v);let w=jQ(b,["referenceImages"]);if(null!=w){let a=w;Array.isArray(a)&&(a=a.map(a=>(function(a){let b,c,d,e,f,g,h,i={},j=jQ(a,["referenceImage"]);null!=j&&jP(i,["referenceImage"],lc(j));let k=jQ(a,["referenceId"]);null!=k&&jP(i,["referenceId"],k);let l=jQ(a,["referenceType"]);null!=l&&jP(i,["referenceType"],l);let m=jQ(a,["maskImageConfig"]);null!=m&&jP(i,["maskImageConfig"],(b={},null!=(c=jQ(m,["maskMode"]))&&jP(b,["maskMode"],c),null!=(d=jQ(m,["segmentationClasses"]))&&jP(b,["maskClasses"],d),null!=(e=jQ(m,["maskDilation"]))&&jP(b,["dilation"],e),b));let n=jQ(a,["controlImageConfig"]);null!=n&&jP(i,["controlImageConfig"],(f={},null!=(g=jQ(n,["controlType"]))&&jP(f,["controlType"],g),null!=(h=jQ(n,["enableControlImageComputation"]))&&jP(f,["computeControl"],h),f));let o=jQ(a,["styleImageConfig"]);null!=o&&jP(i,["styleImageConfig"],o);let p=jQ(a,["subjectImageConfig"]);return null!=p&&jP(i,["subjectImageConfig"],p),i})(a))),jP(t,["instances[0]","referenceImages"],a)}let x=jQ(b,["config"]);return null!=x&&(c=jQ(x,["outputGcsUri"]),void 0!==t&&null!=c&&jP(t,["parameters","storageUri"],c),d=jQ(x,["negativePrompt"]),void 0!==t&&null!=d&&jP(t,["parameters","negativePrompt"],d),e=jQ(x,["numberOfImages"]),void 0!==t&&null!=e&&jP(t,["parameters","sampleCount"],e),f=jQ(x,["aspectRatio"]),void 0!==t&&null!=f&&jP(t,["parameters","aspectRatio"],f),g=jQ(x,["guidanceScale"]),void 0!==t&&null!=g&&jP(t,["parameters","guidanceScale"],g),h=jQ(x,["seed"]),void 0!==t&&null!=h&&jP(t,["parameters","seed"],h),i=jQ(x,["safetyFilterLevel"]),void 0!==t&&null!=i&&jP(t,["parameters","safetySetting"],i),j=jQ(x,["personGeneration"]),void 0!==t&&null!=j&&jP(t,["parameters","personGeneration"],j),k=jQ(x,["includeSafetyAttributes"]),void 0!==t&&null!=k&&jP(t,["parameters","includeSafetyAttributes"],k),l=jQ(x,["includeRaiReason"]),void 0!==t&&null!=l&&jP(t,["parameters","includeRaiReason"],l),m=jQ(x,["language"]),void 0!==t&&null!=m&&jP(t,["parameters","language"],m),n=jQ(x,["outputMimeType"]),void 0!==t&&null!=n&&jP(t,["parameters","outputOptions","mimeType"],n),o=jQ(x,["outputCompressionQuality"]),void 0!==t&&null!=o&&jP(t,["parameters","outputOptions","compressionQuality"],o),p=jQ(x,["addWatermark"]),void 0!==t&&null!=p&&jP(t,["parameters","addWatermark"],p),q=jQ(x,["labels"]),void 0!==t&&null!=q&&jP(t,["labels"],q),r=jQ(x,["editMode"]),void 0!==t&&null!=r&&jP(t,["parameters","editMode"],r),s=jQ(x,["baseSteps"]),void 0!==t&&null!=s&&jP(t,["parameters","editConfig","baseSteps"],s)),t}(this.apiClient,a);return d=jO("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>k9(a))),jP(b,["generatedImages"],a)}return b}(a),c=new jX;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(a){var b,c,d;let e="",f={};if(this.apiClient.isVertexAI()){let g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=(d=this.apiClient,g={},null!=(h=jQ(a,["model"]))&&jP(g,["_url","model"],kj(d,h)),null!=(i=jQ(a,["image"]))&&jP(g,["instances[0]","image"],lc(i)),null!=(j=jQ(a,["upscaleFactor"]))&&jP(g,["parameters","upscaleConfig","upscaleFactor"],j),null!=(k=jQ(a,["config"]))&&(l=jQ(k,["outputGcsUri"]),void 0!==g&&null!=l&&jP(g,["parameters","storageUri"],l),m=jQ(k,["safetyFilterLevel"]),void 0!==g&&null!=m&&jP(g,["parameters","safetySetting"],m),n=jQ(k,["personGeneration"]),void 0!==g&&null!=n&&jP(g,["parameters","personGeneration"],n),o=jQ(k,["includeRaiReason"]),void 0!==g&&null!=o&&jP(g,["parameters","includeRaiReason"],o),p=jQ(k,["outputMimeType"]),void 0!==g&&null!=p&&jP(g,["parameters","outputOptions","mimeType"],p),q=jQ(k,["outputCompressionQuality"]),void 0!==g&&null!=q&&jP(g,["parameters","outputOptions","compressionQuality"],q),r=jQ(k,["enhanceInputImage"]),void 0!==g&&null!=r&&jP(g,["parameters","upscaleConfig","enhanceInputImage"],r),s=jQ(k,["imagePreservationFactor"]),void 0!==g&&null!=s&&jP(g,["parameters","upscaleConfig","imagePreservationFactor"],s),t=jQ(k,["labels"]),void 0!==g&&null!=t&&jP(g,["labels"],t),u=jQ(k,["numberOfImages"]),void 0!==g&&null!=u&&jP(g,["parameters","sampleCount"],u),v=jQ(k,["mode"]),void 0!==g&&null!=v&&jP(g,["parameters","mode"],v)),g);return e=jO("{model}:predict",w._url),f=w._query,delete w._url,delete w._query,this.apiClient.request({path:e,queryParams:f,body:JSON.stringify(w),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>k9(a))),jP(b,["generatedImages"],a)}return b}(a),c=new jY;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(a){var b,c,d;let e="",f={};if(this.apiClient.isVertexAI()){let g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=(d=this.apiClient,g={},null!=(h=jQ(a,["model"]))&&jP(g,["_url","model"],kj(d,h)),null!=(i=jQ(a,["source"]))&&function(a,b){let c=jQ(a,["prompt"]);void 0!==b&&null!=c&&jP(b,["instances[0]","prompt"],c);let d=jQ(a,["personImage"]);void 0!==b&&null!=d&&jP(b,["instances[0]","personImage","image"],lc(d));let e=jQ(a,["productImages"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>{let b,c;return b={},null!=(c=jQ(a,["productImage"]))&&jP(b,["image"],lc(c)),b})),jP(b,["instances[0]","productImages"],a)}}(i,g),null!=(j=jQ(a,["config"]))&&(k=jQ(j,["numberOfImages"]),void 0!==g&&null!=k&&jP(g,["parameters","sampleCount"],k),l=jQ(j,["baseSteps"]),void 0!==g&&null!=l&&jP(g,["parameters","baseSteps"],l),m=jQ(j,["outputGcsUri"]),void 0!==g&&null!=m&&jP(g,["parameters","storageUri"],m),n=jQ(j,["seed"]),void 0!==g&&null!=n&&jP(g,["parameters","seed"],n),o=jQ(j,["safetyFilterLevel"]),void 0!==g&&null!=o&&jP(g,["parameters","safetySetting"],o),p=jQ(j,["personGeneration"]),void 0!==g&&null!=p&&jP(g,["parameters","personGeneration"],p),q=jQ(j,["addWatermark"]),void 0!==g&&null!=q&&jP(g,["parameters","addWatermark"],q),r=jQ(j,["outputMimeType"]),void 0!==g&&null!=r&&jP(g,["parameters","outputOptions","mimeType"],r),s=jQ(j,["outputCompressionQuality"]),void 0!==g&&null!=s&&jP(g,["parameters","outputOptions","compressionQuality"],s),t=jQ(j,["enhancePrompt"]),void 0!==g&&null!=t&&jP(g,["parameters","enhancePrompt"],t),u=jQ(j,["labels"]),void 0!==g&&null!=u&&jP(g,["labels"],u)),g);return e=jO("{model}:predict",v._url),f=v._query,delete v._url,delete v._query,this.apiClient.request({path:e,queryParams:f,body:JSON.stringify(v),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=jQ(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>k9(a))),jP(b,["generatedImages"],a)}return b}(a),c=new jZ;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI()){let i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=(d=this.apiClient,n={},null!=(o=jQ(a,["model"]))&&jP(n,["_url","model"],kj(d,o)),null!=(p=jQ(a,["source"]))&&(e=p,f=n,k=jQ(e,["prompt"]),void 0!==f&&null!=k&&jP(f,["instances[0]","prompt"],k),l=jQ(e,["image"]),void 0!==f&&null!=l&&jP(f,["instances[0]","image"],lc(l)),m=jQ(e,["scribbleImage"]),void 0!==f&&null!=m&&jP(f,["instances[0]","scribble"],(i={},null!=(j=jQ(m,["image"]))&&jP(i,["image"],lc(j)),i))),null!=(q=jQ(a,["config"]))&&(r=jQ(q,["mode"]),void 0!==n&&null!=r&&jP(n,["parameters","mode"],r),s=jQ(q,["maxPredictions"]),void 0!==n&&null!=s&&jP(n,["parameters","maxPredictions"],s),t=jQ(q,["confidenceThreshold"]),void 0!==n&&null!=t&&jP(n,["parameters","confidenceThreshold"],t),u=jQ(q,["maskDilation"]),void 0!==n&&null!=u&&jP(n,["parameters","maskDilation"],u),v=jQ(q,["binaryColorThreshold"]),void 0!==n&&null!=v&&jP(n,["parameters","binaryColorThreshold"],v),w=jQ(q,["labels"]),void 0!==n&&null!=w&&jP(n,["labels"],w)),n);return g=jO("{model}:predict",x._url),h=x._query,delete x._url,delete x._query,this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=jQ(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["_self"]);null!=c&&jP(b,["mask"],la(c));let d=jQ(a,["labels"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["labels"],a)}return b})(a))),jP(b,["generatedMasks"],a)}return b}(a),c=new j$;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async get(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["_url","name"],kj(f,e)),d);return h=jO("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>le(a))}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["model"]))&&jP(b,["_url","name"],kj(g,c)),b);return h=jO("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>ld(a))}}async listInternal(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,l,m=(f=this.apiClient,d={},null!=(e=jQ(a,["config"]))&&(g=jQ(e,["pageSize"]),void 0!==d&&null!=g&&jP(d,["_query","pageSize"],g),j=jQ(e,["pageToken"]),void 0!==d&&null!=j&&jP(d,["_query","pageToken"],j),k=jQ(e,["filter"]),void 0!==d&&null!=k&&jP(d,["_query","filter"],k),l=jQ(e,["queryBase"]),void 0!==d&&null!=l&&jP(d,["_url","models_url"],kH(f,l))),d);return h=jO("{models_url}",m._url),i=m._query,delete m._url,delete m._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(m),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["_self"]);if(null!=e){let a=kI(e);Array.isArray(a)&&(a=a.map(a=>le(a))),jP(b,["models"],a)}return b}(a),c=new j_;return Object.assign(c,b),c})}{let b,c,f,j,k,l,m=(g=this.apiClient,b={},null!=(c=jQ(a,["config"]))&&(f=jQ(c,["pageSize"]),void 0!==b&&null!=f&&jP(b,["_query","pageSize"],f),j=jQ(c,["pageToken"]),void 0!==b&&null!=j&&jP(b,["_query","pageToken"],j),k=jQ(c,["filter"]),void 0!==b&&null!=k&&jP(b,["_query","filter"],k),l=jQ(c,["queryBase"]),void 0!==b&&null!=l&&jP(b,["_url","models_url"],kH(g,l))),b);return h=jO("{models_url}",m._url),i=m._query,delete m._url,delete m._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(m),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["_self"]);if(null!=e){let a=kI(e);Array.isArray(a)&&(a=a.map(a=>ld(a))),jP(b,["models"],a)}return b}(a),c=new j_;return Object.assign(c,b),c})}}async update(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,l,m=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["_url","model"],kj(f,e)),null!=(g=jQ(a,["config"]))&&(j=jQ(g,["displayName"]),void 0!==d&&null!=j&&jP(d,["displayName"],j),k=jQ(g,["description"]),void 0!==d&&null!=k&&jP(d,["description"],k),l=jQ(g,["defaultCheckpointId"]),void 0!==d&&null!=l&&jP(d,["defaultCheckpointId"],l)),d);return h=jO("{model}",m._url),i=m._query,delete m._url,delete m._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>le(a))}{let b,c,f,j,k,l,m=(g=this.apiClient,b={},null!=(c=jQ(a,["model"]))&&jP(b,["_url","name"],kj(g,c)),null!=(f=jQ(a,["config"]))&&(j=jQ(f,["displayName"]),void 0!==b&&null!=j&&jP(b,["displayName"],j),k=jQ(f,["description"]),void 0!==b&&null!=k&&jP(b,["description"],k),l=jQ(f,["defaultCheckpointId"]),void 0!==b&&null!=l&&jP(b,["defaultCheckpointId"],l)),b);return h=jO("{name}",m._url),i=m._query,delete m._url,delete m._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>ld(a))}}async delete(a){var b,c,d,e,f,g;let h="",i={};if(this.apiClient.isVertexAI()){let d,e,g=(f=this.apiClient,d={},null!=(e=jQ(a,["model"]))&&jP(d,["_url","name"],kj(f,e)),d);return h=jO("{name}",g._url),i=g._query,delete g._url,delete g._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(g),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j0;return Object.assign(e,d),e})}{let b,c,f=(g=this.apiClient,b={},null!=(c=jQ(a,["model"]))&&jP(b,["_url","name"],kj(g,c)),b);return h=jO("{name}",f._url),i=f._query,delete f._url,delete f._query,this.apiClient.request({path:h,queryParams:i,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j0;return Object.assign(e,d),e})}}async countTokens(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>a)),jP(c,["contents"],a)}let f=jQ(b,["config"]);return null!=f&&function(a,b){let c=jQ(a,["systemInstruction"]);void 0!==b&&null!=c&&jP(b,["systemInstruction"],ku(c));let d=jQ(a,["tools"]);if(void 0!==b&&null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>lh(a))),jP(b,["tools"],a)}let e=jQ(a,["generationConfig"]);void 0!==b&&null!=e&&jP(b,["generationConfig"],function(a){let b={},c=jQ(a,["modelSelectionConfig"]);null!=c&&jP(b,["modelConfig"],c);let d=jQ(a,["responseJsonSchema"]);null!=d&&jP(b,["responseJsonSchema"],d);let e=jQ(a,["audioTimestamp"]);null!=e&&jP(b,["audioTimestamp"],e);let f=jQ(a,["candidateCount"]);null!=f&&jP(b,["candidateCount"],f);let g=jQ(a,["enableAffectiveDialog"]);null!=g&&jP(b,["enableAffectiveDialog"],g);let h=jQ(a,["frequencyPenalty"]);null!=h&&jP(b,["frequencyPenalty"],h);let i=jQ(a,["logprobs"]);null!=i&&jP(b,["logprobs"],i);let j=jQ(a,["maxOutputTokens"]);null!=j&&jP(b,["maxOutputTokens"],j);let k=jQ(a,["mediaResolution"]);null!=k&&jP(b,["mediaResolution"],k);let l=jQ(a,["presencePenalty"]);null!=l&&jP(b,["presencePenalty"],l);let m=jQ(a,["responseLogprobs"]);null!=m&&jP(b,["responseLogprobs"],m);let n=jQ(a,["responseMimeType"]);null!=n&&jP(b,["responseMimeType"],n);let o=jQ(a,["responseModalities"]);null!=o&&jP(b,["responseModalities"],o);let p=jQ(a,["responseSchema"]);null!=p&&jP(b,["responseSchema"],p);let q=jQ(a,["routingConfig"]);null!=q&&jP(b,["routingConfig"],q);let r=jQ(a,["seed"]);null!=r&&jP(b,["seed"],r);let s=jQ(a,["speechConfig"]);null!=s&&jP(b,["speechConfig"],s);let t=jQ(a,["stopSequences"]);null!=t&&jP(b,["stopSequences"],t);let u=jQ(a,["temperature"]);null!=u&&jP(b,["temperature"],u);let v=jQ(a,["thinkingConfig"]);null!=v&&jP(b,["thinkingConfig"],v);let w=jQ(a,["topK"]);null!=w&&jP(b,["topK"],w);let x=jQ(a,["topP"]);if(null!=x&&jP(b,["topP"],x),void 0!==jQ(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(e))}(f,c),c}(this.apiClient,a);return f=jO("{model}:countTokens",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),null!=(d=jQ(a,["totalTokens"]))&&jP(b,["totalTokens"],d),b),f=new j1;return Object.assign(f,e),f})}{let b=function(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>k4(a))),jP(c,["contents"],a)}let f=jQ(b,["config"]);return null!=f&&function(a){if(void 0!==jQ(a,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==jQ(a,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==jQ(a,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(f),c}(this.apiClient,a);return f=jO("{model}:countTokens",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),null!=(d=jQ(a,["totalTokens"]))&&jP(b,["totalTokens"],d),null!=(e=jQ(a,["cachedContentTokenCount"]))&&jP(b,["cachedContentTokenCount"],e),b),g=new j1;return Object.assign(g,f),g})}}async computeTokens(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=jQ(b,["model"]);null!=d&&jP(c,["_url","model"],kj(a,d));let e=jQ(b,["contents"]);if(null!=e){let a=kw(e);Array.isArray(a)&&(a=a.map(a=>a)),jP(c,["contents"],a)}return c}(this.apiClient,a);return d=jO("{model}:computeTokens",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["tokensInfo"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["tokensInfo"],a)}return b}(a),c=new j2;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(a){var b,c,d,e,f,g,h,i,j,k;let l="",m={};if(this.apiClient.isVertexAI()){let d,e,g,j,k,n,o,p,q,r,s=(f=this.apiClient,j={},null!=(k=jQ(a,["model"]))&&jP(j,["_url","model"],kj(f,k)),null!=(n=jQ(a,["prompt"]))&&jP(j,["instances[0]","prompt"],n),null!=(o=jQ(a,["image"]))&&jP(j,["instances[0]","image"],lc(o)),null!=(p=jQ(a,["video"]))&&jP(j,["instances[0]","video"],lj(p)),null!=(q=jQ(a,["source"]))&&(h=q,i=j,d=jQ(h,["prompt"]),void 0!==i&&null!=d&&jP(i,["instances[0]","prompt"],d),e=jQ(h,["image"]),void 0!==i&&null!=e&&jP(i,["instances[0]","image"],lc(e)),g=jQ(h,["video"]),void 0!==i&&null!=g&&jP(i,["instances[0]","video"],lj(g))),null!=(r=jQ(a,["config"]))&&function(a,b){var c;let d,e,f,g=jQ(a,["numberOfVideos"]);void 0!==b&&null!=g&&jP(b,["parameters","sampleCount"],g);let h=jQ(a,["outputGcsUri"]);void 0!==b&&null!=h&&jP(b,["parameters","storageUri"],h);let i=jQ(a,["fps"]);void 0!==b&&null!=i&&jP(b,["parameters","fps"],i);let j=jQ(a,["durationSeconds"]);void 0!==b&&null!=j&&jP(b,["parameters","durationSeconds"],j);let k=jQ(a,["seed"]);void 0!==b&&null!=k&&jP(b,["parameters","seed"],k);let l=jQ(a,["aspectRatio"]);void 0!==b&&null!=l&&jP(b,["parameters","aspectRatio"],l);let m=jQ(a,["resolution"]);void 0!==b&&null!=m&&jP(b,["parameters","resolution"],m);let n=jQ(a,["personGeneration"]);void 0!==b&&null!=n&&jP(b,["parameters","personGeneration"],n);let o=jQ(a,["pubsubTopic"]);void 0!==b&&null!=o&&jP(b,["parameters","pubsubTopic"],o);let p=jQ(a,["negativePrompt"]);void 0!==b&&null!=p&&jP(b,["parameters","negativePrompt"],p);let q=jQ(a,["enhancePrompt"]);void 0!==b&&null!=q&&jP(b,["parameters","enhancePrompt"],q);let r=jQ(a,["generateAudio"]);void 0!==b&&null!=r&&jP(b,["parameters","generateAudio"],r);let s=jQ(a,["lastFrame"]);void 0!==b&&null!=s&&jP(b,["instances[0]","lastFrame"],lc(s));let t=jQ(a,["referenceImages"]);if(void 0!==b&&null!=t){let a=t;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=jQ(b=a,["image"]))&&jP(c,["image"],lc(d)),null!=(e=jQ(b,["referenceType"]))&&jP(c,["referenceType"],e),c})),jP(b,["instances[0]","referenceImages"],a)}let u=jQ(a,["mask"]);void 0!==b&&null!=u&&jP(b,["instances[0]","mask"],(d={},null!=(e=jQ(c=u,["image"]))&&jP(d,["_self"],lc(e)),null!=(f=jQ(c,["maskMode"]))&&jP(d,["maskMode"],f),d));let v=jQ(a,["compressionQuality"]);void 0!==b&&null!=v&&jP(b,["parameters","compressionQuality"],v)}(r,j),j);return l=jO("{model}:predictLongRunning",s._url),m=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:m,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d,e,f,g,h=(b={},null!=(c=jQ(a,["name"]))&&jP(b,["name"],c),null!=(d=jQ(a,["metadata"]))&&jP(b,["metadata"],d),null!=(e=jQ(a,["done"]))&&jP(b,["done"],e),null!=(f=jQ(a,["error"]))&&jP(b,["error"],f),null!=(g=jQ(a,["response"]))&&jP(b,["response"],function(a){let b={},c=jQ(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=jQ(a,["_self"]))&&jP(c,["video"],(e={},null!=(f=jQ(b=d,["gcsUri"]))&&jP(e,["uri"],f),null!=(g=jQ(b,["bytesBase64Encoded"]))&&jP(e,["videoBytes"],jR(g)),null!=(h=jQ(b,["mimeType"]))&&jP(e,["mimeType"],h),e)),c})),jP(b,["generatedVideos"],a)}let d=jQ(a,["raiMediaFilteredCount"]);null!=d&&jP(b,["raiMediaFilteredCount"],d);let e=jQ(a,["raiMediaFilteredReasons"]);return null!=e&&jP(b,["raiMediaFilteredReasons"],e),b}(g)),b),i=new j3;return Object.assign(i,h),i})}{let b,c,f,h,i,n,o,p,q,r,s=(g=this.apiClient,h={},null!=(i=jQ(a,["model"]))&&jP(h,["_url","model"],kj(g,i)),null!=(n=jQ(a,["prompt"]))&&jP(h,["instances[0]","prompt"],n),null!=(o=jQ(a,["image"]))&&jP(h,["instances[0]","image"],lb(o)),null!=(p=jQ(a,["video"]))&&jP(h,["instances[0]","video"],li(p)),null!=(q=jQ(a,["source"]))&&(j=q,k=h,b=jQ(j,["prompt"]),void 0!==k&&null!=b&&jP(k,["instances[0]","prompt"],b),c=jQ(j,["image"]),void 0!==k&&null!=c&&jP(k,["instances[0]","image"],lb(c)),f=jQ(j,["video"]),void 0!==k&&null!=f&&jP(k,["instances[0]","video"],li(f))),null!=(r=jQ(a,["config"]))&&function(a,b){let c=jQ(a,["numberOfVideos"]);if(void 0!==b&&null!=c&&jP(b,["parameters","sampleCount"],c),void 0!==jQ(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==jQ(a,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let d=jQ(a,["durationSeconds"]);if(void 0!==b&&null!=d&&jP(b,["parameters","durationSeconds"],d),void 0!==jQ(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let e=jQ(a,["aspectRatio"]);void 0!==b&&null!=e&&jP(b,["parameters","aspectRatio"],e);let f=jQ(a,["resolution"]);void 0!==b&&null!=f&&jP(b,["parameters","resolution"],f);let g=jQ(a,["personGeneration"]);if(void 0!==b&&null!=g&&jP(b,["parameters","personGeneration"],g),void 0!==jQ(a,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let h=jQ(a,["negativePrompt"]);void 0!==b&&null!=h&&jP(b,["parameters","negativePrompt"],h);let i=jQ(a,["enhancePrompt"]);if(void 0!==b&&null!=i&&jP(b,["parameters","enhancePrompt"],i),void 0!==jQ(a,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let j=jQ(a,["lastFrame"]);void 0!==b&&null!=j&&jP(b,["instances[0]","lastFrame"],lb(j));let k=jQ(a,["referenceImages"]);if(void 0!==b&&null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e;return c={},null!=(d=jQ(b=a,["image"]))&&jP(c,["image"],lb(d)),null!=(e=jQ(b,["referenceType"]))&&jP(c,["referenceType"],e),c})),jP(b,["instances[0]","referenceImages"],a)}if(void 0!==jQ(a,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==jQ(a,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(r,h),h);return l=jO("{model}:predictLongRunning",s._url),m=s._query,delete s._url,delete s._query,this.apiClient.request({path:l,queryParams:m,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d,e,f,g,h=(b={},null!=(c=jQ(a,["name"]))&&jP(b,["name"],c),null!=(d=jQ(a,["metadata"]))&&jP(b,["metadata"],d),null!=(e=jQ(a,["done"]))&&jP(b,["done"],e),null!=(f=jQ(a,["error"]))&&jP(b,["error"],f),null!=(g=jQ(a,["response","generateVideoResponse"]))&&jP(b,["response"],function(a){let b={},c=jQ(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h;return c={},null!=(d=jQ(a,["video"]))&&jP(c,["video"],(e={},null!=(f=jQ(b=d,["uri"]))&&jP(e,["uri"],f),null!=(g=jQ(b,["encodedVideo"]))&&jP(e,["videoBytes"],jR(g)),null!=(h=jQ(b,["encoding"]))&&jP(e,["mimeType"],h),e)),c})),jP(b,["generatedVideos"],a)}let d=jQ(a,["raiMediaFilteredCount"]);null!=d&&jP(b,["raiMediaFilteredCount"],d);let e=jQ(a,["raiMediaFilteredReasons"]);return null!=e&&jP(b,["raiMediaFilteredReasons"],e),b}(g)),b),i=new j3;return Object.assign(i,h),i})}}}class lD extends jN{constructor(a){super(),this.apiClient=a}async getVideosOperation(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,_isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,_isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=jQ(a,["operationName"]))&&jP(d,["_url","operationName"],e),d);return f=jO("{operationName}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}{let b,c,h=(b={},null!=(c=jQ(a,["operationName"]))&&jP(b,["_url","operationName"],c),b);return f=jO("{operationName}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json())}}async fetchPredictVideosOperationInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f,g,h,i=(f={},null!=(g=jQ(a,["operationName"]))&&jP(f,["operationName"],g),null!=(h=jQ(a,["resourceName"]))&&jP(f,["_url","resourceName"],h),f);return d=jO("{resourceName}:fetchPredictOperation",i._url),e=i._query,delete i._url,delete i._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}throw Error("This method is only supported by the Vertex AI.")}}class lE extends jN{constructor(a){super(),this.apiClient=a}async create(a){var b,c,d,e,f;let g="",h={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let i,j,k,l,m,n,o,p,q,r,s=(d=this.apiClient,l={},null!=(m=jQ(a,["config"]))&&jP(l,["config"],(n=jQ(m,["expireTime"]),void 0!==l&&null!=n&&jP(l,["expireTime"],n),o=jQ(m,["newSessionExpireTime"]),void 0!==l&&null!=o&&jP(l,["newSessionExpireTime"],o),p=jQ(m,["uses"]),void 0!==l&&null!=p&&jP(l,["uses"],p),q=jQ(m,["liveConnectConstraints"]),void 0!==l&&null!=q&&jP(l,["bidiGenerateContentSetup"],(e=d,i={},null!=(j=jQ(f=q,["model"]))&&jP(i,["setup","model"],kj(e,j)),null!=(k=jQ(f,["config"]))&&jP(i,["config"],function(a,b){let c=jQ(a,["generationConfig"]);void 0!==b&&null!=c&&jP(b,["setup","generationConfig"],c);let d=jQ(a,["responseModalities"]);void 0!==b&&null!=d&&jP(b,["setup","generationConfig","responseModalities"],d);let e=jQ(a,["temperature"]);void 0!==b&&null!=e&&jP(b,["setup","generationConfig","temperature"],e);let f=jQ(a,["topP"]);void 0!==b&&null!=f&&jP(b,["setup","generationConfig","topP"],f);let g=jQ(a,["topK"]);void 0!==b&&null!=g&&jP(b,["setup","generationConfig","topK"],g);let h=jQ(a,["maxOutputTokens"]);void 0!==b&&null!=h&&jP(b,["setup","generationConfig","maxOutputTokens"],h);let i=jQ(a,["mediaResolution"]);void 0!==b&&null!=i&&jP(b,["setup","generationConfig","mediaResolution"],i);let j=jQ(a,["seed"]);void 0!==b&&null!=j&&jP(b,["setup","generationConfig","seed"],j);let k=jQ(a,["speechConfig"]);void 0!==b&&null!=k&&jP(b,["setup","generationConfig","speechConfig"],kz(k));let l=jQ(a,["thinkingConfig"]);void 0!==b&&null!=l&&jP(b,["setup","generationConfig","thinkingConfig"],l);let m=jQ(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&jP(b,["setup","generationConfig","enableAffectiveDialog"],m);let n=jQ(a,["systemInstruction"]);void 0!==b&&null!=n&&jP(b,["setup","systemInstruction"],function(a){let b={},c=jQ(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m,n;return c={},null!=(d=jQ(b=a,["mediaResolution"]))&&jP(c,["mediaResolution"],d),null!=(e=jQ(b,["codeExecutionResult"]))&&jP(c,["codeExecutionResult"],e),null!=(f=jQ(b,["executableCode"]))&&jP(c,["executableCode"],f),null!=(g=jQ(b,["fileData"]))&&jP(c,["fileData"],function(a){let b={};if(void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=jQ(a,["fileUri"]);null!=c&&jP(b,["fileUri"],c);let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(g)),null!=(h=jQ(b,["functionCall"]))&&jP(c,["functionCall"],function(a){let b={},c=jQ(a,["id"]);null!=c&&jP(b,["id"],c);let d=jQ(a,["args"]);null!=d&&jP(b,["args"],d);let e=jQ(a,["name"]);if(null!=e&&jP(b,["name"],e),void 0!==jQ(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==jQ(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(h)),null!=(i=jQ(b,["functionResponse"]))&&jP(c,["functionResponse"],i),null!=(j=jQ(b,["inlineData"]))&&jP(c,["inlineData"],function(a){let b={},c=jQ(a,["data"]);if(null!=c&&jP(b,["data"],c),void 0!==jQ(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=jQ(a,["mimeType"]);return null!=d&&jP(b,["mimeType"],d),b}(j)),null!=(k=jQ(b,["text"]))&&jP(c,["text"],k),null!=(l=jQ(b,["thought"]))&&jP(c,["thought"],l),null!=(m=jQ(b,["thoughtSignature"]))&&jP(c,["thoughtSignature"],m),null!=(n=jQ(b,["videoMetadata"]))&&jP(c,["videoMetadata"],n),c})),jP(b,["parts"],a)}let d=jQ(a,["role"]);return null!=d&&jP(b,["role"],d),b}(ku(n)));let o=jQ(a,["tools"]);if(void 0!==b&&null!=o){let a=kB(o);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=jQ(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["functionDeclarations"],a)}if(void 0!==jQ(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=jQ(a,["googleSearchRetrieval"]);null!=d&&jP(b,["googleSearchRetrieval"],d);let e=jQ(a,["computerUse"]);null!=e&&jP(b,["computerUse"],e);let f=jQ(a,["fileSearch"]);null!=f&&jP(b,["fileSearch"],f);let g=jQ(a,["codeExecution"]);if(null!=g&&jP(b,["codeExecution"],g),void 0!==jQ(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=jQ(a,["googleMaps"]);null!=h&&jP(b,["googleMaps"],function(a){let b={};if(void 0!==jQ(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=jQ(a,["enableWidget"]);return null!=c&&jP(b,["enableWidget"],c),b}(h));let i=jQ(a,["googleSearch"]);null!=i&&jP(b,["googleSearch"],function(a){let b={};if(void 0!==jQ(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==jQ(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=jQ(a,["timeRangeFilter"]);return null!=c&&jP(b,["timeRangeFilter"],c),b}(i));let j=jQ(a,["urlContext"]);return null!=j&&jP(b,["urlContext"],j),b})(kA(a)))),jP(b,["setup","tools"],a)}let p=jQ(a,["sessionResumption"]);void 0!==b&&null!=p&&jP(b,["setup","sessionResumption"],function(a){let b={},c=jQ(a,["handle"]);if(null!=c&&jP(b,["handle"],c),void 0!==jQ(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(p));let q=jQ(a,["inputAudioTranscription"]);void 0!==b&&null!=q&&jP(b,["setup","inputAudioTranscription"],q);let r=jQ(a,["outputAudioTranscription"]);void 0!==b&&null!=r&&jP(b,["setup","outputAudioTranscription"],r);let s=jQ(a,["realtimeInputConfig"]);void 0!==b&&null!=s&&jP(b,["setup","realtimeInputConfig"],s);let t=jQ(a,["contextWindowCompression"]);void 0!==b&&null!=t&&jP(b,["setup","contextWindowCompression"],t);let u=jQ(a,["proactivity"]);if(void 0!==b&&null!=u&&jP(b,["setup","proactivity"],u),void 0!==jQ(a,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(k,i)),i)),r=jQ(m,["lockAdditionalFields"]),void 0!==l&&null!=r&&jP(l,["fieldMask"],r),{})),l);g=jO("auth_tokens",s._url),h=s._query,delete s.config,delete s._url,delete s._query;let t=function(a,b){let c=null,d=a.bidiGenerateContentSetup;if("object"==typeof d&&null!==d&&"setup"in d){let b=d.setup;"object"==typeof b&&null!==b?(a.bidiGenerateContentSetup=b,c=b):delete a.bidiGenerateContentSetup}else void 0!==d&&delete a.bidiGenerateContentSetup;let e=a.fieldMask;if(c){let d=function(a){let b=[];for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c];if("object"==typeof d&&null!=d&&Object.keys(d).length>0){let a=Object.keys(d).map(a=>`${c}.${a}`);b.push(...a)}else b.push(c)}return b.join(",")}(c);if(Array.isArray(null==b?void 0:b.lockAdditionalFields)&&(null==b?void 0:b.lockAdditionalFields.length)===0)d?a.fieldMask=d:delete a.fieldMask;else if((null==b?void 0:b.lockAdditionalFields)&&b.lockAdditionalFields.length>0&&null!==e&&Array.isArray(e)&&e.length>0){let b=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],c=[];e.length>0&&(c=e.map(a=>b.includes(a)?`generationConfig.${a}`:a));let f=[];d&&f.push(d),c.length>0&&f.push(...c),f.length>0?a.fieldMask=f.join(","):delete a.fieldMask}else delete a.fieldMask}else null!==e&&Array.isArray(e)&&e.length>0?a.fieldMask=e.join(","):delete a.fieldMask;return a}(s,a.config);return this.apiClient.request({path:g,queryParams:h,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}}class lF extends jN{constructor(a){super(),this.apiClient=a,this.list=async a=>new kR(bB.PAGED_ITEM_DOCUMENTS,b=>this.listInternal({parent:a.parent,config:b.config}),await this.listInternal(a),a)}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","name"],g),f);return d=jO("{name}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","name"],g),null!=(h=jQ(a,["config"]))&&(i=jQ(h,["force"]),void 0!==f&&null!=i&&jP(f,["_query","force"],i)),f);d=jO("{name}",j._url),e=j._query,delete j._url,delete j._query,await this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j,k=(f={},null!=(g=jQ(a,["parent"]))&&jP(f,["_url","parent"],g),null!=(h=jQ(a,["config"]))&&(i=jQ(h,["pageSize"]),void 0!==f&&null!=i&&jP(f,["_query","pageSize"],i),j=jQ(h,["pageToken"]),void 0!==f&&null!=j&&jP(f,["_query","pageToken"],j)),f);return d=jO("{parent}/documents",k._url),e=k._query,delete k._url,delete k._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["documents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["documents"],a)}return b}(a),c=new j8;return Object.assign(c,b),c})}}}class lG extends jN{constructor(a,b=new lF(a)){super(),this.apiClient=a,this.documents=b,this.list=async(a={})=>new kR(bB.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(a),a)}async uploadToFileSearchStore(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(a.fileSearchStoreName,a.file,a.config)}async create(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i=(f={},null!=(g=jQ(a,["config"]))&&(h=jQ(g,["displayName"]),void 0!==f&&null!=h&&jP(f,["displayName"],h)),f);return d=jO("fileSearchStores",i._url),e=i._query,delete i._url,delete i._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","name"],g),f);return d=jO("{name}",h._url),e=h._query,delete h._url,delete h._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=jQ(a,["name"]))&&jP(f,["_url","name"],g),null!=(h=jQ(a,["config"]))&&(i=jQ(h,["force"]),void 0!==f&&null!=i&&jP(f,["_query","force"],i)),f);d=jO("{name}",j._url),e=j._query,delete j._url,delete j._query,await this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=jQ(a,["config"]))&&(h=jQ(g,["pageSize"]),void 0!==f&&null!=h&&jP(f,["_query","pageSize"],h),i=jQ(g,["pageToken"]),void 0!==f&&null!=i&&jP(f,["_query","pageToken"],i)),f);return d=jO("fileSearchStores",j._url),e=j._query,delete j._url,delete j._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=jQ(a,["sdkHttpResponse"]);null!=c&&jP(b,["sdkHttpResponse"],c);let d=jQ(a,["nextPageToken"]);null!=d&&jP(b,["nextPageToken"],d);let e=jQ(a,["fileSearchStores"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["fileSearchStores"],a)}return b}(a),c=new j9;return Object.assign(c,b),c})}}async uploadToFileSearchStoreInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i=(f={},null!=(g=jQ(a,["fileSearchStoreName"]))&&jP(f,["_url","file_search_store_name"],g),null!=(h=jQ(a,["config"]))&&lk(h,f),f);return d=jO("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",i._url),e=i._query,delete i._url,delete i._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new ka;return Object.assign(e,d),e})}}async importFile(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j=(f={},null!=(g=jQ(a,["fileSearchStoreName"]))&&jP(f,["_url","file_search_store_name"],g),null!=(h=jQ(a,["fileName"]))&&jP(f,["fileName"],h),null!=(i=jQ(a,["config"]))&&function(a,b){let c=jQ(a,["customMetadata"]);if(void 0!==b&&null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP(b,["customMetadata"],a)}let d=jQ(a,["chunkingConfig"]);void 0!==b&&null!=d&&jP(b,["chunkingConfig"],d)}(i,f),f);return d=jO("{file_search_store_name}:importFile",j._url),e=j._query,delete j._url,delete j._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(j),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{var b;let c,d,e,f,g,h,i,j,k,l,m=(g={},null!=(h=jQ(a,["name"]))&&jP(g,["name"],h),null!=(i=jQ(a,["metadata"]))&&jP(g,["metadata"],i),null!=(j=jQ(a,["done"]))&&jP(g,["done"],j),null!=(k=jQ(a,["error"]))&&jP(g,["error"],k),null!=(l=jQ(a,["response"]))&&jP(g,["response"],(c={},null!=(d=jQ(b=l,["sdkHttpResponse"]))&&jP(c,["sdkHttpResponse"],d),null!=(e=jQ(b,["parent"]))&&jP(c,["parent"],e),null!=(f=jQ(b,["documentName"]))&&jP(c,["documentName"],f),c)),g),n=new kb;return Object.assign(n,m),n})}}}let lH=function(){let{crypto:a}=globalThis;if(null==a?void 0:a.randomUUID)return lH=a.randomUUID.bind(a),a.randomUUID();let b=new Uint8Array(1),c=a?()=>a.getRandomValues(b)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^c()&15>>a/4).toString(16))};function lI(a){return"object"==typeof a&&null!==a&&("name"in a&&"AbortError"===a.name||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}let lJ=a=>{if(a instanceof Error)return a;if("object"==typeof a&&null!==a){try{if("[object Error]"===Object.prototype.toString.call(a)){let b=Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(b.stack=a.stack),a.cause&&!b.cause&&(b.cause=a.cause),a.name&&(b.name=a.name),b}}catch(a){}try{return Error(JSON.stringify(a))}catch(a){}}return Error(a)};class lK extends Error{}class lL extends lK{constructor(a,b,c,d){super(`${lL.makeMessage(a,b,c)}`),this.status=a,this.headers=d,this.error=b}static makeMessage(a,b,c){let d=(null==b?void 0:b.message)?"string"==typeof b.message?b.message:JSON.stringify(b.message):b?JSON.stringify(b):c;return a&&d?`${a} ${d}`:a?`${a} status code (no body)`:d||"(no status code or body)"}static generate(a,b,c,d){return a&&d?400===a?new lP(a,b,c,d):401===a?new lQ(a,b,c,d):403===a?new lR(a,b,c,d):404===a?new lS(a,b,c,d):409===a?new lT(a,b,c,d):422===a?new lU(a,b,c,d):429===a?new lV(a,b,c,d):a>=500?new lW(a,b,c,d):new lL(a,b,c,d):new lN({message:c,cause:lJ(b)})}}class lM extends lL{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class lN extends lL{constructor({message:a,cause:b}){super(void 0,void 0,a||"Connection error.",void 0),b&&(this.cause=b)}}class lO extends lN{constructor({message:a}={}){super({message:null!=a?a:"Request timed out."})}}class lP extends lL{}class lQ extends lL{}class lR extends lL{}class lS extends lL{}class lT extends lL{}class lU extends lL{}class lV extends lL{}class lW extends lL{}let lX=/^[a-z][a-z0-9+.-]*:/i,lY=a=>(lY=Array.isArray)(a),lZ=lY,l$="0.0.1",l_=a=>"x32"===a?"x32":"x86_64"===a||"x64"===a?"x64":"arm"===a?"arm":"aarch64"===a||"arm64"===a?"arm64":a?`other:${a}`:"unknown",l0=a=>(a=a.toLowerCase()).includes("ios")?"iOS":"android"===a?"Android":"darwin"===a?"MacOS":"win32"===a?"Windows":"freebsd"===a?"FreeBSD":"openbsd"===a?"OpenBSD":"linux"===a?"Linux":a?`Other:${a}`:"Unknown";function l1(...a){let b=globalThis.ReadableStream;if(void 0===b)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new b(...a)}function l2(a){if(a[Symbol.asyncIterator])return a;let b=a.getReader();return{async next(){try{let a=await b.read();return(null==a?void 0:a.done)&&b.releaseLock(),a}catch(a){throw b.releaseLock(),a}},async return(){let a=b.cancel();return b.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function l3(a){var b,c;if(null===a||"object"!=typeof a)return;if(a[Symbol.asyncIterator])return void await (null==(c=(b=a[Symbol.asyncIterator]()).return)?void 0:c.call(b));let d=a.getReader(),e=d.cancel();d.releaseLock(),await e}let l4=({headers:a,body:b})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(b)}),l5=()=>{var a;if("undefined"==typeof File){let{process:b}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null==(a=null==b?void 0:b.versions)?void 0:a.node)&&20>parseInt(b.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function l6(a,b,c){return l5(),new File(a,null!=b?b:"unknown_file",c)}let l7=a=>null!=a&&"object"==typeof a&&"number"==typeof a.size&&"string"==typeof a.type&&"function"==typeof a.text&&"function"==typeof a.slice&&"function"==typeof a.arrayBuffer;async function l8(a,b,c){var d;let e,f;if(l5(),null!=(e=a=await a)&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&l7(e))return a instanceof File?a:l6([await a.arrayBuffer()],a.name);if(null!=(f=a)&&"object"==typeof f&&"string"==typeof f.url&&"function"==typeof f.blob){let d=await a.blob();return b||(b=new URL(a.url).pathname.split(/[\\/]/).pop()),l6(await l9(d),b,c)}let g=await l9(a);if(b||(b=("object"==typeof(d=a)&&null!==d&&("name"in d&&d.name&&String(d.name)||"url"in d&&d.url&&String(d.url)||"filename"in d&&d.filename&&String(d.filename)||"path"in d&&d.path&&String(d.path))||"").split(/[\\/]/).pop()||void 0),!(null==c?void 0:c.type)){let a=g.find(a=>"object"==typeof a&&"type"in a&&a.type);"string"==typeof a&&(c=Object.assign(Object.assign({},c),{type:a}))}return l6(g,b,c)}async function l9(a){let b=[];if("string"==typeof a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)b.push(a);else if(l7(a))b.push(a instanceof Blob?a:await a.arrayBuffer());else if(null!=a&&"object"==typeof a&&"function"==typeof a[Symbol.asyncIterator])try{for(var c,d,e,f,g,h,i=!0,j=kY(a);!(c=(h=await j.next()).done);i=!0)f=h.value,i=!1,b.push(...await l9(f))}catch(a){d={error:a}}finally{try{!i&&!c&&(e=j.return)&&await e.call(j)}finally{if(d)throw d.error}}else{let b=null==(g=null==a?void 0:a.constructor)?void 0:g.name;throw Error(`Unexpected data type: ${typeof a}${b?`; constructor: ${b}`:""}${function(a){if("object"!=typeof a||null===a)return"";let b=Object.getOwnPropertyNames(a);return`; props: [${b.map(a=>`"${a}"`).join(", ")}]`}(a)}`)}return b}class ma{constructor(a){this._client=a}}function mb(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}ma._key=[];let mc=Object.freeze(Object.create(null)),md=((a=mb)=>function(b,...c){let d;if(1===b.length)return b[0];let e=!1,f=[],g=b.reduce((b,d,g)=>{var h,i,j;/[?#]/.test(d)&&(e=!0);let k=c[g],l=(e?encodeURIComponent:a)(""+k);return g!==c.length&&(null==k||"object"==typeof k&&k.toString===(null==(j=Object.getPrototypeOf(null!=(i=Object.getPrototypeOf(null!=(h=k.hasOwnProperty)?h:mc))?i:mc))?void 0:j.toString))&&(l=k+"",f.push({start:b.length+d.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),b+d+(g===c.length?"":l)},""),h=g.split(/[?#]/,1)[0],i=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(d=i.exec(h));)f.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(f.sort((a,b)=>a.start-b.start),f.length>0){let a=0,b=f.reduce((b,c)=>{let d=" ".repeat(c.start-a),e="^".repeat(c.length);return a=c.start+c.length,b+d+e},"");throw new lK(`Path parameters result in path with invalid segments:
${f.map(a=>a.error).join("\n")}
${g}
${b}`)}return g})(mb);class me extends ma{create(a,b){var c;let{api_version:d=this._client.apiVersion}=a,e=kV(a,["api_version"]);if("model"in e&&"agent_config"in e)throw new lK("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in e&&"generation_config"in e)throw new lK("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(md`/${d}/interactions`,Object.assign(Object.assign({body:e},b),{stream:null!=(c=a.stream)&&c}))}delete(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.delete(md`/${d}/interactions/${a}`,c)}cancel(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.post(md`/${d}/interactions/${a}/cancel`,c)}get(a,b={},c){var d;let e=null!=b?b:{},{api_version:f=this._client.apiVersion}=e,g=kV(e,["api_version"]);return this._client.get(md`/${f}/interactions/${a}`,Object.assign(Object.assign({query:g},c),{stream:null!=(d=null==b?void 0:b.stream)&&d}))}}me._key=Object.freeze(["interactions"]);class mf extends me{}function mg(a){let b;return(null!=d?d:d=(b=new globalThis.TextEncoder).encode.bind(b))(a)}function mh(a){let b;return(null!=e?e:e=(b=new globalThis.TextDecoder).decode.bind(b))(a)}class mi{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){let b;if(null==a)return[];let c=a instanceof ArrayBuffer?new Uint8Array(a):"string"==typeof a?mg(a):a;this.buffer=function(a){let b=0;for(let c of a)b+=c.length;let c=new Uint8Array(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}([this.buffer,c]);let d=[];for(;null!=(b=function(a,b){for(let c=null!=b?b:0;c<a.length;c++){if(10===a[c])return{preceding:c,index:c+1,carriage:!1};if(13===a[c])return{preceding:c,index:c+1,carriage:!0}}return null}(this.buffer,this.carriageReturnIndex));){if(b.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=b.index;continue}if(null!=this.carriageReturnIndex&&(b.index!==this.carriageReturnIndex+1||b.carriage)){d.push(mh(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let a=null!==this.carriageReturnIndex?b.preceding-1:b.preceding,c=mh(this.buffer.subarray(0,a));d.push(c),this.buffer=this.buffer.subarray(b.index),this.carriageReturnIndex=null}return d}flush(){return this.buffer.length?this.decode("\n"):[]}}mi.NEWLINE_CHARS=new Set(["\n","\r"]),mi.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let mj={off:0,error:200,warn:300,info:400,debug:500},mk=(a,b,c)=>{if(a){if(Object.prototype.hasOwnProperty.call(mj,a))return a;mp(c).warn(`${b} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(mj))}`)}};function ml(){}function mm(a,b,c){return!b||mj[a]>mj[c]?ml:b[a].bind(b)}let mn={error:ml,warn:ml,info:ml,debug:ml},mo=new WeakMap;function mp(a){var b;let c=a.logger,d=null!=(b=a.logLevel)?b:"off";if(!c)return mn;let e=mo.get(c);if(e&&e[0]===d)return e[1];let f={error:mm("error",c,d),warn:mm("warn",c,d),info:mm("info",c,d),debug:mm("debug",c,d)};return mo.set(c,[d,f]),f}let mq=a=>(a.options&&(a.options=Object.assign({},a.options),delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([a,b])=>[a,"x-goog-api-key"===a.toLowerCase()||"authorization"===a.toLowerCase()||"cookie"===a.toLowerCase()||"set-cookie"===a.toLowerCase()?"***":b]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class mr{constructor(a,b,c){this.iterator=a,this.controller=b,this.client=c}static fromSSEResponse(a,b,c){let d=!1,e=c?mp(c):console;return new mr(function(){return kX(this,arguments,function*(){var c,f,g,h;if(d)throw new lK("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let i=!1;try{try{for(var j,k=!0,l=kY(function(a,b){return kX(this,arguments,function*(){var c,d,e,f;if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new lK("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new lK("Attempted to iterate over a response with no body")}let g=new ms,h=new mi,i=l2(a.body);try{for(var j,k=!0,l=kY(function(a){return kX(this,arguments,function*(){var b,c,d,e;let f=new Uint8Array;try{for(var g,h=!0,i=kY(a);!(b=(g=yield kW(i.next())).done);h=!0){let a;if(e=g.value,h=!1,null==e)continue;let b=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?mg(e):e,c=new Uint8Array(f.length+b.length);for(c.set(f),c.set(b,f.length),f=c;-1!==(a=function(a){for(let b=0;b<a.length-1;b++){if(10===a[b]&&10===a[b+1]||13===a[b]&&13===a[b+1])return b+2;if(13===a[b]&&10===a[b+1]&&b+3<a.length&&13===a[b+2]&&10===a[b+3])return b+4}return -1}(f));)yield yield kW(f.slice(0,a)),f=f.slice(a)}}catch(a){c={error:a}}finally{try{!h&&!b&&(d=i.return)&&(yield kW(d.call(i)))}finally{if(c)throw c.error}}f.length>0&&(yield yield kW(f))})}(i));!(c=(j=yield kW(l.next())).done);k=!0)for(let a of(f=j.value,k=!1,h.decode(f))){let b=g.decode(a);b&&(yield yield kW(b))}}catch(a){d={error:a}}finally{try{!k&&!c&&(e=l.return)&&(yield kW(e.call(l)))}finally{if(d)throw d.error}}for(let a of h.flush()){let b=g.decode(a);b&&(yield yield kW(b))}})}(a,b));!(c=(j=yield kW(l.next())).done);k=!0)if(h=j.value,k=!1,!i)if(h.data.startsWith("[DONE]")){i=!0;continue}else try{yield yield kW(JSON.parse(h.data))}catch(a){throw e.error("Could not parse message into JSON:",h.data),e.error("From chunk:",h.raw),a}}catch(a){f={error:a}}finally{try{!k&&!c&&(g=l.return)&&(yield kW(g.call(l)))}finally{if(f)throw f.error}}i=!0}catch(a){if(lI(a))return yield kW(void 0);throw a}finally{i||b.abort()}})},b,c)}static fromReadableStream(a,b,c){let d=!1;return new mr(function(){return kX(this,arguments,function*(){var c,e,f,g;if(d)throw new lK("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let h=!1;try{try{for(var i,j=!0,k=kY(function(){return kX(this,arguments,function*(){var b,c,d,e;let f=new mi,g=l2(a);try{for(var h,i=!0,j=kY(g);!(b=(h=yield kW(j.next())).done);i=!0)for(let a of(e=h.value,i=!1,f.decode(e)))yield yield kW(a)}catch(a){c={error:a}}finally{try{!i&&!b&&(d=j.return)&&(yield kW(d.call(j)))}finally{if(c)throw c.error}}for(let a of f.flush())yield yield kW(a)})}());!(c=(i=yield kW(k.next())).done);j=!0)g=i.value,j=!1,!h&&g&&(yield yield kW(JSON.parse(g)))}catch(a){e={error:a}}finally{try{!j&&!c&&(f=k.return)&&(yield kW(f.call(k)))}finally{if(e)throw e.error}}h=!0}catch(a){if(lI(a))return yield kW(void 0);throw a}finally{h||b.abort()}})},b,c)}[Symbol.asyncIterator](){return this.iterator()}tee(){let a=[],b=[],c=this.iterator(),d=d=>({next:()=>{if(0===d.length){let d=c.next();a.push(d),b.push(d)}return d.shift()}});return[new mr(()=>d(a),this.controller,this.client),new mr(()=>d(b),this.controller,this.client)]}toReadableStream(){let a,b=this;return l1({async start(){a=b[Symbol.asyncIterator]()},async pull(b){try{let{value:c,done:d}=await a.next();if(d)return b.close();let e=mg(JSON.stringify(c)+"\n");b.enqueue(e)}catch(a){b.error(a)}},async cancel(){var b;await (null==(b=a.return)?void 0:b.call(a))}})}}class ms{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){var b;let c;if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;let a={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(a),a.startsWith(":"))return null;let[d,e,f]=-1!==(c=(b=a).indexOf(":"))?[b.substring(0,c),":",b.substring(c+1)]:[b,"",""];return f.startsWith(" ")&&(f=f.substring(1)),"event"===d?this.event=f:"data"===d&&this.data.push(f),null}}async function mt(a,b){let{response:c,requestLogID:d,retryOfRequestLogID:e,startTime:f}=b,g=await (async()=>{var d;if(b.options.stream)return(mp(a).debug("response",c.status,c.url,c.headers,c.body),b.options.__streamClass)?b.options.__streamClass.fromSSEResponse(c,b.controller,a):mr.fromSSEResponse(c,b.controller,a);if(204===c.status)return null;if(b.options.__binaryResponse)return c;let e=c.headers.get("content-type"),f=null==(d=null==e?void 0:e.split(";")[0])?void 0:d.trim();return(null==f?void 0:f.includes("application/json"))||(null==f?void 0:f.endsWith("+json"))?await c.json():await c.text()})();return mp(a).debug(`[${d}] response parsed`,mq({retryOfRequestLogID:e,url:c.url,status:c.status,body:g,durationMs:Date.now()-f})),g}class mu extends Promise{constructor(a,b,c=mt){super(a=>{a(null)}),this.responsePromise=b,this.parseResponse=c,this.client=a}_thenUnwrap(a){return new mu(this.client,this.responsePromise,async(b,c)=>a(await this.parseResponse(b,c),c))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){let[a,b]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:b}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,b){return this.parse().then(a,b)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}let mv=Symbol("brand.privateNullableHeaders"),mw=a=>{let b=new Headers,c=new Set;for(let d of a){let a=new Set;for(let[e,f]of function*(a){let b;if(!a)return;if(mv in a){let{values:b,nulls:c}=a;for(let a of(yield*b.entries(),c))yield[a,null];return}let c=!1;for(let d of(a instanceof Headers?b=a.entries():lZ(a)?b=a:(c=!0,b=Object.entries(null!=a?a:{})),b)){let a=d[0];if("string"!=typeof a)throw TypeError("expected header name to be a string");let b=lZ(d[1])?d[1]:[d[1]],e=!1;for(let d of b)void 0!==d&&(c&&!e&&(e=!0,yield[a,null]),yield[a,d])}}(d)){let d=e.toLowerCase();a.has(d)||(b.delete(e),a.add(d)),null===f?(b.delete(e),c.add(d)):(b.append(e,f),c.delete(d))}}return{[mv]:!0,values:b,nulls:c}},mx=a=>{var b,c,d,e,f,g;return void 0!==globalThis.process?null!=(d=null==(c=null==(b=globalThis.process.env)?void 0:b[a])?void 0:c.trim())?d:void 0:void 0!==globalThis.Deno?null==(g=null==(f=null==(e=globalThis.Deno.env)?void 0:e.get)?void 0:f.call(e,a))?void 0:g.trim():void 0};class my{constructor(a){var b,c,d,e,f,g,h,{baseURL:i=mx("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:j=null!=(b=mx("GEMINI_API_KEY"))?b:null,apiVersion:k="v1beta"}=a;const l=Object.assign(Object.assign({apiKey:j,apiVersion:k},kV(a,["baseURL","apiKey","apiVersion"])),{baseURL:i||"https://generativelanguage.googleapis.com"});this.baseURL=l.baseURL,this.timeout=null!=(c=l.timeout)?c:my.DEFAULT_TIMEOUT,this.logger=null!=(d=l.logger)?d:console;const m="warn";this.logLevel=m,this.logLevel=null!=(f=null!=(e=mk(l.logLevel,"ClientOptions.logLevel",this))?e:mk(mx("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))?f:m,this.fetchOptions=l.fetchOptions,this.maxRetries=null!=(g=l.maxRetries)?g:2,this.fetch=null!=(h=l.fetch)?h:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=l4,this._options=l,this.apiKey=j,this.apiVersion=k,this.clientAdapter=l.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:b}){if(!(a.has("authorization")||a.has("x-goog-api-key")||this.apiKey&&a.get("x-goog-api-key"))&&!b.has("x-goog-api-key"))throw Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){let b=mw([a.headers]);if(!(b.values.has("authorization")||b.values.has("x-goog-api-key"))){if(this.apiKey)return mw([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return mw([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([a,b])=>void 0!==b).map(([a,b])=>{if("string"==typeof b||"number"==typeof b||"boolean"==typeof b)return`${encodeURIComponent(a)}=${encodeURIComponent(b)}`;if(null===b)return`${encodeURIComponent(a)}=`;throw new lK(`Cannot stringify type ${typeof b}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${l$}`}defaultIdempotencyKey(){return`stainless-node-retry-${lH()}`}makeStatusError(a,b,c,d){return lL.generate(a,b,c,d)}buildURL(a,b,c){let d=!this.baseURLOverridden()&&c||this.baseURL,e=new URL(lX.test(a)?a:d+(d.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return!function(a){if(!a)return!0;for(let b in a)return!1;return!0}(f)&&(b=Object.assign(Object.assign({},f),b)),"object"==typeof b&&b&&!Array.isArray(b)&&(e.search=this.stringifyQuery(b)),e.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){let b=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${b}`}}async prepareRequest(a,{url:b,options:c}){}get(a,b){return this.methodRequest("get",a,b)}post(a,b){return this.methodRequest("post",a,b)}patch(a,b){return this.methodRequest("patch",a,b)}put(a,b){return this.methodRequest("put",a,b)}delete(a,b){return this.methodRequest("delete",a,b)}methodRequest(a,b,c){return this.request(Promise.resolve(c).then(c=>Object.assign({method:a,path:b},c)))}request(a,b=null){return new mu(this,this.makeRequest(a,b,void 0))}async makeRequest(a,b,c){var d,e,f;let g=await a,h=null!=(d=g.maxRetries)?d:this.maxRetries;null==b&&(b=h),await this.prepareOptions(g);let{req:i,url:j,timeout:k}=await this.buildRequest(g,{retryCount:h-b});await this.prepareRequest(i,{url:j,options:g});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),m=void 0===c?"":`, retryOf: ${c}`,n=Date.now();if(mp(this).debug(`[${l}] sending request`,mq({retryOfRequestLogID:c,method:g.method,url:j,options:g,headers:i.headers})),null==(e=g.signal)?void 0:e.aborted)throw new lM;let o=new AbortController,p=await this.fetchWithTimeout(j,i,k,o).catch(lJ),q=Date.now();if(p instanceof globalThis.Error){let a=`retrying, ${b} attempts remaining`;if(null==(f=g.signal)?void 0:f.aborted)throw new lM;let d=lI(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(b)return mp(this).info(`[${l}] connection ${d?"timed out":"failed"} - ${a}`),mp(this).debug(`[${l}] connection ${d?"timed out":"failed"} (${a})`,mq({retryOfRequestLogID:c,url:j,durationMs:q-n,message:p.message})),this.retryRequest(g,b,null!=c?c:l);if(mp(this).info(`[${l}] connection ${d?"timed out":"failed"} - error; no more retries left`),mp(this).debug(`[${l}] connection ${d?"timed out":"failed"} (error; no more retries left)`,mq({retryOfRequestLogID:c,url:j,durationMs:q-n,message:p.message})),d)throw new lO;throw new lN({cause:p})}let r=`[${l}${m}] ${i.method} ${j} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${q-n}ms`;if(!p.ok){let a=await this.shouldRetry(p);if(b&&a){let a=`retrying, ${b} attempts remaining`;return await l3(p.body),mp(this).info(`${r} - ${a}`),mp(this).debug(`[${l}] response error (${a})`,mq({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,durationMs:q-n})),this.retryRequest(g,b,null!=c?c:l,p.headers)}let d=a?"error; no more retries left":"error; not retryable";mp(this).info(`${r} - ${d}`);let e=await p.text().catch(a=>lJ(a).message),f=(a=>{try{return JSON.parse(a)}catch(a){return}})(e),h=f?void 0:e;throw mp(this).debug(`[${l}] response error (${d})`,mq({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,message:h,durationMs:Date.now()-n})),this.makeStatusError(p.status,f,h,p.headers)}return mp(this).info(r),mp(this).debug(`[${l}] response start`,mq({retryOfRequestLogID:c,url:p.url,status:p.status,headers:p.headers,durationMs:q-n})),{response:p,options:g,controller:o,requestLogID:l,retryOfRequestLogID:c,startTime:n}}async fetchWithTimeout(a,b,c,d){let e=b||{},{signal:f,method:g}=e,h=kV(e,["signal","method"]);f&&f.addEventListener("abort",()=>d.abort());let i=setTimeout(()=>d.abort(),c),j=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||"object"==typeof h.body&&null!==h.body&&Symbol.asyncIterator in h.body,k=Object.assign(Object.assign(Object.assign({signal:d.signal},j?{duplex:"half"}:{}),{method:"GET"}),h);g&&(k.method=g.toUpperCase());try{return await this.fetch.call(void 0,a,k)}finally{clearTimeout(i)}}async shouldRetry(a){let b=a.headers.get("x-should-retry");return"true"===b||"false"!==b&&(408===a.status||409===a.status||429===a.status||!!(a.status>=500))}async retryRequest(a,b,c,d){var e;let f,g,h=null==d?void 0:d.get("retry-after-ms");if(h){let a=parseFloat(h);Number.isNaN(a)||(f=a)}let i=null==d?void 0:d.get("retry-after");if(i&&!f){let a=parseFloat(i);f=Number.isNaN(a)?Date.parse(i)-Date.now():1e3*a}if(!(f&&0<=f&&f<6e4)){let c=null!=(e=a.maxRetries)?e:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(b,c)}return await (g=f,new Promise(a=>setTimeout(a,g))),this.makeRequest(a,b-1,c)}calculateDefaultRetryTimeoutMillis(a,b){return Math.min(.5*Math.pow(2,b-a),8)*(1-.25*Math.random())*1e3}async buildRequest(a,{retryCount:b=0}={}){var c,d,e;let f=Object.assign({},a),{method:g,path:h,query:i,defaultBaseURL:j}=f,k=this.buildURL(h,i,j);"timeout"in f&&((a,b)=>{if("number"!=typeof b||!Number.isInteger(b))throw new lK(`${a} must be an integer`);if(b<0)throw new lK(`${a} must be a positive integer`)})("timeout",f.timeout),f.timeout=null!=(c=f.timeout)?c:this.timeout;let{bodyHeaders:l,body:m}=this.buildBody({options:f}),n=await this.buildHeaders({options:a,method:g,bodyHeaders:l,retryCount:b});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:g,headers:n},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),null!=(d=this.fetchOptions)?d:{}),null!=(e=f.fetchOptions)?e:{}),url:k,timeout:f.timeout}}async buildHeaders({options:a,method:b,bodyHeaders:d,retryCount:e}){let f={};this.idempotencyHeader&&"get"!==b&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),f[this.idempotencyHeader]=a.idempotencyKey);let g=await this.authHeaders(a),h=mw([f,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(e)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),null!=c?c:c=(()=>{var a,b,c,d,e;let f="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l$,"X-Stainless-OS":l0(Deno.build.os),"X-Stainless-Arch":l_(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!=(b=null==(a=Deno.version)?void 0:a.deno)?b:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l$,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l$,"X-Stainless-OS":l0(null!=(c=globalThis.process.platform)?c:"unknown"),"X-Stainless-Arch":l_(null!=(d=globalThis.process.arch)?d:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!=(e=globalThis.process.version)?e:"unknown"};let g=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:a,pattern:b}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let c=b.exec(navigator.userAgent);if(c){let b=c[1]||0,d=c[2]||0,e=c[3]||0;return{browser:a,version:`${b}.${d}.${e}`}}}return null}();return g?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l$,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${g.browser}`,"X-Stainless-Runtime-Version":g.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l$,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),this._options.defaultHeaders,d,a.headers,g]);return this.validateHeaders(h),h.values}buildBody({options:{body:a,headers:b}}){let c;if(!a)return{bodyHeaders:void 0,body:void 0};let d=mw([b]);if(ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||"string"==typeof a&&d.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream)return{bodyHeaders:void 0,body:a};if("object"!=typeof a||!(Symbol.asyncIterator in a)&&(!(Symbol.iterator in a)||!("next"in a)||"function"!=typeof a.next))return this.encoder({body:a,headers:d});return{bodyHeaders:void 0,body:(c=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator](),l1({start(){},async pull(a){let{done:b,value:d}=await c.next();b?a.close():a.enqueue(d)},async cancel(){var a;await (null==(a=c.return)?void 0:a.call(c))}}))}}}my.DEFAULT_TIMEOUT=6e4;class mz extends my{constructor(){super(...arguments),this.interactions=new mf(this)}}mz.GeminiNextGenAPIClient=mz,mz.GeminiNextGenAPIClientError=lK,mz.APIError=lL,mz.APIConnectionError=lN,mz.APIConnectionTimeoutError=lO,mz.APIUserAbortError=lM,mz.NotFoundError=lS,mz.ConflictError=lT,mz.RateLimitError=lV,mz.BadRequestError=lP,mz.AuthenticationError=lQ,mz.InternalServerError=lW,mz.PermissionDeniedError=lR,mz.UnprocessableEntityError=lU,mz.toFile=l8,mz.Interactions=mf;let mA="x-goog-api-key",mB="https://www.googleapis.com/auth/cloud-platform";class mC{constructor(a){if(void 0!==a.apiKey){this.apiKey=a.apiKey;return}const b=function(a){let b;if(!a)return{scopes:[mB]};if((b=a).scopes){if("string"==typeof b.scopes&&b.scopes!==mB||Array.isArray(b.scopes)&&0>b.scopes.indexOf(mB))throw Error(`Invalid auth scopes. Scopes must include: ${mB}`)}else b.scopes=[mB];return b}(a.googleAuthOptions);this.googleAuth=new jG.GoogleAuth(b)}async addAuthHeaders(a,b){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(a);return}return this.addGoogleAuthHeaders(a,b)}addKeyHeader(a){if(null===a.get(mA)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");a.append(mA,this.apiKey)}}async addGoogleAuthHeaders(a,b){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");for(let[c,d]of(await this.googleAuth.getRequestHeaders(b)))null===a.get(c)&&a.append(c,d)}}class mD{async download(a,b){if(a.downloadPath){let c=await mE(a,b);if(c instanceof jT){let b=(0,jH.createWriteStream)(a.downloadPath);jJ.Readable.fromWeb(c.responseInternal.body).pipe(b),await (0,jK.finished)(b)}else try{await (0,jI.writeFile)(a.downloadPath,c,{encoding:"base64"})}catch(b){throw Error(`Failed to write file to ${a.downloadPath}: ${b}`)}}}}async function mE(a,b){var c,d,e;let f=kG(a.file);if(void 0!==f)return await b.request({path:`files/${f}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null==(c=a.config)?void 0:c.httpOptions,abortSignal:null==(d=a.config)?void 0:d.abortSignal});if(kE(a.file)){let b=null==(e=a.file.video)?void 0:e.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(kF(a.file)){let b=a.file.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class mF{create(a,b,c){return new mG(a,b,c)}}class mG{constructor(a,b,c){this.url=a,this.headers=b,this.callbacks=c}connect(){this.ws=new jL.default(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(a){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(a)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function mH(a,b){let c,d,e,f={},g=jQ(a,["sdkHttpResponse"]);null!=g&&jP(f,["sdkHttpResponse"],g);let h=jQ(a,["name"]);null!=h&&jP(f,["name"],h);let i=jQ(a,["state"]);null!=i&&jP(f,["state"],kD(i));let j=jQ(a,["createTime"]);null!=j&&jP(f,["createTime"],j);let k=jQ(a,["tuningTask","startTime"]);null!=k&&jP(f,["startTime"],k);let l=jQ(a,["tuningTask","completeTime"]);null!=l&&jP(f,["endTime"],l);let m=jQ(a,["updateTime"]);null!=m&&jP(f,["updateTime"],m);let n=jQ(a,["description"]);null!=n&&jP(f,["description"],n);let o=jQ(a,["baseModel"]);null!=o&&jP(f,["baseModel"],o);let p=jQ(a,["_self"]);return null!=p&&jP(f,["tunedModel"],(c={},null!=(d=jQ(p,["name"]))&&jP(c,["model"],d),null!=(e=jQ(p,["name"]))&&jP(c,["endpoint"],e),c)),f}function mI(a,b){let c={},d=jQ(a,["sdkHttpResponse"]);null!=d&&jP(c,["sdkHttpResponse"],d);let e=jQ(a,["name"]);null!=e&&jP(c,["name"],e);let f=jQ(a,["state"]);null!=f&&jP(c,["state"],kD(f));let g=jQ(a,["createTime"]);null!=g&&jP(c,["createTime"],g);let h=jQ(a,["startTime"]);null!=h&&jP(c,["startTime"],h);let i=jQ(a,["endTime"]);null!=i&&jP(c,["endTime"],i);let j=jQ(a,["updateTime"]);null!=j&&jP(c,["updateTime"],j);let k=jQ(a,["error"]);null!=k&&jP(c,["error"],k);let l=jQ(a,["description"]);null!=l&&jP(c,["description"],l);let m=jQ(a,["baseModel"]);null!=m&&jP(c,["baseModel"],m);let n=jQ(a,["tunedModel"]);null!=n&&jP(c,["tunedModel"],n);let o=jQ(a,["preTunedModel"]);null!=o&&jP(c,["preTunedModel"],o);let p=jQ(a,["supervisedTuningSpec"]);null!=p&&jP(c,["supervisedTuningSpec"],p);let q=jQ(a,["preferenceOptimizationSpec"]);null!=q&&jP(c,["preferenceOptimizationSpec"],q);let r=jQ(a,["tuningDataStats"]);null!=r&&jP(c,["tuningDataStats"],r);let s=jQ(a,["encryptionSpec"]);null!=s&&jP(c,["encryptionSpec"],s);let t=jQ(a,["partnerModelTuningSpec"]);null!=t&&jP(c,["partnerModelTuningSpec"],t);let u=jQ(a,["customBaseModel"]);null!=u&&jP(c,["customBaseModel"],u);let v=jQ(a,["experiment"]);null!=v&&jP(c,["experiment"],v);let w=jQ(a,["labels"]);null!=w&&jP(c,["labels"],w);let x=jQ(a,["outputUri"]);null!=x&&jP(c,["outputUri"],x);let y=jQ(a,["pipelineJob"]);null!=y&&jP(c,["pipelineJob"],y);let z=jQ(a,["serviceAccount"]);null!=z&&jP(c,["serviceAccount"],z);let A=jQ(a,["tunedModelDisplayName"]);null!=A&&jP(c,["tunedModelDisplayName"],A);let B=jQ(a,["veoTuningSpec"]);return null!=B&&jP(c,["veoTuningSpec"],B),c}function mJ(a,b){let c={},d=jQ(a,["gcsUri"]);null!=d&&jP(c,["validationDatasetUri"],d);let e=jQ(a,["vertexDatasetResource"]);return null!=e&&jP(c,["validationDatasetUri"],e),c}class mK extends jN{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new kR(bB.PAGED_ITEM_TUNING_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.get=async a=>await this.getInternal(a),this.tune=async a=>{var b;if(this.apiClient.isVertexAI())if(a.baseModel.startsWith("projects/")){let c={tunedModelName:a.baseModel};(null==(b=a.config)?void 0:b.preTunedModelCheckpointId)&&(c.checkpointId=a.config.preTunedModelCheckpointId);let d=Object.assign(Object.assign({},a),{preTunedModel:c});return d.baseModel=void 0,await this.tuneInternal(d)}else{let b=Object.assign({},a);return await this.tuneInternal(b)}{let b=Object.assign({},a),c=await this.tuneMldevInternal(b),d="";return void 0!==c.metadata&&void 0!==c.metadata.tunedModel?d=c.metadata.tunedModel:void 0!==c.name&&c.name.includes("/operations/")&&(d=c.name.split("/operations/")[0]),{name:d,state:a4.JOB_STATE_QUEUED}}}}async getInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],e),d);return f=jO("{name}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>mI(a))}{let b,c,h=(b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],c),b);return f=jO("{name}",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>mH(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h,i,j,k=(d={},null!=(e=jQ(a,["config"]))&&(h=jQ(e,["pageSize"]),void 0!==d&&null!=h&&jP(d,["_query","pageSize"],h),i=jQ(e,["pageToken"]),void 0!==d&&null!=i&&jP(d,["_query","pageToken"],i),j=jQ(e,["filter"]),void 0!==d&&null!=j&&jP(d,["_query","filter"],j)),d);return f=jO("tuningJobs",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=jQ(a,["sdkHttpResponse"]);null!=d&&jP(c,["sdkHttpResponse"],d);let e=jQ(a,["nextPageToken"]);null!=e&&jP(c,["nextPageToken"],e);let f=jQ(a,["tuningJobs"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>mI(a))),jP(c,["tuningJobs"],a)}return c}(a),c=new j4;return Object.assign(c,b),c})}{let b,c,h,i,j,k=(b={},null!=(c=jQ(a,["config"]))&&(h=jQ(c,["pageSize"]),void 0!==b&&null!=h&&jP(b,["_query","pageSize"],h),i=jQ(c,["pageToken"]),void 0!==b&&null!=i&&jP(b,["_query","pageToken"],i),j=jQ(c,["filter"]),void 0!==b&&null!=j&&jP(b,["_query","filter"],j)),b);return f=jO("tunedModels",k._url),g=k._query,delete k._url,delete k._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(k),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=jQ(a,["sdkHttpResponse"]);null!=d&&jP(c,["sdkHttpResponse"],d);let e=jQ(a,["nextPageToken"]);null!=e&&jP(c,["nextPageToken"],e);let f=jQ(a,["tunedModels"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>mH(a))),jP(c,["tuningJobs"],a)}return c}(a),c=new j4;return Object.assign(c,b),c})}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d,e,h=(d={},null!=(e=jQ(a,["name"]))&&jP(d,["_url","name"],e),d);return f=jO("{name}:cancel",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j5;return Object.assign(e,d),e})}{let b,c,h=(b={},null!=(c=jQ(a,["name"]))&&jP(b,["_url","name"],c),b);return f=jO("{name}:cancel",h._url),g=h._query,delete h._url,delete h._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d=(b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),b),e=new j5;return Object.assign(e,d),e})}}async tuneInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f,g,h,i,j,k=(f={},null!=(g=jQ(a,["baseModel"]))&&jP(f,["baseModel"],g),null!=(h=jQ(a,["preTunedModel"]))&&jP(f,["preTunedModel"],h),null!=(i=jQ(a,["trainingDataset"]))&&function(a,b,c){let d=jQ(c,["config","method"]);if(void 0===d&&(d="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===d){let c=jQ(a,["gcsUri"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","trainingDatasetUri"],c)}else if("PREFERENCE_TUNING"===d){let c=jQ(a,["gcsUri"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let e=jQ(c,["config","method"]);if(void 0===e&&(e="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===e){let c=jQ(a,["vertexDatasetResource"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","trainingDatasetUri"],c)}else if("PREFERENCE_TUNING"===e){let c=jQ(a,["vertexDatasetResource"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(void 0!==jQ(a,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(i,f,a),null!=(j=jQ(a,["config"]))&&function(a,b,c){let d=jQ(c,["config","method"]);if(void 0===d&&(d="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===d){let c=jQ(a,["validationDataset"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec"],mJ(c))}else if("PREFERENCE_TUNING"===d){let c=jQ(a,["validationDataset"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec"],mJ(c))}let e=jQ(a,["tunedModelDisplayName"]);void 0!==b&&null!=e&&jP(b,["tunedModelDisplayName"],e);let f=jQ(a,["description"]);void 0!==b&&null!=f&&jP(b,["description"],f);let g=jQ(c,["config","method"]);if(void 0===g&&(g="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===g){let c=jQ(a,["epochCount"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","hyperParameters","epochCount"],c)}else if("PREFERENCE_TUNING"===g){let c=jQ(a,["epochCount"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","hyperParameters","epochCount"],c)}let h=jQ(c,["config","method"]);if(void 0===h&&(h="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===h){let c=jQ(a,["learningRateMultiplier"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c)}else if("PREFERENCE_TUNING"===h){let c=jQ(a,["learningRateMultiplier"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],c)}let i=jQ(c,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let c=jQ(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","exportLastCheckpointOnly"],c)}else if("PREFERENCE_TUNING"===i){let c=jQ(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","exportLastCheckpointOnly"],c)}let j=jQ(c,["config","method"]);if(void 0===j&&(j="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===j){let c=jQ(a,["adapterSize"]);void 0!==b&&null!=c&&jP(b,["supervisedTuningSpec","hyperParameters","adapterSize"],c)}else if("PREFERENCE_TUNING"===j){let c=jQ(a,["adapterSize"]);void 0!==b&&null!=c&&jP(b,["preferenceOptimizationSpec","hyperParameters","adapterSize"],c)}if(void 0!==jQ(a,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==jQ(a,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let k=jQ(a,["labels"]);void 0!==b&&null!=k&&jP(b,["labels"],k);let l=jQ(a,["beta"]);void 0!==b&&null!=l&&jP(b,["preferenceOptimizationSpec","hyperParameters","beta"],l)}(j,f,a),f);return d=jO("tuningJobs",k._url),e=k._query,delete k._url,delete k._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>mI(a))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f,g,h,i,j,k=(f={},null!=(g=jQ(a,["baseModel"]))&&jP(f,["baseModel"],g),null!=(h=jQ(a,["preTunedModel"]))&&jP(f,["preTunedModel"],h),null!=(i=jQ(a,["trainingDataset"]))&&function(a,b){if(void 0!==jQ(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==jQ(a,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let c=jQ(a,["examples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),jP({},["examples","examples"],a)}}(i),null!=(j=jQ(a,["config"]))&&function(a,b,c){if(void 0!==jQ(a,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let d=jQ(a,["tunedModelDisplayName"]);if(void 0!==b&&null!=d&&jP(b,["displayName"],d),void 0!==jQ(a,["description"]))throw Error("description parameter is not supported in Gemini API.");let e=jQ(a,["epochCount"]);void 0!==b&&null!=e&&jP(b,["tuningTask","hyperparameters","epochCount"],e);let f=jQ(a,["learningRateMultiplier"]);if(null!=f&&jP({},["tuningTask","hyperparameters","learningRateMultiplier"],f),void 0!==jQ(a,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==jQ(a,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==jQ(a,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let g=jQ(a,["batchSize"]);void 0!==b&&null!=g&&jP(b,["tuningTask","hyperparameters","batchSize"],g);let h=jQ(a,["learningRate"]);if(void 0!==b&&null!=h&&jP(b,["tuningTask","hyperparameters","learningRate"],h),void 0!==jQ(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==jQ(a,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(j,f),f);return d=jO("tunedModels",k._url),e=k._query,delete k._url,delete k._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(k),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b,c,d,e,f,g;return b={},null!=(c=jQ(a,["sdkHttpResponse"]))&&jP(b,["sdkHttpResponse"],c),null!=(d=jQ(a,["name"]))&&jP(b,["name"],d),null!=(e=jQ(a,["metadata"]))&&jP(b,["metadata"],e),null!=(f=jQ(a,["done"]))&&jP(b,["done"],f),null!=(g=jQ(a,["error"]))&&jP(b,["error"],g),b})}}}let mL="x-goog-upload-status";async function mM(a,b,c){var d;let e=await mO(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[mL])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return f.file}async function mN(a,b,c){var d;let e=await mO(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[mL])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let g=jS(f),h=new ki;return Object.assign(h,g),h}async function mO(a,b,c){var d,e;let f=0,g=0,h=new jT(new Response),i="upload";for(f=a.size;g<f;){let j=Math.min(8388608,f-g),k=a.slice(g,g+j);g+j>=f&&(i+=", finalize");let l=0,m=1e3;for(;l<3&&(null==(d=null==(h=await c.request({path:"",body:k,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":i,"X-Goog-Upload-Offset":String(g),"Content-Length":String(j)}}}))?void 0:h.headers)||!d[mL]);)l++,await mQ(m),m*=2;if(g+=j,(null==(e=null==h?void 0:h.headers)?void 0:e[mL])!=="active")break;if(f<=g)throw Error("All content has been uploaded, but the upload status is not finalized.")}return h}async function mP(a){return{size:a.size,type:a.type}}function mQ(a){return new Promise(b=>setTimeout(b,a))}class mR{async stat(a){let b={size:0,type:void 0};return"string"==typeof a?(b.size=(await jI.stat(a)).size,b.type=this.inferMimeType(a),b):await mP(a)}async upload(a,b,c){return"string"==typeof a?await this.uploadFileFromPath(a,b,c):mM(a,b,c)}async uploadToFileSearchStore(a,b,c){return"string"==typeof a?await this.uploadFileToFileSearchStoreFromPath(a,b,c):mN(a,b,c)}inferMimeType(a){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[a.slice(a.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(a,b,c){var d;let e=await this.uploadFileFromPathInternal(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[mL])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return f.file}async uploadFileToFileSearchStoreFromPath(a,b,c){var d;let e=await this.uploadFileFromPathInternal(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[mL])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let g=jS(f),h=new ki;return Object.assign(h,g),h}async uploadFileFromPathInternal(a,b,c){var d,e;let f,g=0,h=0,i=new jT(new Response),j="upload",k=jM.basename(a);try{if(!(f=await jI.open(a,"r")))throw Error("Failed to open file");for(g=(await f.stat()).size;h<g;){let a=Math.min(8388608,g-h);h+a>=g&&(j+=", finalize");let l=new Uint8Array(a),{bytesRead:m}=await f.read(l,0,a,h);if(m!==a)throw Error(`Failed to read ${a} bytes from file at offset ${h}. bytes actually read: ${m}`);let n=new Blob([l]),o=0,p=1e3;for(;o<3&&(null==(d=null==(i=await c.request({path:"",body:n,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":j,"X-Goog-Upload-Offset":String(h),"Content-Length":String(m),"X-Goog-Upload-File-Name":k}}}))?void 0:i.headers)||!d[mL]);)o++,await mQ(p),p*=2;if(h+=m,(null==(e=null==i?void 0:i.headers)?void 0:e[mL])!=="active")break;if(g<=h)throw Error("All content has been uploaded, but the upload status is not finalized.")}return i}finally{f&&await f.close()}}}function mS(a){var b,c,d;return null!=(d=null==(c=null==(b=null==process?void 0:process.env)?void 0:b[a])?void 0:c.trim())?d:void 0}let mT=new class{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let a=this.httpOptions;(null==a?void 0:a.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let b=new mz({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==a?void 0:a.timeout});return this._interactions=b.interactions,this._interactions}constructor(a){var b,c,d,e,f,g;if((a.project||a.location)&&a.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!=(c=null!=(b=a.vertexai)?b:function(a){var b;return void 0!==(b=mS(a))&&"true"===b.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&c;const j=function(){let a=mS("GOOGLE_API_KEY"),b=mS("GEMINI_API_KEY");return a&&b&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),a||b||void 0}(),k=mS("GOOGLE_CLOUD_PROJECT"),l=mS("GOOGLE_CLOUD_LOCATION");this.apiKey=null!=(d=a.apiKey)?d:j,this.project=null!=(e=a.project)?e:k,this.location=null!=(f=a.location)?f:l,a.vertexai&&((null==(g=a.googleAuthOptions)?void 0:g.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(k||l)&&a.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(a.project||a.location)&&j?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(k||l)&&j&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0),this.location||this.apiKey||(this.location="global"));const m=function(a,b,c,d){return(null==a?void 0:a.baseUrl)?a.baseUrl:b?null!=i?i:c:null!=h?h:d}(a.httpOptions,a.vertexai,mS("GOOGLE_VERTEX_BASE_URL"),mS("GOOGLE_GEMINI_BASE_URL"));m&&(a.httpOptions?a.httpOptions.baseUrl=m:a.httpOptions={baseUrl:m}),this.apiVersion=a.apiVersion,this.httpOptions=a.httpOptions;const n=new mC({apiKey:this.apiKey,googleAuthOptions:a.googleAuthOptions});this.apiClient=new lm({auth:n,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new mR,downloader:new mD}),this.models=new lC(this.apiClient),this.live=new lv(this.apiClient,n,new mF),this.batches=new kS(this.apiClient),this.chats=new k_(this.models,this.apiClient),this.caches=new kU(this.apiClient),this.files=new k2(this.apiClient),this.operations=new lD(this.apiClient),this.authTokens=new lE(this.apiClient),this.tunings=new mK(this.apiClient),this.fileSearchStores=new lG(this.apiClient)}}({apiKey:"AIzaSyDp4y5DoJb3KHP9V2panIPYSbGcNCe5oHU"}),mU=async(a,b=[])=>{try{let c=mT.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:"You are Nexus, a futuristic personal assistant for a programmer/student. You help with coding, scheduling, and summarizing notes. Keep answers concise, technical, and helpful. You can use Markdown for formatting (bold, lists, headers), but DO NOT wrap general responses, lists, or schedules in code blocks (```). Only use code blocks for actual executable programming code (e.g., Python, JavaScript, HTML)."},history:b.map(a=>({role:a.role,parts:[{text:a.text}]}))});return(await c.sendMessage({message:a})).text||"No response generated."}catch(a){return console.error("Gemini API Error:",a),"Error connecting to Nexus AI Core. Please check your API Key configuration."}},mV=()=>{let[a,b]=(0,bD.useState)(""),[c,d]=(0,bD.useState)([{id:"1",role:"model",text:"Systems Online. How can I assist you today?",timestamp:new Date}]),[e,f]=(0,bD.useState)(!1),g=(0,bD.useRef)(null);(0,bD.useEffect)(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[c]);let h=async()=>{if(!a.trim()||e)return;let g={id:Date.now().toString(),role:"user",text:a,timestamp:new Date};d(a=>[...a,g]),b(""),f(!0);try{let b=c.map(a=>({role:a.role,text:a.text})),e=await mU(a,b),f={id:(Date.now()+1).toString(),role:"model",text:e,timestamp:new Date};d(a=>[...a,f])}catch(a){console.error(a)}finally{f(!1)}};return(0,bC.jsxs)("div",{className:"flex flex-col h-full",children:[(0,bC.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 pr-2",children:[c.map(a=>(0,bC.jsx)("div",{className:`flex ${"user"===a.role?"justify-end":"justify-start"}`,children:(0,bC.jsxs)("div",{className:`
                max-w-[85%] p-3 rounded-2xl text-sm font-mono
                ${"user"===a.role?"bg-nexus-purple text-white rounded-br-none":"bg-nexus-dark/50 border border-white/10 text-gray-200 rounded-bl-none"}
              `,children:[(0,bC.jsxs)("div",{className:"flex items-center gap-2 mb-1 opacity-50 text-xs",children:["model"===a.role?(0,bC.jsx)(jD,{size:12}):(0,bC.jsx)(jE,{size:12}),(0,bC.jsx)("span",{children:"model"===a.role?"Nexus AI":"You"})]}),(0,bC.jsx)("div",{className:"whitespace-pre-wrap",children:a.text})]})},a.id)),e&&(0,bC.jsx)("div",{className:"flex justify-start animate-pulse",children:(0,bC.jsxs)("div",{className:"bg-nexus-dark/50 border border-white/10 p-3 rounded-2xl rounded-bl-none text-sm text-nexus-teal flex items-center gap-2",children:[(0,bC.jsx)(jF,{size:14,className:"animate-spin"}),(0,bC.jsx)("span",{children:"Thinking..."})]})}),(0,bC.jsx)("div",{ref:g})]}),(0,bC.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,bC.jsx)("input",{type:"text",value:a,onChange:a=>b(a.target.value),onKeyDown:a=>"Enter"===a.key&&h(),placeholder:"Ask Gemini...",className:"flex-1 bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:outline-none focus:border-nexus-teal transition-colors font-mono"}),(0,bC.jsx)("button",{onClick:h,disabled:e,className:"bg-nexus-teal hover:bg-teal-400 text-nexus-deep p-2 rounded-xl transition-transform active:scale-95 disabled:opacity-50",children:(0,bC.jsx)(jC,{size:18})})]})]})},mW=bI("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),mX=bI("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),mY=bI("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]),mZ=()=>{let[a,b]=(0,bD.useState)(()=>"<h1>Lecture 4: React Hooks</h1><ul><li>useState</li><li>useEffect</li></ul>");return(0,bC.jsxs)("div",{className:"flex flex-col h-full relative",children:[(0,bC.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bC.jsxs)("div",{className:"flex gap-2",children:[(0,bC.jsx)("button",{className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-nexus-teal transition-colors",title:"Insert Image",children:(0,bC.jsx)(mX,{size:16})}),(0,bC.jsx)("button",{className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-nexus-teal transition-colors",title:"Code Block",children:(0,bC.jsx)(mY,{size:16})}),(0,bC.jsx)("button",{className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-nexus-teal transition-colors",title:"Latex Mode",children:(0,bC.jsx)("span",{className:"font-serif italic font-bold",children:"â"})})]}),(0,bC.jsxs)("button",{onClick:()=>{alert("Exporting note as PDF..."),document.getElementById("note-editor")?.innerHTML,document.body.innerHTML},className:"flex items-center gap-1 text-[10px] bg-nexus-deep border border-nexus-teal/30 text-nexus-teal px-2 py-1 rounded hover:bg-nexus-teal hover:text-nexus-deep transition-all",children:[(0,bC.jsx)(mW,{size:12})," PDF"]})]}),(0,bC.jsx)("textarea",{className:"flex-1 bg-black/10 rounded-xl p-4 text-sm text-gray-300 font-mono focus:outline-none focus:ring-1 focus:ring-nexus-purple/50 resize-none leading-relaxed w-full h-full overflow-y-auto",value:a,onChange:a=>b(a.target.value),spellCheck:!1}),(0,bC.jsx)("div",{className:"absolute bottom-2 right-4 text-[10px] text-gray-600",children:"Markdown Supported"})]})},m$=bI("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),m_=bI("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),m0=bI("youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),m1=bI("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),m2=bI("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),m3=({searchQuery:a=""})=>{let b=[{id:"1",title:"Calculus Syllabus",url:"#",category:"doc"},{id:"2",title:"React Crash Course",url:"#",category:"youtube"},{id:"3",title:"Project Drive",url:"#",category:"drive"},{id:"4",title:"Design System",url:"#",category:"other"}],[c,d]=(0,bD.useState)(()=>b),[e,f]=(0,bD.useState)(!1),[g,h]=(0,bD.useState)(""),[i,j]=(0,bD.useState)(""),[k,l]=(0,bD.useState)("other"),[m,n]=(0,bD.useState)("");(0,bD.useEffect)(()=>{localStorage.setItem("nexus_vault_links",JSON.stringify(c))},[c]);let o=a=>{switch(a){case"youtube":return(0,bC.jsx)(m0,{size:16,className:"text-red-400"});case"doc":return(0,bC.jsx)(m1,{size:16,className:"text-blue-400"});case"drive":return(0,bC.jsx)(m$,{size:16,className:"text-yellow-400"});default:return(0,bC.jsx)(m_,{size:16,className:"text-nexus-teal"})}},p=c.filter(b=>{let c=!a||b.title.toLowerCase().includes(a.toLowerCase())||b.url.toLowerCase().includes(a.toLowerCase())||b.category.toLowerCase().includes(a.toLowerCase()),d=!m||b.title.toLowerCase().includes(m.toLowerCase())||b.url.toLowerCase().includes(m.toLowerCase())||b.category.toLowerCase().includes(m.toLowerCase());return c&&d});return(0,bC.jsx)("div",{className:"h-full relative overflow-hidden flex flex-col",children:e?(0,bC.jsxs)("div",{className:"h-full flex flex-col gap-3 animate-fade-in p-1",children:[(0,bC.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,bC.jsx)("h4",{className:"text-sm font-semibold text-white",children:"Add Resource"}),(0,bC.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-white p-1 hover:bg-white/10 rounded-full transition-colors",children:(0,bC.jsx)(bQ,{size:14})})]}),(0,bC.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,bC.jsx)("input",{type:"text",placeholder:"Resource Title",value:g,onChange:a=>h(a.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-xs text-white focus:border-nexus-teal focus:ring-1 focus:ring-nexus-teal/50 outline-none placeholder:text-gray-600 transition-all",autoFocus:!0}),(0,bC.jsx)("input",{type:"text",placeholder:"URL (e.g. google.com)",value:i,onChange:a=>j(a.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-xs text-white focus:border-nexus-teal focus:ring-1 focus:ring-nexus-teal/50 outline-none placeholder:text-gray-600 transition-all"}),(0,bC.jsx)("div",{className:"grid grid-cols-4 gap-2 mt-2",children:["doc","youtube","drive","other"].map(a=>(0,bC.jsxs)("button",{onClick:()=>l(a),className:`
                        p-2 rounded-lg border flex flex-col items-center justify-center gap-1 transition-all h-16
                        ${k===a?"bg-nexus-teal/10 border-nexus-teal text-white shadow-[0_0_10px_rgba(101,187,189,0.2)]":"border-white/5 text-gray-500 hover:bg-white/5 hover:text-gray-300"}
                    `,title:a,children:[o(a),(0,bC.jsx)("span",{className:"text-[9px] uppercase font-bold tracking-wider",children:a})]},a))})]}),(0,bC.jsxs)("button",{onClick:()=>{g.trim()&&i.trim()&&(d([...c,{id:Date.now().toString(),title:g,url:i.startsWith("http")?i:`https://${i}`,category:k}]),f(!1),h(""),j(""),l("other"))},className:"w-full bg-nexus-teal text-nexus-deep font-bold py-2.5 rounded-xl text-xs hover:bg-white transition-all flex items-center justify-center gap-2 mt-2 shadow-lg hover:shadow-nexus-teal/50",children:[(0,bC.jsx)(m2,{size:14})," Save to Vault"]})]}):(0,bC.jsxs)(bC.Fragment,{children:[(0,bC.jsxs)("div",{className:"relative mb-3 group shrink-0",children:[(0,bC.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,bC.jsx)(bO,{size:12,className:"text-gray-500 group-focus-within:text-nexus-teal transition-colors"})}),(0,bC.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"Filter vault...",className:"w-full bg-black/20 border border-white/10 rounded-xl pl-9 pr-8 py-2 text-xs text-white focus:outline-none focus:border-nexus-teal/50 focus:bg-white/5 transition-all font-mono placeholder:text-gray-600"}),m&&(0,bC.jsx)("button",{onClick:()=>n(""),className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-500 hover:text-white",children:(0,bC.jsx)(bQ,{size:12})})]}),(0,bC.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar pr-1",children:(0,bC.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[p.map(a=>(0,bC.jsxs)("a",{href:a.url,target:"_blank",rel:"noreferrer",className:"group relative flex flex-col p-3 rounded-xl bg-white/5 border border-white/5 hover:border-nexus-teal/50 transition-all hover:-translate-y-1 hover:shadow-lg hover:shadow-nexus-teal/10",children:[(0,bC.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bC.jsx)("div",{className:"p-2 bg-black/30 rounded-lg group-hover:bg-nexus-teal/20 transition-colors",children:o(a.category)}),(0,bC.jsx)("button",{onClick:b=>{var e;return e=a.id,void(b.preventDefault(),b.stopPropagation(),d(c.filter(a=>a.id!==e)))},className:"opacity-0 group-hover:opacity-100 p-1.5 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-md transition-all",title:"Remove Link",children:(0,bC.jsx)(ji,{size:12})})]}),(0,bC.jsx)("span",{className:"text-xs font-medium text-gray-300 group-hover:text-white truncate",title:a.title,children:a.title})]},a.id)),(0,bC.jsxs)("button",{onClick:()=>f(!0),className:"flex flex-col items-center justify-center p-3 rounded-xl border border-dashed border-white/10 hover:border-nexus-purple/50 text-gray-500 hover:text-nexus-purple transition-all gap-2 min-h-[88px] group",children:[(0,bC.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/5 group-hover:bg-nexus-purple/20 flex items-center justify-center transition-colors",children:(0,bC.jsx)(bU,{size:16})}),(0,bC.jsx)("span",{className:"text-[10px] font-medium",children:"Add Resource"})]})]})})]})})},m4=bI("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),m5=bI("battery",[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]]),m6=bI("cloud-sun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]),m7=bI("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]),m8=bI("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),m9=()=>{let[a,b]=(0,bD.useState)(new Date);return(0,bD.useEffect)(()=>{let a=setInterval(()=>b(new Date),1e3);return()=>clearInterval(a)},[]),(0,bC.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between h-full px-2 gap-4 md:gap-0",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-4 w-full md:w-1/3",children:[(0,bC.jsx)("div",{className:"p-3 bg-white/5 rounded-xl border border-white/5",children:(0,bC.jsx)(m6,{size:24,className:"text-nexus-teal"})}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h2",{className:"text-xl font-bold text-white tracking-wide",children:a.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),(0,bC.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400 font-mono",children:[(0,bC.jsx)("span",{children:"Jakarta, ID"}),(0,bC.jsx)("span",{className:"w-1 h-1 rounded-full bg-gray-500"}),(0,bC.jsx)("span",{children:"32Â°C"})]})]})]}),(0,bC.jsxs)("div",{className:"flex flex-col items-center justify-center w-full md:w-1/3",children:[(0,bC.jsxs)("div",{className:"text-5xl md:text-6xl font-mono font-bold text-transparent bg-clip-text bg-gradient-to-b from-white to-white/50 tracking-tighter",children:[a.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),(0,bC.jsx)("span",{className:"text-lg md:text-xl text-nexus-purple ml-1 animate-pulse",children:a.getSeconds().toString().padStart(2,"0")})]}),(0,bC.jsx)("div",{className:"text-[10px] tracking-[0.3em] text-nexus-teal uppercase mt-1",children:"System Optimal"})]}),(0,bC.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-1/3 items-end",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-3 text-xs font-mono text-gray-400 mb-1",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-1",children:[(0,bC.jsx)(m4,{size:14,className:"text-green-400"}),(0,bC.jsx)("span",{children:"NET: 5G"})]}),(0,bC.jsxs)("div",{className:"flex items-center gap-1",children:[(0,bC.jsx)(m5,{size:14,className:"text-nexus-purple"}),(0,bC.jsx)("span",{children:"PWR: 98%"})]})]}),(0,bC.jsxs)("div",{className:"w-full max-w-[200px] space-y-1.5",children:[(0,bC.jsxs)("div",{className:"flex items-center justify-between text-[10px] text-nexus-teal/80 font-bold uppercase",children:[(0,bC.jsxs)("span",{className:"flex items-center gap-1",children:[(0,bC.jsx)(m7,{size:10})," CPU Load"]}),(0,bC.jsx)("span",{children:"12%"})]}),(0,bC.jsx)("div",{className:"w-full h-1.5 bg-white/10 rounded-full overflow-hidden",children:(0,bC.jsx)("div",{className:"h-full bg-nexus-teal w-[12%] rounded-full shadow-[0_0_10px_#65BBBD]"})}),(0,bC.jsxs)("div",{className:"flex items-center justify-between text-[10px] text-nexus-purple/80 font-bold uppercase mt-1",children:[(0,bC.jsxs)("span",{className:"flex items-center gap-1",children:[(0,bC.jsx)(m8,{size:10})," Memory"]}),(0,bC.jsx)("span",{children:"4.2 GB"})]}),(0,bC.jsx)("div",{className:"w-full h-1.5 bg-white/10 rounded-full overflow-hidden",children:(0,bC.jsx)("div",{className:"h-full bg-nexus-purple w-[45%] rounded-full shadow-[0_0_10px_#732ADF]"})})]})]})]})},na=(a,b)=>{let c;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(a)?(3==(c=a.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),"rgba("+[(c="0x"+c.join(""))>>16&255,c>>8&255,255&c].join(",")+","+b+")"):`rgba(115, 42, 223, ${b})`},nb=[{id:"nexus",name:"Nexus",primary:"#732ADF",secondary:"#65BBBD"},{id:"cyber",name:"Cyber",primary:"#FF0055",secondary:"#00E5FF"},{id:"emerald",name:"Forest",primary:"#10B981",secondary:"#F59E0B"},{id:"monochrome",name:"Mono",primary:"#6B7280",secondary:"#E5E7EB"},{id:"sunset",name:"Sunset",primary:"#F97316",secondary:"#8B5CF6"}],nc=({id:a,children:b,className:c})=>{let{attributes:d,listeners:e,setNodeRef:f,transform:g,transition:h,isDragging:i}=function(a){var b,c,d,e;let{animateLayoutChanges:f=dy,attributes:g,disabled:h,data:i,getNewIndex:j=dx,id:k,strategy:l,resizeObserverConfig:m,transition:n=dz}=a,{items:o,containerId:p,activeIndex:q,disabled:r,disableTransforms:s,sortedRects:t,overIndex:u,useDragOverlay:v,strategy:w}=(0,bD.useContext)(dv),x=(b=h,c=r,"boolean"==typeof b?{draggable:b,droppable:!1}:{draggable:null!=(d=null==b?void 0:b.draggable)?d:c.draggable,droppable:null!=(e=null==b?void 0:b.droppable)?e:c.droppable}),y=o.indexOf(k),z=(0,bD.useMemo)(()=>({sortable:{containerId:p,index:y,items:o},...i}),[p,i,y,o]),A=(0,bD.useMemo)(()=>o.slice(o.indexOf(k)),[o,k]),{rect:B,node:C,isOver:D,setNodeRef:E}=function(a){let{data:b,disabled:c=!1,id:d,resizeObserverConfig:e}=a,f=b9("Droppable"),{active:g,dispatch:h,over:i,measureDroppableContainers:j}=(0,bD.useContext)(de),k=(0,bD.useRef)({disabled:c}),l=(0,bD.useRef)(!1),m=(0,bD.useRef)(null),n=(0,bD.useRef)(null),{disabled:o,updateMeasurementsFor:p,timeout:q}={...dn,...e},r=b4(null!=p?p:d),s=c1({callback:(0,bD.useCallback)(()=>{if(!l.current){l.current=!0;return}null!=n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{j(Array.isArray(r.current)?r.current:[r.current]),n.current=null},q)},[q]),disabled:o||!g}),[t,u]=b6((0,bD.useCallback)((a,b)=>{s&&(b&&(s.unobserve(b),l.current=!1),a&&s.observe(a))},[s])),v=b4(b);return(0,bD.useEffect)(()=>{s&&t.current&&(s.disconnect(),l.current=!1,s.observe(t.current))},[t,s]),(0,bD.useEffect)(()=>(h({type:az.RegisterDroppable,element:{id:d,key:f,disabled:c,node:t,rect:m,data:v}}),()=>h({type:az.UnregisterDroppable,key:f,id:d})),[d]),(0,bD.useEffect)(()=>{c!==k.current.disabled&&(h({type:az.SetDroppableDisabled,id:d,key:f,disabled:c}),k.current.disabled=c)},[d,f,c,h]),{active:g,rect:m,isOver:(null==i?void 0:i.id)===d,node:t,over:i,setNodeRef:u}}({id:k,data:z,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...m}}),{active:F,activatorEvent:G,activeNodeRect:H,attributes:I,setNodeRef:J,listeners:K,isDragging:L,over:M,setActivatorNodeRef:N,transform:O}=function(a){let{id:b,data:c,disabled:d=!1,attributes:e}=a,f=b9("Draggable"),{activators:g,activatorEvent:h,active:i,activeNodeRect:j,ariaDescribedById:k,draggableNodes:l,over:m}=(0,bD.useContext)(de),{role:n=dm,roleDescription:o="draggable",tabIndex:p=0}=null!=e?e:{},q=(null==i?void 0:i.id)===b,r=(0,bD.useContext)(q?dj:dl),[s,t]=b6(),[u,v]=b6(),w=(0,bD.useMemo)(()=>g.reduce((a,c)=>{let{eventName:d,handler:e}=c;return a[d]=a=>{e(a,b)},a},{}),[g,b]),x=b4(c);return b2(()=>(l.set(b,{id:b,key:f,node:s,activatorNode:u,data:x}),()=>{let a=l.get(b);a&&a.key===f&&l.delete(b)}),[l,b]),{active:i,activatorEvent:h,activeNodeRect:j,attributes:(0,bD.useMemo)(()=>({role:n,tabIndex:p,"aria-disabled":d,"aria-pressed":!!q&&n===dm||void 0,"aria-roledescription":o,"aria-describedby":k.draggable}),[d,n,p,q,o,k.draggable]),isDragging:q,listeners:d?void 0:w,node:s,over:m,setNodeRef:t,setActivatorNodeRef:v,transform:r}}({id:k,data:z,attributes:{...dC,...g},disabled:x.draggable}),P=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,bD.useMemo)(()=>a=>{b.forEach(b=>b(a))},b)}(E,J),Q=!!F,R=Q&&!s&&ds(q)&&ds(u),S=!v&&L,T=S&&R?O:null,U=R?null!=T?T:(null!=l?l:w)({rects:t,activeNodeRect:H,activeIndex:q,overIndex:u,index:y}):null,V=ds(q)&&ds(u)?j({id:k,items:o,activeIndex:q,overIndex:u}):y,W=null==F?void 0:F.id,X=(0,bD.useRef)({activeId:W,items:o,newIndex:V,containerId:p}),Y=o!==X.current.items,Z=f({active:F,containerId:p,isDragging:L,isSorting:Q,id:k,index:y,items:o,newIndex:X.current.newIndex,previousItems:X.current.items,previousContainerId:X.current.containerId,transition:n,wasDragging:null!=X.current.activeId}),$=function(a){let{disabled:b,index:c,node:d,rect:e}=a,[f,g]=(0,bD.useState)(null),h=(0,bD.useRef)(c);return b2(()=>{if(!b&&c!==h.current&&d.current){let a=e.current;if(a){let b=cC(d.current,{ignoreTransform:!0}),c={x:a.left-b.left,y:a.top-b.top,scaleX:a.width/b.width,scaleY:a.height/b.height};(c.x||c.y)&&g(c)}}c!==h.current&&(h.current=c)},[b,c,d,e]),(0,bD.useEffect)(()=>{f&&g(null)},[f]),f}({disabled:!Z,index:y,node:C,rect:B});return(0,bD.useEffect)(()=>{Q&&X.current.newIndex!==V&&(X.current.newIndex=V),p!==X.current.containerId&&(X.current.containerId=p),o!==X.current.items&&(X.current.items=o)},[Q,V,p,o]),(0,bD.useEffect)(()=>{if(W===X.current.activeId)return;if(null!=W&&null==X.current.activeId){X.current.activeId=W;return}let a=setTimeout(()=>{X.current.activeId=W},50);return()=>clearTimeout(a)},[W]),{active:F,activeIndex:q,attributes:I,data:z,rect:B,index:y,newIndex:V,items:o,isOver:D,isSorting:Q,isDragging:L,listeners:K,node:C,overIndex:u,over:M,setNodeRef:P,setActivatorNodeRef:N,setDroppableNodeRef:E,setDraggableNodeRef:J,transform:null!=$?$:U,transition:$||Y&&X.current.newIndex===y?dB:(!S||cd(G))&&n&&(Q||Z)?cf.Transition.toString({...n,property:dA}):void 0}}({id:a}),j={transform:cf.Transform.toString(g),transition:h||"transform 250ms cubic-bezier(0.25, 1, 0.5, 1)",zIndex:i?999:"auto",position:"relative",opacity:i?.8:1,scale:i?1.05:1};return(0,bC.jsx)("div",{ref:f,style:j,className:c,...d,children:bD.default.Children.map(b,a=>bD.default.isValidElement(a)?bD.default.cloneElement(a,{dragHandleProps:e}):a)})};function nd(){let[a,b]=(0,bD.useState)("dashboard"),[c,d]=(0,bD.useState)(""),e=(0,bD.useRef)(null),[f,g]=(0,bD.useState)(!1),[h,i]=(0,bD.useState)(!1),[j,k]=(0,bD.useState)("dark"),[l,m]=(0,bD.useState)("nexus"),[n,o]=(0,bD.useState)(nb[0]),[p,q]=(0,bD.useState)({monitor:{col:2,row:1},tasks:{col:2,row:2},ai:{col:2,row:2},agenda:{col:2,row:2},vault:{col:2,row:1},notes:{col:2,row:1}}),[r,s]=(0,bD.useState)(["monitor","tasks","ai","agenda","vault","notes"]),[t,u]=(0,bD.useState)([]),[v,w]=(0,bD.useState)(""),[x,y]=(0,bD.useState)(1),[z,A]=(0,bD.useState)(1),[B,C]=(0,bD.useState)("#732ADF"),[D,E]=(0,bD.useState)({monitor:"#732ADF",tasks:"#10B981",ai:"#F59E0B",agenda:"#3B82F6",vault:"#EC4899",notes:"#8B5CF6"});(0,bD.useEffect)(()=>{},[]),(0,bD.useEffect)(()=>{},[j,l,p,r,t,D]),(0,bD.useEffect)(()=>{"dark"===j?(document.documentElement.classList.add("dark"),document.documentElement.removeAttribute("data-theme")):(document.documentElement.classList.remove("dark"),document.documentElement.setAttribute("data-theme","light"))},[j]);let F=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return(0,bD.useMemo)(()=>[...b].filter(a=>null!=a),[...b])}(cp(cZ),cp(cU,{coordinateGetter:dF})),G=(a,b)=>{E(c=>({...c,[a]:b}))},H=(a,b,c)=>{q(d=>({...d,[a]:{col:b,row:c}}))},I=(a,b)=>`md:col-span-${a} md:row-span-${b}`;return(0,bC.jsxs)("div",{className:"min-h-screen bg-nexus-deep text-nexus-text p-4 md:p-8 font-sans selection:bg-nexus-purple selection:text-white relative overflow-x-hidden transition-colors duration-300",children:[(0,bC.jsxs)("div",{className:"fixed top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[(0,bC.jsx)("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-nexus-purple/20 rounded-full blur-[120px] animate-pulse-slow",style:{backgroundColor:f?D.ai+"40":void 0}}),(0,bC.jsx)("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-nexus-teal/10 rounded-full blur-[120px] animate-pulse-slow",style:{animationDelay:"2s",backgroundColor:f?D.monitor+"20":void 0}})]}),(0,bC.jsxs)("div",{className:"relative z-10 max-w-7xl mx-auto flex flex-col min-h-screen",children:[(0,bC.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[(0,bC.jsxs)("div",{className:"flex items-center gap-4 w-full md:w-auto",children:["dashboard"!==a&&(0,bC.jsx)("button",{onClick:()=>b("dashboard"),className:"p-2 rounded-full bg-white/5 hover:bg-white/10 transition-colors border border-white/10",children:(0,bC.jsx)(bT,{size:20})}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h1",{className:"text-4xl font-bold tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:"NEXUS OMNIA"}),(0,bC.jsx)("p",{className:"text-sm text-gray-400 tracking-widest uppercase opacity-70",children:"Personal Command Interface"})]})]}),(0,bC.jsxs)("div",{className:"flex items-center gap-3 w-full md:w-auto justify-end",children:[(0,bC.jsxs)("div",{className:"relative group flex-1 md:flex-none",children:[(0,bC.jsx)(bO,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:16}),(0,bC.jsx)("input",{ref:e,type:"text",placeholder:"Search system...",value:c,onChange:a=>d(a.target.value),className:"w-full md:w-64 bg-black/20 border border-white/10 rounded-full py-2 pl-10 pr-4 text-sm focus:outline-none focus:border-nexus-purple/50 transition-all"})]}),(0,bC.jsx)("button",{onClick:()=>{k(a=>"light"===a?"dark":"light")},className:"p-2 rounded-full bg-white/5 hover:bg-white/10 transition-colors border border-white/10",title:"Toggle Theme",children:"dark"===j?(0,bC.jsx)(bS,{size:18}):(0,bC.jsx)(bR,{size:18})}),(0,bC.jsx)("button",{onClick:()=>g(!f),className:`p-2 rounded-full transition-colors border border-white/10 ${f?"bg-nexus-purple text-white":"bg-white/5 hover:bg-white/10"}`,title:"Customize Layout",children:(0,bC.jsx)(bP,{size:18})})]})]}),f&&(0,bC.jsx)("div",{className:"mb-8 p-4 rounded-2xl bg-black/30 border border-white/10 backdrop-blur-md animate-slide-down",children:(0,bC.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h3",{className:"text-sm font-bold text-gray-300 mb-3 uppercase tracking-wider",children:"Color Theme"}),(0,bC.jsx)("div",{className:"flex gap-3",children:nb.map(a=>(0,bC.jsx)("button",{onClick:()=>{m(a.id),o(a)},className:`w-8 h-8 rounded-full border-2 transition-transform hover:scale-110 ${l===a.id?"border-white scale-110":"border-transparent"}`,style:{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`},title:a.name},a.id))})]}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("h3",{className:"text-sm font-bold text-gray-300 mb-3 uppercase tracking-wider",children:"Widgets"}),(0,bC.jsxs)("div",{className:"flex gap-3",children:[(0,bC.jsxs)("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors text-sm",children:[(0,bC.jsx)(bU,{size:16}),"Add Custom Widget"]}),(0,bC.jsx)("button",{onClick:()=>{q({monitor:{col:2,row:1},tasks:{col:2,row:2},ai:{col:2,row:2},agenda:{col:2,row:2},vault:{col:2,row:1},notes:{col:2,row:1}}),s(["monitor","tasks","ai","agenda","vault","notes"])},className:"px-4 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 border border-red-500/20 text-red-400 transition-colors text-sm",children:"Reset Layout"})]})]})]})}),(0,bC.jsx)("main",{className:"flex-1 relative",children:"calendar"===a?(0,bC.jsx)("div",{className:"flex-1 w-full pb-8 animate-fade-in min-h-[800px]",children:(0,bC.jsx)(je,{className:"h-full",title:"Master Timeline",icon:(0,bC.jsx)(bJ,{}),glowColor:na(n.secondary,.3),children:(0,bC.jsx)("div",{className:"h-full p-4",children:(0,bC.jsx)(jj,{searchQuery:c})})})}):"tasks"===a?(0,bC.jsx)("div",{className:"flex-1 w-full pb-8 animate-fade-in min-h-[800px]",children:(0,bC.jsx)(je,{className:"h-full",title:"Command Center",icon:(0,bC.jsx)(bK,{}),glowColor:na(n.primary,.2),children:(0,bC.jsx)("div",{className:"h-full p-4 max-w-3xl mx-auto",children:(0,bC.jsx)(jB,{searchQuery:c})})})}):"notes"===a?(0,bC.jsx)("div",{className:"flex-1 w-full pb-8 animate-fade-in min-h-[800px]",children:(0,bC.jsx)(je,{className:"h-full",title:"Neural Notes Workspace",icon:(0,bC.jsx)(bN,{}),glowColor:na(D.notes,.2),children:(0,bC.jsx)("div",{className:"h-full p-4",children:(0,bC.jsx)(mZ,{searchQuery:c})})})}):"vault"===a?(0,bC.jsx)("div",{className:"flex-1 w-full pb-8 animate-fade-in min-h-[800px]",children:(0,bC.jsx)(je,{className:"h-full",title:"Data Vault Archive",icon:(0,bC.jsx)(bM,{}),glowColor:na(D.vault,.3),children:(0,bC.jsx)("div",{className:"h-full p-4 max-w-4xl mx-auto",children:(0,bC.jsx)(m3,{searchQuery:c})})})}):"ai"===a?(0,bC.jsx)("div",{className:"flex-1 w-full pb-8 animate-fade-in min-h-[800px]",children:(0,bC.jsx)(je,{className:"h-full",title:"Nexus AI Core - Full Interface",icon:(0,bC.jsx)(bL,{}),glowColor:na(D.ai,.4),children:(0,bC.jsx)("div",{className:"h-full p-4 max-w-4xl mx-auto",children:(0,bC.jsx)(mV,{})})})}):(0,bC.jsx)(dk,{sensors:F,collisionDetection:cx,onDragEnd:a=>{let{active:b,over:c}=a;b.id!==c.id&&s(a=>{let d=a.indexOf(b.id),e=a.indexOf(c.id);return dr(a,d,e)})},children:(0,bC.jsx)(dw,{items:r,strategy:dt,children:(0,bC.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 pb-12 animate-fade-in auto-rows-[180px]",children:r.map(a=>(0,bC.jsx)(nc,{id:a,className:(a=>{if("monitor"===a)return I(p.monitor.col,p.monitor.row);if("tasks"===a)return I(p.tasks.col,p.tasks.row);if("ai"===a)return I(p.ai.col,p.ai.row);if("agenda"===a)return I(p.agenda.col,p.agenda.row);if("vault"===a)return I(p.vault.col,p.vault.row);if("notes"===a)return I(p.notes.col,p.notes.row);let b=t.find(b=>b.id===a);return b?I(b.colSpan,b.rowSpan):"md:col-span-1 md:row-span-1"})(a),children:(a=>{if("monitor"===a)return(0,bC.jsx)(je,{colSpanInt:p.monitor.col,rowSpanInt:p.monitor.row,onResize:(a,b)=>H("monitor",a,b),className:"h-full min-h-[140px]",glowColor:na(D.monitor,.15),isCustomizing:f,pickerColor:D.monitor,onColorChange:a=>G("monitor",a),children:(0,bC.jsx)(m9,{})},a);if("tasks"===a)return(0,bC.jsx)(je,{colSpanInt:p.tasks.col,rowSpanInt:p.tasks.row,onResize:(a,b)=>H("tasks",a,b),title:"Missions",icon:(0,bC.jsx)(bK,{}),glowColor:na(D.tasks,.2),className:"h-full min-h-[140px]",isCustomizing:f,pickerColor:D.tasks,onColorChange:a=>G("tasks",a),onTripleClick:()=>b("tasks"),children:(0,bC.jsx)(jB,{searchQuery:c})},a);if("ai"===a)return(0,bC.jsx)(je,{colSpanInt:p.ai.col,rowSpanInt:p.ai.row,onResize:(a,b)=>H("ai",a,b),title:"Nexus AI Core",icon:(0,bC.jsx)(bL,{}),glowColor:na(D.ai,.4),className:"h-full min-h-[140px]",isCustomizing:f,pickerColor:D.ai,onColorChange:a=>G("ai",a),onTripleClick:()=>b("ai"),children:(0,bC.jsx)(mV,{})},a);if("agenda"===a)return(0,bC.jsx)(je,{colSpanInt:p.agenda.col,rowSpanInt:p.agenda.row,onResize:(a,b)=>H("agenda",a,b),title:"Timeline",icon:(0,bC.jsx)(bJ,{}),glowColor:na(D.agenda,.3),className:"h-full min-h-[140px]",isCustomizing:f,pickerColor:D.agenda,onColorChange:a=>G("agenda",a),onTripleClick:()=>b("calendar"),children:(0,bC.jsx)(jj,{searchQuery:c})},a);if("vault"===a)return(0,bC.jsx)(je,{colSpanInt:p.vault.col,rowSpanInt:p.vault.row,onResize:(a,b)=>H("vault",a,b),title:"Data Vault",icon:(0,bC.jsx)(bM,{}),className:"h-full min-h-[140px]",glowColor:na(D.vault,.5),isCustomizing:f,pickerColor:D.vault,onColorChange:a=>G("vault",a),onTripleClick:()=>b("vault"),children:(0,bC.jsx)(m3,{searchQuery:c})},a);if("notes"===a)return(0,bC.jsx)(je,{colSpanInt:p.notes.col,rowSpanInt:p.notes.row,onResize:(a,b)=>H("notes",a,b),title:"Neural Notes",icon:(0,bC.jsx)(bN,{}),glowColor:na(D.notes,.1),className:"h-full min-h-[140px]",isCustomizing:f,pickerColor:D.notes,onColorChange:a=>G("notes",a),onTripleClick:()=>b("notes"),children:(0,bC.jsx)("div",{className:"h-full w-full",children:(0,bC.jsx)(mZ,{searchQuery:c})})},a);let d=t.find(b=>b.id===a);return d?(0,bC.jsx)(je,{colSpanInt:d.colSpan,rowSpanInt:d.rowSpan,onResize:(a,b)=>{var c;return c=d.id,void u(d=>d.map(d=>d.id===c?{...d,colSpan:a,rowSpan:b}:d))},title:d.title,icon:(0,bC.jsx)(bV,{}),glowColor:na(d.color,.3),className:"h-full",isCustomizing:f,pickerColor:d.color,onColorChange:a=>{var b;return b=d.id,void u(c=>c.map(c=>c.id===b?{...c,color:a}:c))},onDelete:()=>{var a;return a=d.id,void u(b=>b.filter(b=>b.id!==a))},children:(0,bC.jsx)("textarea",{className:"w-full h-full bg-transparent resize-none focus:outline-none text-sm text-gray-300 placeholder:text-gray-600 font-mono",placeholder:"Enter widget content...",value:d.content,onChange:a=>{var b,c;return b=d.id,c=a.target.value,void u(a=>a.map(a=>a.id===b?{...a,content:c}:a))}})},a):null})(a)},a))})})})}),(0,bC.jsx)("footer",{className:"mt-auto py-6 text-center text-xs text-gray-600 border-t border-white/5",children:(0,bC.jsx)("p",{children:"NEXUS OMNIA SYSTEM v2.4.0 // AUTHORIZED ACCESS ONLY"})})]}),h&&(0,bC.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,bC.jsxs)("div",{className:"bg-[#111] border border-white/10 rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[(0,bC.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,bC.jsx)("h2",{className:"text-xl font-bold",children:"Add Custom Widget"}),(0,bC.jsx)("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:(0,bC.jsx)(bQ,{size:20})})]}),(0,bC.jsxs)("div",{className:"space-y-4",children:[(0,bC.jsxs)("div",{children:[(0,bC.jsx)("label",{className:"block text-xs text-gray-400 mb-1 uppercase",children:"Title"}),(0,bC.jsx)("input",{type:"text",value:v,onChange:a=>w(a.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg p-2 text-sm focus:border-nexus-purple/50 outline-none",placeholder:"Widget Title"})]}),(0,bC.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bC.jsxs)("div",{children:[(0,bC.jsx)("label",{className:"block text-xs text-gray-400 mb-1 uppercase",children:"Columns (Width)"}),(0,bC.jsx)("select",{value:x,onChange:a=>y(Number(a.target.value)),className:"w-full bg-white/5 border border-white/10 rounded-lg p-2 text-sm outline-none",children:[1,2,3,4].map(a=>(0,bC.jsx)("option",{value:a,children:a},a))})]}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("label",{className:"block text-xs text-gray-400 mb-1 uppercase",children:"Rows (Height)"}),(0,bC.jsx)("select",{value:z,onChange:a=>A(Number(a.target.value)),className:"w-full bg-white/5 border border-white/10 rounded-lg p-2 text-sm outline-none",children:[1,2,3,4].map(a=>(0,bC.jsx)("option",{value:a,children:a},a))})]})]}),(0,bC.jsxs)("div",{children:[(0,bC.jsx)("label",{className:"block text-xs text-gray-400 mb-1 uppercase",children:"Accent Color"}),(0,bC.jsx)("div",{className:"flex gap-2 flex-wrap",children:["#732ADF","#10B981","#F59E0B","#3B82F6","#EC4899","#EF4444"].map(a=>(0,bC.jsx)("button",{onClick:()=>C(a),className:`w-8 h-8 rounded-full border-2 ${B===a?"border-white":"border-transparent"}`,style:{backgroundColor:a}},a))})]}),(0,bC.jsx)("button",{onClick:()=>{if(!v)return;let a={id:`custom-${Date.now()}`,title:v,content:"",colSpan:x,rowSpan:z,color:B};u(b=>[...b,a]),i(!1),w(""),y(1),A(1)},disabled:!v,className:"w-full py-3 mt-4 bg-nexus-purple hover:bg-nexus-purple/80 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Widget"})]})]})})]})}a.s(["default",()=>nd],30100)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1d51e168._.js.map